<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="icon" href="/static/favicon.ico" type="image/x-icon"/>
    <link rel="stylesheet" href="/static/css/all.css" />
    <title>大脸圆玉的博客</title>
    <script>
        var alist = document.getElementsByTagName("a");
        for(let i=0;i<alist.length;i++) if(alist[i].href.indexOf('#') < 0) alist[i].target="_blank"    
    </script>
</head>
<body>
    <div class="l-nav">
        <div class="nav-img">
    <img src="/static/img/avatar.png"/>
</div>


<ul>
    
        
            <li class="li-active"> <a href="/categories/Experience.html">Experience</a></li>
        
        
            <li > <a href="/categories/Reading.html">Reading</a></li>
        
    
        
            <li > <a href="/categories/Collection.html">Collection</a></li>
        
    
</ul>
    </div>
    <div class="r-box">
        <div class="article">
            <h1 class="title">vue中使用gojs/jointjs</h1>            
            <p>I belong to : Experience</p>
            <hr/>
            <p>因为公司项目需求，要画出相关业务的流程图，以便客户了解自己身处何处</p>
<p>搜索框输入 “前端流程图插件”，查了很多资料，总结一下有以下几种</p>
<h3 id="raphael">Raphael</h3>
<p><a href="http://dmitrybaranovskiy.github.io/raphael/reference.html">http://dmitrybaranovskiy.github.io/raphael/reference.html</a>
这个星星很多，但是我找到的demo都要自己设置x坐标，y坐标，找不到自动布局的demo</p>
<p><a href="http://www.weixuehao.com/archives/370">http://www.weixuehao.com/archives/370</a></p>
<h3 id="flow-chart">flow-chart</h3>
<p>代码写法繁琐，不是json就可以解决，效果也比较丑,PASS</p>
<h3 id="darge-d3">darge-d3</h3>
<p>github :<a href="https://github.com/dagrejs/dagre-d3">https://github.com/dagrejs/dagre-d3</a></p>
<p>效果图
{% asset_img darge-d3.png %}</p>
<p>下载里面的demo,改一下json就可以了</p>
<pre><code class="language-json">// States 
var states = [ &quot;NEW&quot;, &quot;SUBMITTED&quot;,&quot;FINISHED&quot; ,&quot;FAILED&quot;,&quot;DELIVER&quot;, 
               &quot;CANCELED&quot;, &quot;ABOLISHED&quot; , &quot;DELETED&quot;,&quot;REFUNDING&quot;,&quot;REFUNDED&quot;];
var map = [&#39;新创建&#39;,&#39;已提交&#39;,&#39;已完成&#39;,&#39;提交失败&#39;,&quot;交付中&quot;,
              &#39;已取消&#39;,&#39;废除&#39;,&#39;已删除&#39;,&#39;退款中&#39;,&quot;已退款&quot;]
// Automatically label each of the nodes
states.forEach(function(state,index) { g.setNode(state, { label: `${map[index]}(${state})`})});

// Set up the edges
g.setEdge(&quot;NEW&quot;, &quot;FAILED&quot;,     { label: &quot;后台接口自动&quot;});
g.setEdge(&quot;NEW&quot;, &quot;SUBMITTED&quot;,   { label: &quot;后台接口自动&quot; });
g.setEdge(&quot;NEW&quot;, &quot;CANCELED&quot;,   { label: &quot;用户取消订单&quot; });
g.setEdge(&quot;SUBMITTED&quot;,&quot;CANCELED&quot;,     { label: &quot;用户取消订单&quot; });
g.setEdge(&quot;SUBMITTED&quot;, &quot;ABOLISHED&quot;,  { label: &quot;用户超过48小时未支付，\n系统自动取消&quot;});
g.setEdge(&quot;ABOLISHED&quot;,&quot;DELETED&quot;,      { label: &quot;已删除&quot; });
g.setEdge(&quot;CANCELED&quot;, &quot;DELETED&quot;,   { label: &quot;已删除&quot;});
g.setEdge(&quot;FAILED&quot;,   &quot;SUBMITTED&quot;,      { label: &quot;后台接口自动&quot; });

g.setEdge(&quot;SUBMITTED&quot;,   &quot;DELIVER&quot;,     { label: &quot;用户支付&quot; });
g.setEdge(&quot;FINISHED&quot;,   &quot;REFUNDING&quot;,     { label: &quot;用户退款&quot; });

g.setEdge(&quot;DELIVER&quot;,   &quot;FINISHED&quot;,     { label: &quot;交付完成&quot; });
g.setEdge(&quot;REFUNDING&quot;,   &quot;REFUNDED&quot;,     { label: &quot;已退款&quot; });
g.setEdge(&quot;REFUNDED&quot;,   &quot;DELETED&quot;,     { label: &quot;已删除&quot; });
g.setEdge(&quot;DELIVER&quot;,   &quot;REFUNDING&quot;,     { label: &quot;用户退款&quot; });
g.setEdge(&quot;FAILED&quot;,   &quot;CANCELED&quot;,     { label: &quot;用户取消订单&quot; });</code></pre>
<p><strong>不满意的地方</strong>：画出来的图是垂直方向的，我要的是水平方向,PASS</p>
<h3 id="gojs">gojs</h3>
<p>github :<a href="https://github.com/NorthwoodsSoftware/GoJS">https://github.com/NorthwoodsSoftware/GoJS</a></p>
<p>可以通过<code>npm install gojs -save</code>安装</p>
<p>效果图
{% asset_img gojs.png %}</p>
<p>看里面的demo我自己包装了一下</p>
<pre><code class="language-html">&lt;template&gt;
&lt;div&gt;
  &lt;p style=&quot;background-color:#d5d5d5;margin:0;padding:5px;&quot;&gt;
    您当前处于 &lt;span class=&quot;tip&quot;&gt;用户提交资料&lt;/span&gt; 步骤 
    下一步等待&lt;span class=&quot;tip&quot;&gt;供应商接单&lt;/span&gt;
    &lt;el-button type=&quot;text&quot; v-if=&quot;show===false&quot; @click=&quot;show=true&quot;&gt;展开&lt;/el-button&gt;
    &lt;el-button type=&quot;text&quot; v-else @click=&quot;show=false&quot;&gt;收起&lt;/el-button&gt;

  &lt;/p&gt;
  &lt;div id=&quot;myDiagramDiv&quot; v-show=&quot;show&quot;  &gt;&lt;/div&gt;
  &lt;/div&gt; 

&lt;/template&gt;
&lt;style scoped&gt;
.tip{
  color:red;
  font-size:0.8em;
  font-weight:bold;
  padding:5px;
}
#myDiagramDiv{
  height: 200px; 
  border: solid 1px #d3d3d3;
}

&lt;/style&gt;</code></pre>
<pre><code class="language-javascript">&lt;script&gt;
window.go =require(&#39;./go.js&#39;) 
var $ = go.GraphObject.make;

import datam from &#39;./data&#39;;
export default{
  mixins:[datam],
  data(){
    return{
      myDiagram:null,
      show:true
    }
  },
  mounted(){
    this.load();
  },
  methods:{
    load(){
      this.init();
      this.addNodeTemplate(this.User);
      this.addNodeTemplate(this.Supplier);
      this.layout();
    },
    layout() {
      this.myDiagram.model = go.Model.fromJson(this.myjson);
      this.myDiagram.layoutDiagram(true);
    },

    getOption(){
      // for conciseness in defining templates

      let options={
        yellowgrad : $(go.Brush, &quot;Linear&quot;, { 0: &quot;rgb(254, 201, 0)&quot;, 1: &quot;rgb(254, 162, 0)&quot; }),
        greengrad : $(go.Brush, &quot;Linear&quot;, { 0: &quot;#98FB98&quot;, 1: &quot;#9ACD32&quot; }),
        bluegrad : $(go.Brush, &quot;Linear&quot;, { 0: &quot;#B0E0E6&quot;, 1: &quot;#87CEEB&quot; }),
        redgrad : $(go.Brush, &quot;Linear&quot;, { 0: &quot;#C45245&quot;, 1: &quot;#871E1B&quot; }),
        whitegrad : $(go.Brush, &quot;Linear&quot;, { 0: &quot;#F0F8FF&quot;, 1: &quot;#E6E6FA&quot; }),
        bigfont : &quot;bold 8pt Helvetica, Arial, sans-serif&quot;,
        smallfont : &quot;bold 6pt Helvetica, Arial, sans-serif&quot;,

      }

      return options;
    },

     textStyle(){
        return {
          margin: 6,
          wrap: go.TextBlock.WrapFit,
          textAlign: &quot;center&quot;,
          editable: true,
          font: this.getOption()[&#39;bigfont&#39;]
        }
      },
      init(){
        this.myDiagram =
            $(go.Diagram, &quot;myDiagramDiv&quot;,
              {
                isReadOnly: true,
                // have mouse wheel events zoom in and out instead of scroll up and down
                &quot;toolManager.mouseWheelBehavior&quot;: go.ToolManager.WheelNone,
                initialAutoScale: go.Diagram.Uniform,
                &quot;linkingTool.direction&quot;: go.LinkingTool.ForwardsOnly,
                initialContentAlignment: go.Spot.Center,
                layout: $(go.LayeredDigraphLayout, { isInitial: false, isOngoing: false, layerSpacing: 50 }),
                &quot;undoManager.isEnabled&quot;: true
              });
              //默认节点模板
        this.myDiagram.nodeTemplate =
            $(go.Node, &quot;Auto&quot;,
              new go.Binding(&quot;location&quot;, &quot;loc&quot;, go.Point.parse).makeTwoWay(go.Point.stringify),
              // define the node&#39;s outer shape, which will surround the TextBlock
              $(go.Shape, &quot;Rectangle&quot;,
                { fill: this.getOption()[&#39;yellowgrad&#39;], stroke: &quot;black&quot;,
                  portId: &quot;&quot;, fromLinkable: true, toLinkable: true, cursor: &quot;pointer&quot;,
                  toEndSegmentLength: 50, fromEndSegmentLength: 40 }),
              $(go.TextBlock, &quot;Page&quot;,
                { margin: 6,
                  font: this.getOption()[&#39;bigfont&#39;],
                  editable: true },
                new go.Binding(&quot;text&quot;, &quot;text&quot;).makeTwoWay()));
            // replace the default Link template in the linkTemplateMap
          this.myDiagram.linkTemplate =
                $(go.Link,  // the whole link panel
                  new go.Binding(&quot;points&quot;).makeTwoWay(),
                  { curve: go.Link.Bezier, toShortLength: 15 },
                  new go.Binding(&quot;curviness&quot;, &quot;curviness&quot;),
                  $(go.Shape,  // the link shape
                    { stroke: &quot;#2F4F4F&quot;, strokeWidth: 2.5 }),
                  $(go.Shape,  // the arrowhead
                    { toArrow: &quot;kite&quot;, fill: &quot;#2F4F4F&quot;, stroke: null, scale: 2 })
                  );
      },
      /**
       * options:{
       *  category
       *  shape:RoundedRectangle/Rectangle
       *  shapeOptions:{
       *   fill:bluegrad/greengrad/yellowgrad/null/redgrad/whitegrad  自定义的
       *   stroke: &quot;black&quot;,
       *   portId:&quot;&quot;
       *   fromLinkable:true
       *   toLinkable:
       *   cursor:&quot;pointer&quot;
       *   fromEndSegmentLength:40
       *    toEndSegmentLength
       *    strokeWidth
       *  
       *   }
       *    textStyle:{
       *        margin: 9,
       *        maxSize: new go.Size(200, NaN),
       *        wrap: go.TextBlock.WrapFit,
        *       editable: true,
        *       textAlign: &quot;center&quot;,
        *       font: smallfont 
        * },
       *    
       * }
       */
      addNodeTemplate(options){
        let fill = this.getOption()[options.shapeOptions.fill];
        options.shapeOptions.fill = fill;
        this.myDiagram.nodeTemplateMap.add(options.category,
          $(go.Node, &quot;Auto&quot;,
            new go.Binding(&quot;location&quot;, &quot;loc&quot;, go.Point.parse).makeTwoWay(go.Point.stringify),
            $(go.Shape, options.shape,options.shapeOptions),
            $(go.TextBlock,  this.textStyle(),
              new go.Binding(&quot;text&quot;, &quot;text&quot;).makeTwoWay())
            ));
      },

    }


}

&lt;/script&gt;

</code></pre>
<p><strong>不满意的地方</strong>：</p>
<ol>
<li>免费版gojs是有水印的，百度搜索“gojs如何去水印”有一堆答案，我就不写了。</li>
<li>因为要自己手动去掉水印，所以我只能手动下载go.js放在我自己的组件目录下，但是这个文件太大了，800+KB,
npm run dev 的时候停在这里停了好久。有时候还爆出“......maximun ....500KB”的错误，我也不知道是什么原因，不知道有什么方法，有的话麻烦通知我。</li>
<li>代码写法有点太繁琐</li>
</ol>
<p>这是我自己包装的代码地址：<a href="https://github.com/LRY1994/vue-lib/tree/master/src/components/process-go">https://github.com/LRY1994/vue-lib/tree/master/src/components/process-go</a></p>
<h3 id="jointjs">jointjs</h3>
<p>github : <a href="https://github.com/clientIO/joint">https://github.com/clientIO/joint</a> 
效果图
{% asset_img jointjs.png %}</p>
<p>可以通过<code>npm install jointjs -save</code>安装</p>
<p>参照了很多demo和文档，用的是矩形，但是可以设置圆角的度数变成椭圆形，其他形状我就无力了。</p>
<p>可以自定义矩形的样式和矩形框里面的文字样式</p>
<pre><code class="language-javascript">//data.vue
&lt;script&gt;
export default {
    data(){
        var userClass = {//这个要参照SVG属性
            /**shapeStyle
             * fill:填充的背景颜色
                stroke: 边框颜色
                strokeWidth: 边框宽度
                rx: 圆角
                ry: 
             */
            shapeStyle:{//矩形样式
                fill:{
                    type: &#39;linearGradient&#39;,
                    stops: [
                        {offset: &#39;0%&#39;, color: &#39;#98FB98&#39;},
                        {offset: &#39;100%&#39;, color: &#39;#9ACD32&#39;}
                    ],
                },
                rx:150,
                ry:15
            },
            /**
             * textStyle
             *  fontWeight
             *  fontSize
             * 
             */
            textStyle:{//文本样式
                fontWeight:&#39;bold&#39;
            }    
        };
        return{
            graphData :{
                node:{
                    &#39;100&#39;:{text:&#39;用户提交资料&#39;,category:userClass},
                    &#39;101&#39;:{text:&#39;用户完善资料&#39;,category:userClass},
                    &#39;102&#39;:{text:&#39;用户确认完成&#39;,category:userClass},
                    &#39;103&#39;:{text:&#39;用户撤销&#39;,category:userClass},

                    &#39;200&#39;:{text:&#39;供应商驳回&#39;},
                    &#39;201&#39;:{text:&#39;供应商接单&#39;},
                    &#39;202&#39;:{text:&#39;供应商完工&#39;},
                    &#39;203&#39;:{text:&#39;等待供应商处理&#39;},

                    &#39;300&#39;:{text:&#39;系统交付出错&#39;}               
                },
                edge :{//每个点都要写
                    &#39;100&#39;: [&#39;200&#39;,&#39;201&#39;,&#39;103&#39;], 
                    &#39;101&#39;: [&#39;201&#39;],
                    &#39;102&#39;:[],
                    &#39;103&#39;: [&#39;100&#39;],

                    &#39;200&#39;: [&#39;101&#39;],              
                    &#39;201&#39;: [&#39;202&#39;,&#39;300&#39;],
                    &#39;202&#39;: [&#39;102&#39;],               
                    &#39;203&#39;: [&#39;102&#39;], 

                    &#39;300&#39;: [&#39;203&#39;],

                },
            }
        }
    }
}
&lt;/script&gt;
</code></pre>
<pre><code class="language-html">&lt;template&gt;
&lt;div id=&quot;container&quot;&gt;
  &lt;p style=&quot;background-color:#EEEEEE;margin:0;padding:5px;font-size:0.9em&quot;&gt;
    您当前处于 &lt;span class=&quot;tip&quot;&gt;用户提交资料&lt;/span&gt; 步骤 
    下一步等待&lt;span class=&quot;tip&quot;&gt;供应商接单&lt;/span&gt;
    &lt;el-button type=&quot;text&quot; v-if=&quot;show===false&quot; @click=&quot;show=true&quot;&gt;展开&lt;/el-button&gt;
    &lt;el-button type=&quot;text&quot; v-else @click=&quot;show=false&quot;&gt;收起&lt;/el-button&gt;

  &lt;/p&gt;
    &lt;div id=&quot;myholder&quot; v-show=&quot;show&quot;&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/template&gt;</code></pre>
<pre><code class="language-javascript">&lt;script&gt;
window.joint=require(&#39;jointjs&#39;);
var Shape = joint.dia.Element.define(&#39;default.Rectangle&#39;, {      
        attrs: {  
            rect: {
                refWidth: &#39;100%&#39;,
                refHeight: &#39;100%&#39;,
                //下面这些可以自己设置
                fill:{
                    type: &#39;linearGradient&#39;,
                    stops: [
                        {offset: &#39;0%&#39;, color: &#39;#B0E0E6&#39;},//渐变开始
                        {offset: &#39;100%&#39;, color: &#39;#F0F8FF&#39;}//渐变结束
                    ]
                },
                stroke: &#39;#B0E0E6&#39;,
                strokeWidth: 1,
                rx: 5,//圆角
                ry: 5
            },
            text: {
                refX: &#39;50%&#39;,
                refY: &#39;50%&#39;,                               
                textVerticalAnchor: &#39;middle&#39;,
                textAnchor: &#39;middle&#39;,
                fontSize: 10           
            }
         }                    
    }, 
    {
         markup: &#39;&lt;rect/&gt;&lt;text/&gt;&#39;,
         setText: function(text) {                    
            return this.attr(&#39;text/text&#39;, text || &#39;&#39;);
        },
        setShapeStyle:function(shapeStyle){
            let newstyle = Object.assign({},this.attr(&#39;rect&#39;),shapeStyle);
            return this.attr(&#39;rect&#39;,newstyle)
        },

        setTextStyle:function(textStyle){
            let newstyle = Object.assign({},this.attr(&#39;text&#39;),textStyle);
            return this.attr(&#39;text&#39;,newstyle)
        }
    }
);

var Link = joint.dia.Link.define(&#39;default.Link&#39;, {
        attrs: {
            &#39;.connection&#39;: {
                stroke: &#39;#2F4F4F&#39;,//线
                strokeWidth: 1,
                pointerEvents: &#39;none&#39;,
                targetMarker: {//箭头
                    type: &#39;path&#39;,
                    fill: &#39;#2F4F4F&#39;,//填充颜色
                    stroke: &#39;#2F4F4F&#39;,//边框颜色
                    strokeWidth:&#39;1&#39;,
                    d: &#39;M 2 -2 0 0 2 2 z&#39;//形状
                }
            }
        },
        connector: {
            name: &#39;rounded&#39;
        },
        z: -1,
        weight: 1,
        minLen: 1,
        labelPosition: &#39;c&#39;,
        labelOffset: 10,
        labelSize: {
            width: 50,
            height: 30
        },
        labels: [{
            markup: &#39;&lt;rect/&gt;&lt;text/&gt;&#39;,
            attrs: {
                text: {
                    fill: &#39;gray&#39;,
                    textAnchor: &#39;middle&#39;,
                    refY: 5,
                    refY2: &#39;-50%&#39;,
                    fontSize: 10,
                    cursor: &#39;pointer&#39;
                },
                // rect: {
                //     fill: &#39;lightgray&#39;,
                //     stroke: &#39;gray&#39;,
                //     strokeWidth: 2,
                //     refWidth: &#39;100%&#39;,
                //     refHeight: &#39;100%&#39;,
                //     refX: &#39;-50%&#39;,
                //     refY: &#39;-50%&#39;,
                //     rx: 5,
                //     ry: 5
                // }
            },
            size: {
                width: 50, height: 10
            }
        }]

    }, {
        markup: &#39;&lt;path class=&quot;connection&quot;/&gt;&lt;g class=&quot;labels&quot;/&gt;&#39;,

        connect: function(sourceId, targetId) {
            return this.set({
                source: { id: sourceId },
                target: { id: targetId }
            });
        },

        setLabelText: function(text) {
            return this.prop(&#39;labels/0/attrs/text/text&#39;, text || &#39;&#39;);
        }
    });



var ElementView = joint.dia.ElementView.extend({
        pointerdown: function () {

            // this._click = true;
            // joint.dia.ElementView.prototype.pointerdown.apply(this, arguments);
        },
        pointermove: function(evt, x, y) {
            // this._click = false;
            // joint.dia.ElementView.prototype.pointermove.apply(this, arguments);
        },
        pointerup: function (evt, x, y) {
            // if (this._click) {
            //     // triggers an event on the paper and the element itself
            //     this.notify(&#39;cell:click&#39;, evt, x, y); 
            // } else {
            //     joint.dia.ElementView.prototype.pointerup.apply(this, arguments);
            // }
        }
    });
var LinkView = joint.dia.LinkView.extend({
    addVertex: function(evt, x, y) {},
    removeVertex: function(endType) {},
    pointerdown:function(evt, x, y) {}
});


export default {   
    data(){
        return{
            graph:null,
            paper:null,
            show:true
        }       
    },
    props:{
        graphData:{
            type:Object,
            required:true
        }
    },
    mounted(){
        let w = document.getElementById(&#39;container&#39;).width ; 
        this.graph = new joint.dia.Graph;
        this.paper = new joint.dia.Paper({
            el: document.getElementById(&#39;myholder&#39;),
            width: w,
            height: 250,         
            model: this.graph,
            elementView: ElementView,//禁止拖拽
            linkView:LinkView//禁止拖拽
        });
        this.layout();
    },
    methods:{
        getWidthandHeight(label){
            let maxLineLength = _.max(label.split(&#39;\n&#39;), function(l) { return l.length; }).length,

            // Compute width/height of the rectangle based on the number
            // of lines in the label and the letter size. 0.6 * letterSize is
            // an approximation of the monospace font letter width.
             letterSize = 8,
             width = 2 * (letterSize * (0.6 * maxLineLength + 1)),
             height = 2 * ((label.split(&#39;\n&#39;).length + 1) * letterSize);
            return {width,height}
        },
        getLayoutOptions() {
            return {
                // setVertices: false,
                // setLabels: false,
                // ranker:&#39;longer-path&#39;,//&#39;tight-tree&#39;/&#39;network-simplex&#39;,
                rankDir: &#39;LR&#39;,
                align: &#39;UR&#39;,
                rankSep:0,
                edgeSep:0,
                nodeSep:0,
            };
        },
        buildGraphFromAdjacencyList(adjacencyList) {
            let elements = [],links = [],obj,size,node;
            const _this=this;
            const map=this.graphData.node;

            Object.keys(adjacencyList).forEach(function(parentId) {
                // Add element

                obj =map[parentId];
                size = _this.getWidthandHeight(obj.text);
                node =new Shape({id:parentId,size:size}).setText(obj.text);

                if(obj.category&amp;&amp;obj.category.shapeStyle){
                    node = node.setShapeStyle(obj.category.shapeStyle);
                }
                if(obj.category&amp;&amp;obj.category.textStyle){
                    node = node.setTextStyle(obj.category.textStyle);
                }

                elements.push(node);

                // Add links
                adjacencyList[parentId].forEach(function(childId) {
                    links.push(
                        new Link().connect(parentId, childId)// .setLabelText(parentLabel + &#39;-&#39; + childLabel)                                         
                    );
                });
            });

            return elements.concat(links);
        },
        layout() {            
            let cells = this.buildGraphFromAdjacencyList(this.graphData.edge);    
            this.graph.resetCells(cells);
            joint.layout.DirectedGraph.layout(this.graph, this.getLayoutOptions());
        },
    }
}
&lt;/script&gt;

&lt;style&gt;
#myholder {
    border: 1px solid lightgray;
    margin-bottom:20px;
    padding-left:20px
}
.tip{
  color:#9ACD32;
  font-size:0.9em;
  font-weight:bold;
  padding:5px;
}
&lt;/style&gt;
</code></pre>
<p>这是我自己包装的代码地址：<a href="https://github.com/LRY1994/vue-lib/tree/master/src/components/process-joint">https://github.com/LRY1994/vue-lib/tree/master/src/components/process-joint</a></p>
<p>这个目前看来还算满意</p>
<h3 id="jsplumb">jsplumb</h3>
<p>这个看了官网，不太友好，而且下载只有一个js文件，没有demo代码，不知如何下手</p>
<h3 id="参考资料：">参考资料：</h3>
<p><a href="https://gojs.net/latest/samples/pageFlow.html">https://gojs.net/latest/samples/pageFlow.html</a>
<a href="http://www.daviddurman.com/assets/autolayout.js">http://www.daviddurman.com/assets/autolayout.js</a>
<a href="http://resources.jointjs.com/demos/layout">http://resources.jointjs.com/demos/layout</a></p>
<p>---------------------------------------------更新 2018/8/30----------------------------------------------------------
经过一番实践，我觉得jointjs不好用了。
不满意点：</p>
<ol>
<li>不能相对容器自动布局，都用的是死的像素，分辨率低的屏幕，部分图有些就看不见
{% asset_img joint-error.png %}</li>
<li>不能滚动鼠标自己缩小放大</li>
<li>比较丑，也可能是我不会配色</li>
</ol>
<p>最终采用gojs,上面提到的问题解决方案是：把去掉水印的gojs放在自己的npm服务器上，这样就可以npm安装了！！！
实践过程中遇到个问题</p>
<pre><code class="language-html">&lt;process-go style=&quot;height:250px&quot;  v-if=&quot;show&quot;  :model-data=&quot;dataObj.graph&quot; :category=&quot;category&quot;&gt; &lt;/process-go&gt;</code></pre>
<p>像这样，用<code>v-if</code>反复切换，会报错<code>Cannot read property &#39;type&#39; of undefined     at Po (go.js?d976:1044)</code></p>
<p>换成<code>v-show</code>就不会</p>
<pre><code class="language-html">&lt;process-go style=&quot;height:250px&quot;  v-show=&quot;show&quot;  :model-data=&quot;dataObj.graph&quot; :category=&quot;category&quot;&gt; &lt;/process-go&gt;</code></pre>
<p>但是这样的前提是show初始化是true.如果初始化为false,没有报错，但是图呈现不出来。
原因我猜测是：show初始化为false,组件高度为0，因为默认画布就是组件容器，所以画布高度变成0，图画不出。</p>
<p>最后想出个方法。<code>v-if</code>和<code>v-show</code>结合一起使用，加上<code>$once</code>方法，代码：</p>
<pre><code class="language-html">&lt;process-go style=&quot;height:250px&quot; v-if=&quot;firstClick&quot; v-show=&quot;show&quot;  :model-data=&quot;dataObj.graph&quot; :category=&quot;category&quot;&gt; &lt;/process-go&gt;</code></pre>
<pre><code class="language-javascript">data(){
    return{        
        show:false,
        firstClick:false,
    }
}
created(){
    this.init();
    this.$once(&#39;firstClick&#39;,()=&gt;{
        this.firstClick = true
    })
},
methods:{
    init(){...},
    look(){//用v-if切换会报错，只有第一次点击查看用v-if,其他用v-show
        this.$emit(&#39;firstClick&#39;);
        this.show = true;
    }
}</code></pre>
<p>重新封装了一下gojs 地址：<a href="https://github.com/LRY1994/vue-lib/blob/master/src/components/process-go/index.vue">https://github.com/LRY1994/vue-lib/blob/master/src/components/process-go/index.vue</a></p>

        </div>
    </div>
    
</body>
</html>