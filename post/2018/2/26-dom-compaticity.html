<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="icon" href="/static/favicon.ico" type="image/x-icon"/>
    <link rel="stylesheet" href="/static/css/all.css" />
    <!---hljs的css-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/bootstrap/3.2.0/css/bootstrap.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/highlight.js/9.1.0/styles/github.min.css">

    <title>大脸圆玉的博客</title>
</head>
<body>

    <div class="l-nav">
        <div class="nav-img">
    <img src="/static/img/avatar.png"/>
</div>


<ul>
    
        
            <li class="li-active"> 
                <svg class="icon" aria-hidden="true">
                    <use xlink:href="#icon-xilanhua"></use>
                </svg>
                <a href="/categories/Experience.html">Experience</a>
            </li>
        
        
            <li > 
                <svg class="icon" aria-hidden="true">
                    <use xlink:href="#icon-nangua"></use>
                </svg>
                <a href="/categories/Reading.html">Reading</a>
            </li>
        
    
        
            <li > 
                <svg class="icon" aria-hidden="true">
                    <use xlink:href="#icon-qiezi"></use>
                </svg>
                <a href="/categories/Collection.html">Collection</a>
            </li>
        
    
</ul>

<div class="intro">
    <div>
       <a href="https://www.douban.com/people/167927352/" target="_blank"> 
        <svg class="icon" aria-hidden="true">
            <use xlink:href="#icon-doubanwang"></use>
        </svg>
        </a>
        <a href="http://www.mafengwo.cn/u/78143999.html" target="_blank"> 
            <svg class="icon" aria-hidden="true">
                <use xlink:href="#icon-mafengwo"></use>
            </svg>
        </a> 
        <a href="https://www.douban.com/people/167927352/" target="_blank"> 
            <svg class="icon" aria-hidden="true">
                <use xlink:href="#icon-github"></use>
            </svg>
        </a> 
    </div>
</div>
    </div>
    <div class="r-box">
        <div class="article">
            <h1 class="title">原生DOM兼容特性总结</h1>            
            <p>I belong to : Experience</p>
            <hr/>
            <p>浏览器主要也就是IE有点独特，所以把IE重点区分开</p>
<table>
<thead>
<tr>
<th>名称</th>
<th align="left">主流</th>
<th align="left">IE</th>
</tr>
</thead>
<tbody><tr>
<td>内文本</td>
<td align="left">innerText</td>
<td align="left">textContent</td>
</tr>
<tr>
<td>请求对象</td>
<td align="left">XMLHttpRequest</td>
<td align="left">ActiveXObject<br>[&quot;MSXML2.XMLHttp.6.0&quot;,&quot;MSXML2.XMLHttp.3.0&quot;,&quot;MSXML2.XMLHttp&quot;]</td>
</tr>
<tr>
<td>监听事件添加</td>
<td align="left">addEventListener(DOM2),<br> [&#39;on&#39;+eventName](DOM0)</td>
<td align="left">attachEvent</td>
</tr>
<tr>
<td>监听事件移除</td>
<td align="left">removeEventListener(DOM2),<br>[&#39;on&#39;+eventName]=null(DOM0)</td>
<td align="left">detachEvent</td>
</tr>
<tr>
<td>事件对象</td>
<td align="left">function(e) e</td>
<td align="left">window.event(IE7之前)</td>
</tr>
<tr>
<td>阻止默认事件</td>
<td align="left">preventDefault</td>
<td align="left">e.returnValue=false</td>
</tr>
<tr>
<td>阻止冒泡</td>
<td align="left">stopPropagation</td>
<td align="left">e.cancelBubble=true</td>
</tr>
<tr>
<td>键盘事件键盘编码</td>
<td align="left">e.charCode</td>
<td align="left">e.keyCode</td>
</tr>
<tr>
<td>获取剪贴板的文本</td>
<td align="left">e.clipboardData</td>
<td align="left">window.clipboardData</td>
</tr>
<tr>
<td>设置剪贴板文本</td>
<td align="left">e.clipboardData.setData(&quot;text/plain&quot;,value);</td>
<td align="left">window.clipboardData.setData(&quot;text&quot;,value);</td>
</tr>
<tr>
<td>触发事件的元素</td>
<td align="left">e.target</td>
<td align="left">e.srcElement</td>
</tr>
<tr>
<td>获取样式</td>
<td align="left">getComputedStyle(obj,false)[attr];(Firefox浏览器)<br> obj.style.attr(只对filter,opacity等有效)<br>obj.style[attr]</td>
<td align="left">obj.currentStyle[attr];</td>
</tr>
<tr>
<td>窗口左边的位置</td>
<td align="left">window.screenLeft</td>
<td align="left">window.screenX</td>
</tr>
<tr>
<td>页面视口大小</td>
<td align="left">window.innerHeight</td>
<td align="left">if(document.compatMode==&quot;CSS1Compat&quot;)window.documentElement.clientHeight;<br> if(document.compatMode==&quot;BackCompat&quot;)window.body.clientHeight<br></td>
</tr>
<tr>
<td>获取元素</td>
<td align="left">document.getElementById(id);</td>
<td align="left">document.all[id];(IE5)</td>
</tr>
<tr>
<td>返回指定的属性</td>
<td align="left">ele.getAttribute(attr)</td>
<td align="left">ele.attribute[attr]</td>
</tr>
<tr>
<td>ele是否存在指定属性 attr</td>
<td align="left">ele.hasAttribute(attr)</td>
<td align="left">ele.attributes[attr].specified;</td>
</tr>
<tr>
<td>鼠标滚动，正数表示向上滚动</td>
<td align="left">function getWheelDelta(e){<br>if(e.wheelData){<br>return (client.engine.opera&amp;&amp;client.engine.opera&lt;9.5)?<br>-e.wheelData:e.wheelData;<br>}else {<br>return -e.detail*40;//firefox<br>}<br>}</td>
<td align="left"></td>
</tr>
<tr>
<td>提取选中的文本</td>
<td align="left">textbox.value.subString(textbox.selectionStart,textbox.selectionEnd);</td>
<td align="left">document.selection.createRange().text;<br>(IE8之前没有selectionStart，selectionEnd属性</td>
</tr>
<tr>
<td>设置文本选中</td>
<td align="left">textbox.setSelectionRange(startIndex,stopIndex);</td>
<td align="left">var range=textbox.createTextRange();<br>range.collapse(true);<br>range.moveStart(&quot;character&quot;,0);<br>range.moveEnd(&quot;character&quot;,stopIndex-startIndex);<br>range.select()</td>
</tr>
</tbody></table>
<p>下面是积累下来的一些兼容函数，可以当做模板用</p>
<ul>
<li><a href="#%E6%B7%BB%E5%8A%A0%E5%A4%9A%E4%B8%AAonload%E4%BA%8B%E4%BB%B6">添加多个onload事件</a></li>
<li><a href="#%E5%A4%84%E7%90%86ActiveXObject/XMLHttpRequest%E9%97%AE%E9%A2%98">处理ActiveXObject/XMLHttpRequest问题</a></li>
<li><a href="#%E8%AF%B7%E6%B1%82%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%B1%9E%E6%80%A7%E5%92%8C%E6%96%B9%E6%B3%95%E8%AE%BE%E7%BD%AE">请求对象的属性和方法设置</a></li>
<li><a href="#%E5%8F%91%E9%80%81%E8%A1%A8%E5%8D%95%E6%95%B0%E6%8D%AE">发送表单数据</a></li>
<li><a href="#%E8%B7%A8%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%84CORS">跨浏览器的CORS</a></li>
<li><a href="#%E8%B7%A8%E6%B5%8F%E8%A7%88%E5%99%A8%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86%E7%A8%8B%E5%BA%8F">跨浏览器事件处理程序</a></li>
<li><a href="#%E5%A4%84%E7%90%86target/srcelemnt%E9%97%AE%E9%A2%98%EF%BC%8C%E4%BB%A3%E6%9B%BFthis">处理target/srcelemnt问题，代替this</a></li>
<li><a href="#%E5%AE%9E%E7%8E%B0insertAfter">实现insertAfter</a></li>
<li><a href="#%E7%BB%99element%E5%8A%A0%E4%B8%8A%E7%B1%BB%E5%90%8D">给element加上类名</a></li>
<li><a href="#%E5%88%A4%E6%96%AD%E6%98%AF%E4%B8%8D%E6%98%AF%E6%95%B0%E7%BB%84">判断是不是数组</a></li>
<li><a href="#IE10%E4%B9%8B%E5%89%8D%E4%B8%8D%E6%94%AF%E6%8C%81docunment.getElementByClassName">IE10之前不支持docunment.getElementByClassName</a></li>
<li><a href="#%E8%8E%B7%E5%8F%96css%E6%A0%B7%E5%BC%8F">获取css样式</a></li>
<li><a href="#%E6%89%8B%E5%86%99%E5%8A%A8%E7%94%BB">手写动画</a></li>
<li><a href="#%E5%8F%96%E5%BE%97%E7%AA%97%E5%8F%A3%E5%B7%A6%E8%BE%B9%E5%92%8C%E4%B8%8A%E8%BE%B9%E7%9A%84%E4%BD%8D%E7%BD%AE">取得窗口左边和上边的位置</a></li>
<li><a href="#%E5%8F%96%E5%BE%97%E9%A1%B5%E9%9D%A2%E8%A7%86%E5%8F%A3%E5%A4%A7%E5%B0%8F">取得页面视口大小</a></li>
<li><a href="#%E6%A3%80%E6%B5%8B%E6%8F%92%E4%BB%B6%E6%96%B9%E6%B3%95">检测插件方法</a></li>
<li><a href="#%E8%8E%B7%E5%8F%96%E5%85%83%E7%B4%A0">获取元素</a></li>
<li><a href="#%E6%A3%80%E6%9F%A5%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%9F%90%E4%B8%AA%E7%89%B9%E6%80%A7%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8">检查对象的某个特性是否存在</a></li>
<li><a href="#%E5%AF%B9%E8%B1%A1%E8%BD%AC%E6%8D%A2%E6%88%90%E6%95%B0%E7%BB%84">对象转换成数组</a></li>
<li><a href="#%E8%BF%94%E5%9B%9E%E6%8C%87%E5%AE%9A%E7%9A%84%E5%B1%9E%E6%80%A7">返回指定的属性</a></li>
<li><a href="#ele%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8%E6%8C%87%E5%AE%9A%E5%B1%9E%E6%80%A7">ele是否存在指定属性</a></li>
<li><a href="#ele%E6%98%AF%E5%90%A6%E7%AC%A6%E5%90%88%E9%80%89%E6%8B%A9%E5%99%A8selector">ele是否符合选择器selector</a></li>
<li><a href="#%E8%8E%B7%E5%8F%96%E5%86%85%E6%96%87%E6%9C%AC">获取内文本</a></li>
<li><a href="#%E8%8E%B7%E5%8F%96%E9%BC%A0%E6%A0%87%E4%BA%8B%E4%BB%B6%E7%9A%84%E7%88%B6%E5%85%83%E7%B4%A0">获取鼠标事件的父元素</a></li>
<li><a href="#%E6%8E%A2%E6%B5%8B%E6%8C%89%E7%9A%84%E6%98%AF%E9%BC%A0%E6%A0%87%E7%9A%84%E5%93%AA%E4%B8%AA%E9%94%AE">探测按的是鼠标的哪个键</a></li>
<li><a href="#%E9%BC%A0%E6%A0%87%E6%BB%9A%E5%8A%A8%E4%BA%8B%E4%BB%B6">鼠标滚动事件</a></li>
<li><a href="#%E6%8F%90%E5%8F%96%E9%80%89%E4%B8%AD%E7%9A%84%E6%96%87%E6%9C%AC">提取选中的文本</a></li>
<li><a href="#%E8%AE%BE%E7%BD%AE%E6%96%87%E6%9C%AC%E9%80%89%E4%B8%AD">设置文本选中</a></li>
<li><a href="#bind%E6%96%B9%E6%B3%95%E5%AF%B9%E8%80%81%E7%89%88%E6%9C%AC%E7%9A%84%E6%B5%8F%E8%A7%88%E5%99%A8%E4%B8%8D%E8%B5%B7%E4%BD%9C%E7%94%A8">bind方法对老版本的浏览器不起作用</a></li>
<li><a href="#%E5%8C%85%E8%A3%85cookie">包装cookie</a></li>
<li><a href="#%E5%8C%85%E8%A3%85%E5%AD%90cookie">包装子cookie</a></li>
<li><a href="#indexedDB">indexedDB</a></li>
<li><a href="#%E6%89%8B%E5%86%99typeof">手写typeof</a></li>
<li><a href="#%E6%B7%B1%E5%BA%A6%E5%85%8B%E9%9A%86">深度克隆</a></li>
<li><a href="#%E7%BB%84%E5%90%88%E4%BD%BF%E7%94%A8%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E6%A8%A1%E5%BC%8F%E5%92%8C%E5%8E%9F%E5%9E%8B%E6%A8%A1%E5%BC%8F%E5%88%9B%E5%BB%BA%E5%AF%B9%E8%B1%A1">组合使用构造函数模式和原型模式创建对象</a></li>
<li><a href="#%E7%BB%84%E5%90%88%E7%BB%A7%E6%89%BF">组合继承</a></li>
<li><a href="#%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F">观察者模式</a></li>
<li><a href="#%E5%88%86%E4%BA%AB%E4%B8%80%E4%B8%AA%E9%A2%98%E7%9B%AE">分享一个题目</a></li>
</ul>
<h2 id="添加多个onload事件">添加多个onload事件</h2>
<pre><code class="language-javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addLoadEvent</span>(<span class="hljs-params">func</span>)</span>{
    <span class="hljs-keyword">var</span> oldonload=<span class="hljs-built_in">window</span>.onload;
    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span>.onload!= <span class="hljs-string">'function'</span>){
        <span class="hljs-built_in">window</span>.onload=func;
    }
    <span class="hljs-keyword">else</span>{
        <span class="hljs-built_in">window</span>.onload=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
            oldonload();
            func();
        }
    }

}</code></pre>
<h2 id="处理activexobjectxmlhttprequest问题">处理ActiveXObject/XMLHttpRequest问题</h2>
<pre><code class="language-javascript"><span class="hljs-comment">//第一种写法，《js高级程序设计》的写法  惰性载入技巧</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createXHR</span>(<span class="hljs-params"></span>)</span>{
    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> XMLHttpRequest!=<span class="hljs-string">"undefined"</span>){<span class="hljs-comment">//XMLHttpRequest</span>
        createXHR=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> XMLHttpRequest();
        };
    }<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> ActiveXObject!=<span class="hljs-string">"undefined"</span>){<span class="hljs-comment">//IE ActiveXObject</span>
        createXHR=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
            <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">arguments</span>.callee.activeXString!=<span class="hljs-string">"string"</span>){
                <span class="hljs-keyword">var</span> versions=[<span class="hljs-string">"MSXML2.XMLHttp.6.0"</span>,<span class="hljs-string">"MSXML2.XMLHttp.3.0"</span>,<span class="hljs-string">"MSXML2.XMLHttp"</span>],<span class="hljs-comment">//IE</span>
                    i,len;
                 <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>,len=versions.length;i&lt;len;i++){
                    <span class="hljs-keyword">try</span>{
                        <span class="hljs-keyword">new</span> ActiveXObject(versions[i]);
                        <span class="hljs-built_in">arguments</span>.callee.activeXString=version[i];
                        <span class="hljs-keyword">break</span>;
                    }<span class="hljs-keyword">catch</span>(ex){}
                 }

            }
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ActiveXObject(<span class="hljs-built_in">arguments</span>.callee.activeXString);
        };
    }<span class="hljs-keyword">else</span>{
        createXHR=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"fail"</span>);
        }
    }
    <span class="hljs-keyword">return</span> createXHR();
}

<span class="hljs-comment">//第二种写法</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createXHR</span>(<span class="hljs-params"></span>)</span>{
    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> XMLHttpRequest==<span class="hljs-string">"undefined"</span>){
        XMLHttpRequest= <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">try</span>{
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ActiveXObject(<span class="hljs-string">"Msxml2.XMLHTTP.6.0"</span>);
            }
            <span class="hljs-keyword">catch</span> (e){}

            <span class="hljs-keyword">try</span>{
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ActiveXObject(<span class="hljs-string">"Msxml2.XMLHTTP.3.0"</span>);
            }
            <span class="hljs-keyword">catch</span> (e){}

            <span class="hljs-keyword">try</span>{
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ActiveXObject(<span class="hljs-string">"Msxml2.XMLHTTP"</span>);
            }
            <span class="hljs-keyword">catch</span> (e){}

            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> XMLHttpRequest();
}</code></pre>
<h2 id="请求对象的属性和方法设置">请求对象的属性和方法设置</h2>
<pre><code class="language-javascript"><span class="hljs-keyword">var</span> xhr=createXHR();
xhr.onreadystatechange=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{<span class="hljs-comment">//firfox引入onlaod，readyState==4时触发,代替onreadystatechange</span>
    <span class="hljs-keyword">if</span>(xhr.readyState==<span class="hljs-number">4</span>){
        <span class="hljs-keyword">try</span>{
            <span class="hljs-keyword">if</span>((xhr.status&gt;=<span class="hljs-number">200</span>&amp;&amp;xhr.status&lt;<span class="hljs-number">300</span>)||xhr.status==<span class="hljs-number">304</span>){
                alert(xhr.responseText);
            }<span class="hljs-keyword">else</span> {
                alert(<span class="hljs-string">"unsuccessful"</span>);
            }
        }<span class="hljs-keyword">catch</span>(ex){}
    }
}
xhr.onload=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
    <span class="hljs-keyword">if</span>((xhr.status&gt;=<span class="hljs-number">200</span>&amp;&amp;xhr.status&lt;<span class="hljs-number">300</span>)||xhr.status==<span class="hljs-number">304</span>){
                alert(xhr.responseText);
            }<span class="hljs-keyword">else</span> {
                alert(<span class="hljs-string">"unsuccessful"</span>);
            }
}
xhr.onprogress=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>)</span>{
    <span class="hljs-keyword">if</span>(event.lengthComputable){<span class="hljs-comment">//进度信息是否可用</span>
        <span class="hljs-built_in">console</span>.log(<span class="hljs-string">"Received"</span>+event.position+<span class="hljs-string">"of"</span>+event.totalSize);
    }
}
xhr.onerror=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
    alert(<span class="hljs-string">"error"</span>);
}
xhr.timeout=<span class="hljs-number">1000</span>;
xhr.ontimeout=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{
    alert(<span class="hljs-string">"timeout"</span>);
}
xhr.open(<span class="hljs-string">"get"</span>,<span class="hljs-string">"example.php"</span>,<span class="hljs-literal">true</span>);
xhr.overrideMimeType(<span class="hljs-string">"text/xml"</span>);
xhr.send(<span class="hljs-literal">null</span>);<span class="hljs-comment">//GET</span></code></pre>
<h2 id="发送表单数据">发送表单数据</h2>
<pre><code class="language-javascript">var form=document.get<span class="hljs-constructor">ElementById(<span class="hljs-string">"info"</span>)</span>;
xhr.send(serialize(form));<span class="hljs-comment">//第一种写法</span>
xhr.send(<span class="hljs-keyword">new</span> <span class="hljs-constructor">FormData(<span class="hljs-params">form</span>)</span>);<span class="hljs-comment">//第二种写法</span></code></pre>
<h2 id="跨浏览器的cors">跨浏览器的CORS</h2>
<pre><code class="language-javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">createCORSRequest</span>(<span class="hljs-params">method,url</span>)</span>{
    <span class="hljs-keyword">var</span> xhr=<span class="hljs-keyword">new</span> XMLHttpRequest();
    <span class="hljs-keyword">if</span>(<span class="hljs-string">"withCredentials"</span> <span class="hljs-keyword">in</span> xhr){
        xhr.withCredentials = <span class="hljs-literal">true</span>;<span class="hljs-comment">//默认情况下，这样的跨域无法带上目标域的会话（Cookies 等），需要设置xhr 实例的withCredentials 属性为true（IE 还不支持）</span>
        xhr.open(method,<span class="hljs-built_in">url</span>,<span class="hljs-literal">true</span>);<span class="hljs-comment">//第三个参数，true 表示异步，false 表示同步</span>
    }<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> XDomainRequest !=<span class="hljs-string">"undefined"</span>){
        xhr=<span class="hljs-keyword">new</span> XDomainRequest();
        xhr.open(method,<span class="hljs-built_in">url</span>);
    }<span class="hljs-title">else</span> {
        xhr=<span class="hljs-literal">null</span>;
    }
    <span class="hljs-keyword">return</span> xhr;
}
<span class="hljs-keyword">var</span> request=createCORSRequest(<span class="hljs-string">"get"</span>,<span class="hljs-string">"http://www.somewhere"</span>);
<span class="hljs-keyword">if</span>(request){
    request.onload=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>)</span>{};<span class="hljs-comment">// 请求成功后</span>
    request.send();
}</code></pre>
<h2 id="跨浏览器事件处理程序">跨浏览器事件处理程序</h2>
<pre><code class="language-javascript"><span class="hljs-keyword">var</span> eventUtil={
    <span class="hljs-comment">// 页面加载完成后</span>
    <span class="hljs-attr">readyEvent</span> : <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">fn</span>) </span>{
        <span class="hljs-keyword">if</span> (fn==<span class="hljs-literal">null</span>) {
            fn=<span class="hljs-built_in">document</span>;
        }
        <span class="hljs-keyword">var</span> oldonload = <span class="hljs-built_in">window</span>.onload;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span>.onload != <span class="hljs-string">'function'</span>) {
            <span class="hljs-built_in">window</span>.onload = fn;
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-built_in">window</span>.onload = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>{
                oldonload();
                fn();
            };
        }
    },

    <span class="hljs-attr">addEventHandler</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">obj, eventName, handler</span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.attachEvent) {<span class="hljs-comment">//IE</span>
            obj.attachEvent(<span class="hljs-string">"on"</span> + eventName, handler);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.addEventListener) {<span class="hljs-comment">//DOM2级</span>
            obj.addEventListener(eventName, handler, <span class="hljs-literal">false</span>);<span class="hljs-comment">//false- 默认。事件句柄在冒泡阶段执行</span>
        }
        <span class="hljs-keyword">else</span>{<span class="hljs-comment">//DOM0级</span>
            obj[<span class="hljs-string">'on'</span>+eventName]=handler;
        }
    },

    <span class="hljs-attr">removeEventHandler</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">obj, eventName, handler</span>)</span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.attachEvent) {<span class="hljs-comment">//IE</span>
            obj.detachEvent(<span class="hljs-string">"on"</span> + eventName, handler);
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">document</span>.addEventListener) {<span class="hljs-comment">//DOM2级</span>
            obj.removeEventListener(eventName, handler, <span class="hljs-literal">false</span>);
        }
        <span class="hljs-keyword">else</span>{<span class="hljs-comment">//DOM0级</span>
            obj[<span class="hljs-string">'on'</span>+eventName]=<span class="hljs-literal">null</span>;
        }
    },
   <span class="hljs-comment">//获取event对象的引用，取到事件的所有信息，确保随时能使用event；</span>
    <span class="hljs-attr">getEvent</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
        <span class="hljs-keyword">var</span> ev = e || <span class="hljs-built_in">window</span>.event;
        <span class="hljs-keyword">if</span> (!ev) {
            <span class="hljs-keyword">var</span> c = <span class="hljs-keyword">this</span>.getEvent.caller;
            <span class="hljs-keyword">while</span> (c) {
                ev = c.arguments[<span class="hljs-number">0</span>];
                <span class="hljs-keyword">if</span> (ev &amp;&amp; Event == ev.constructor) {
                    <span class="hljs-keyword">break</span>;
                }
                c = c.caller;
            }
        }
        <span class="hljs-keyword">return</span> ev;
    },
    <span class="hljs-comment">//事件类型</span>
    <span class="hljs-attr">getType</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
        <span class="hljs-keyword">return</span> e.type;

    },
    <span class="hljs-comment">//调用事件的元素</span>
    <span class="hljs-attr">getElement</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
        <span class="hljs-keyword">return</span> e.target|| e.srcElement;
    },
    <span class="hljs-comment">//阻止默认事件</span>
    <span class="hljs-attr">preventDefault</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>) </span>{
        e= <span class="hljs-keyword">this</span>.getEvent(e);
        <span class="hljs-keyword">if</span>(e.preventDefault){
            e.preventDefault();
        }
        <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> e.returnValue=<span class="hljs-literal">false</span>;<span class="hljs-comment">//IE</span>
        }
    },
    <span class="hljs-comment">//阻止冒泡</span>
    <span class="hljs-attr">stopPropagation</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>{
      <span class="hljs-keyword">if</span>(e.stopPropagation){
          e.stopPropagation();
      }
        <span class="hljs-keyword">else</span> {
          e.cancelBubble=<span class="hljs-literal">true</span>;<span class="hljs-comment">//IE</span>
      }

    },
    <span class="hljs-comment">//键盘事件键盘的编号</span>
    <span class="hljs-attr">getCharCode</span>:<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">e</span>)</span>{
        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> e.charCode==<span class="hljs-string">"number"</span>)<span class="hljs-keyword">return</span> e.charCode;
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> e.keyCode;
    },
    <span class="hljs-comment">//获取剪贴板的文本</span>
    <span class="hljs-attr">getClipbordText</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>)</span>{
        <span class="hljs-keyword">var</span> clipboardData=(e.clipboardData||<span class="hljs-built_in">window</span>.clipboardData);
        <span class="hljs-keyword">return</span> clipboardData.getData(<span class="hljs-string">"text"</span>);
    },
    <span class="hljs-comment">//设置剪贴板文本</span>
    <span class="hljs-attr">setClipboardText</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e,value</span>)</span>{
        <span class="hljs-keyword">if</span>(e.clipboardData){
            <span class="hljs-keyword">return</span> e.clipboardData.setData(<span class="hljs-string">"text/plain"</span>,value);
        }<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-built_in">window</span>.clipboardData){
            <span class="hljs-keyword">return</span> <span class="hljs-built_in">window</span>.clipboardData.setData(<span class="hljs-string">"text"</span>,value);
        }
    },

}</code></pre>
<h2 id="处理targetsrcelemnt问题，代替this">处理target/srcelemnt问题，代替this</h2>
<pre><code class="language-javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getActivatedObject</span>(<span class="hljs-params">e</span>) </span>{
    <span class="hljs-keyword">var</span> obj;
    <span class="hljs-keyword">if</span> (!e) {
        <span class="hljs-comment">// early version of IE</span>
        obj = <span class="hljs-built_in">window</span>.event.srcElement;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (e.srcElement) {
        <span class="hljs-comment">// IE 7 or later</span>
        obj = e.srcElement;
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-comment">// DOM Level 2 browser</span>
        obj = e.target;
    }
    <span class="hljs-keyword">return</span> obj;
}</code></pre>
<h2 id="实现insertafter">实现insertAfter</h2>
<pre><code class="language-javascript"><span class="hljs-comment">/**
 * 把newElement插在targetElement后面 ,js的API只有insertBefore，没有insertAfter
 */</span>
<span class="hljs-keyword">function</span> insert<span class="hljs-constructor">After(<span class="hljs-params">newElement</span>,<span class="hljs-params">targetElement</span>)</span> {
    var parent = targetElement.parentNode;
    <span class="hljs-keyword">if</span> (parent.lastChild<span class="hljs-operator"> == </span>targetElement) {
        parent.append<span class="hljs-constructor">Child(<span class="hljs-params">newElement</span>)</span>;
    } <span class="hljs-keyword">else</span> {
        parent.insert<span class="hljs-constructor">Before(<span class="hljs-params">newElement</span>,<span class="hljs-params">targetElement</span>.<span class="hljs-params">nextSibling</span>)</span>;
    }
}</code></pre>
<h2 id="给element加上类名">给element加上类名</h2>
<pre><code class="language-javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">addClass</span></span>(element,value) {
    <span class="hljs-keyword">if</span> (!element.className) {
        element.className = value;
    } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">new</span><span class="hljs-type">ClassName</span> = element.className;
        <span class="hljs-keyword">new</span><span class="hljs-type">ClassName</span>+= <span class="hljs-string">" "</span>;
        <span class="hljs-keyword">new</span><span class="hljs-type">ClassName</span>+= value;
        element.className = <span class="hljs-keyword">new</span><span class="hljs-type">ClassName</span>;
    }
}</code></pre>
<h2 id="判断是不是数组">判断是不是数组</h2>
<pre><code class="language-javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isArray</span>(<span class="hljs-params">arg</span>) </span>{
    <span class="hljs-comment">//return Object.prototype.toString.call(arr)=='[Object Array]';这种方法也可以</span>
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> arg == <span class="hljs-string">'object'</span>) {
        <span class="hljs-comment">//所有数组都有一个包含单词'arry'的constructor,最后的i表示不区分大小写</span>
        <span class="hljs-keyword">var</span> criteria = arg.<span class="hljs-keyword">constructor</span>.toString(<span class="hljs-params"></span>).match(<span class="hljs-params">/array/i</span>);
        <span class="hljs-keyword">return</span> (criteria != <span class="hljs-literal">null</span>);
    }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
}</code></pre>
<h2 id="ie10之前不支持docunmentgetelementbyclassname">IE10之前不支持docunment.getElementByClassName</h2>
<pre><code class="language-javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getByClass</span>(<span class="hljs-params">clsName,parent</span>)</span>{
    <span class="hljs-keyword">if</span>(docunment.getElementByClassName) <span class="hljs-keyword">return</span> docunment.getElementByClassName(clsName);
    <span class="hljs-comment">//IE10之前</span>
    <span class="hljs-keyword">var</span> oParent=<span class="hljs-built_in">parent</span>?<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-built_in">parent</span>):<span class="hljs-built_in">document</span>,
        eles=[],
        elements=oParent.getElementsByTagName(<span class="hljs-string">'*'</span>);

    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>,l=elements.length;i&lt;l;i++){
        <span class="hljs-keyword">if</span>(elements[i].className==clsName){
            eles.push(elements[i]);
        }
    }
    <span class="hljs-keyword">return</span> eles;
}</code></pre>
<h2 id="获取css样式">获取css样式</h2>
<pre><code class="language-javascript"><span class="hljs-keyword">function</span> get<span class="hljs-constructor">Style(<span class="hljs-params">obj</span>,<span class="hljs-params">attr</span>)</span>{
    <span class="hljs-keyword">if</span>(obj.currentStyle) {<span class="hljs-comment">//IE 浏览器</span>
        return obj.currentStyle<span class="hljs-literal">[<span class="hljs-identifier">attr</span>]</span>;
    }<span class="hljs-keyword">else</span>{<span class="hljs-comment">//Firefox浏览器</span>
        return get<span class="hljs-constructor">ComputedStyle(<span class="hljs-params">obj</span>,<span class="hljs-params">false</span>)</span><span class="hljs-literal">[<span class="hljs-identifier">attr</span>]</span>;
    }
}
</code></pre>
<h2 id="手写动画">手写动画</h2>
<p>多个属性同时运动需要用到JSON,并且所有运动达到目标值才能停止</p>
<pre><code class="language-javascript"><span class="hljs-comment">//动画 startMove(oLi,{width:400,height:200,opacity:100})</span>
<span class="hljs-keyword">function</span> start<span class="hljs-constructor">Move(<span class="hljs-params">obj</span>,<span class="hljs-params">json</span>,<span class="hljs-params">fn</span>)</span>{
    clear<span class="hljs-constructor">Interval(<span class="hljs-params">obj</span>.<span class="hljs-params">timer</span>)</span>;
    obj.timer=set<span class="hljs-constructor">Interval(<span class="hljs-params">function</span> ()</span> {
        for(var attr <span class="hljs-keyword">in</span> json){
            <span class="hljs-comment">//1.取当前的值</span>
            var cur=<span class="hljs-number">0</span>;
            <span class="hljs-keyword">if</span>(attr=='opacity'){
                cur=<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Math</span>.</span></span>round(parse<span class="hljs-constructor">Float(<span class="hljs-params">getStyle</span>(<span class="hljs-params">obj</span>,<span class="hljs-params">attr</span>)</span>)*<span class="hljs-number">100</span>);
            }
            <span class="hljs-keyword">else</span> {
                cur=parse<span class="hljs-constructor">Int(<span class="hljs-params">getStyle</span>(<span class="hljs-params">obj</span>,<span class="hljs-params">attr</span>)</span>);
            }
            <span class="hljs-comment">//2.算速度</span>
            var speed=(json<span class="hljs-literal">[<span class="hljs-identifier">attr</span>]</span>-cur)/<span class="hljs-number">8</span>;
            speed=speed&gt;<span class="hljs-number">0</span>?<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Math</span>.</span></span>ceil(speed):<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Math</span>.</span></span>floor(speed);
            <span class="hljs-comment">//3.检测停止</span>
            var flag=<span class="hljs-literal">true</span>;
            <span class="hljs-keyword">if</span>(cur!=json<span class="hljs-literal">[<span class="hljs-identifier">attr</span>]</span>){<span class="hljs-comment">//使得所有属性做完运动才结束</span>
                flag=<span class="hljs-literal">false</span>;
            }
            <span class="hljs-keyword">if</span>(attr=='opacity'){
                obj.style.filter='alpha(opacity:'+(cur+speec)+<span class="hljs-character">')'</span>;
                obj.style.opacity=(cur+speed)/<span class="hljs-number">100</span>;
            }
            <span class="hljs-keyword">else</span>{
                obj.style<span class="hljs-literal">[<span class="hljs-identifier">attr</span>]</span>=(cur+speed)+'px';
            }
        }
        <span class="hljs-keyword">if</span>(flag){
            clear<span class="hljs-constructor">Interval(<span class="hljs-params">obj</span>.<span class="hljs-params">timer</span>)</span>;
            <span class="hljs-keyword">if</span>(fn){
                fn<span class="hljs-literal">()</span>;
            }
        }
    })
}</code></pre>
<h2 id="取得窗口左边和上边的位置">取得窗口左边和上边的位置</h2>
<pre><code class="language-javascript"><span class="hljs-keyword">var</span> leftPos=(<span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span>.screenLeft ==<span class="hljs-string">"number"</span>)?<span class="hljs-built_in">window</span>.screenLeft:<span class="hljs-built_in">window</span>.screenX;</code></pre>
<h2 id="取得页面视口大小">取得页面视口大小</h2>
<pre><code class="language-javascript"><span class="hljs-keyword">var</span> pageWidth=<span class="hljs-built_in">window</span>.innerWidth,
    pageHeight=<span class="hljs-built_in">window</span>.innerHeight;
    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">typeof</span> pageHeight!=<span class="hljs-string">"number"</span>){
        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">document</span>.compatMode==<span class="hljs-string">"CSS1Compat"</span>){<span class="hljs-comment">//标准模式</span>
            pageHeight=<span class="hljs-built_in">window</span>.documentElement.clientHeight;
            pageWidth=<span class="hljs-built_in">window</span>.documentElement.clientWidth;
        }
        <span class="hljs-keyword">else</span> {<span class="hljs-comment">//BackCompat</span>
            pageHeight=<span class="hljs-built_in">window</span>.body.clientHeight;
            pageWidth=<span class="hljs-built_in">window</span>.body.clientWidth;
        }
    }</code></pre>
<h2 id="检测插件方法">检测插件方法</h2>
<pre><code class="language-javascript"><span class="hljs-comment">/**
 *
* 检测插件方法一，IE下无效
*/</span>
<span class="hljs-keyword">function</span> has<span class="hljs-constructor">Plugin(<span class="hljs-params">name</span>)</span>{
    name=name.<span class="hljs-keyword">to</span><span class="hljs-constructor">LowerCase()</span>;
    for(var i=<span class="hljs-number">0</span>;i&lt;navigator.plugins.length;i++){
        <span class="hljs-keyword">if</span>(navigator.plugins<span class="hljs-literal">[<span class="hljs-identifier">i</span>]</span>.<span class="hljs-keyword">to</span><span class="hljs-constructor">LowerCase()</span>.index<span class="hljs-constructor">Of(<span class="hljs-params">name</span>)</span>!=-<span class="hljs-number">1</span>)
        return <span class="hljs-literal">true</span>;
    }
    return <span class="hljs-literal">false</span>;
}

<span class="hljs-comment">/**
 * 检测IE插件方法二 ,name是COM对象唯一标识符
 */</span>
<span class="hljs-keyword">function</span> has<span class="hljs-constructor">IEPlugin(<span class="hljs-params">name</span>)</span>{
    <span class="hljs-keyword">try</span>{
        <span class="hljs-keyword">new</span> <span class="hljs-constructor">ActiveXObject(<span class="hljs-params">name</span>)</span>;
        return <span class="hljs-literal">true</span>;
    }catch(ex){
        return <span class="hljs-literal">false</span>;
    }
}</code></pre>
<h2 id="获取元素">获取元素</h2>
<pre><code class="language-javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getElement</span>(<span class="hljs-params">id</span>)</span>{
    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">document</span>.getElementById){
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">document</span>.getElementById(id);
    }<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-built_in">document</span>.all){<span class="hljs-comment">//IE5前</span>
        <span class="hljs-keyword">return</span> <span class="hljs-built_in">document</span>.all[id];
    }<span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"no way to retrieve element!"</span>);
    }
}</code></pre>
<h2 id="检查对象的某个特性是否存在">检查对象的某个特性是否存在</h2>
<pre><code class="language-javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isHostMethod</span>(<span class="hljs-params">object,property</span>)</span>{
    <span class="hljs-keyword">var</span> t =<span class="hljs-keyword">typeof</span> object[<span class="hljs-keyword">property</span><span class="hljs-string">]</span>;
    <span class="hljs-keyword">return</span> t==<span class="hljs-string">"function"</span>||
           (!!(t==<span class="hljs-string">"object"</span>)&amp;&amp;object[<span class="hljs-keyword">property</span><span class="hljs-string">])||</span>
           t==<span class="hljs-string">"unknown"</span>;<span class="hljs-comment">//不懂</span>
}</code></pre>
<h2 id="对象转换成数组">对象转换成数组</h2>
<pre><code class="language-javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">convertToArray</span><span class="hljs-params">(nodes)</span></span>{
    <span class="hljs-keyword">var</span> <span class="hljs-keyword">array</span>=<span class="hljs-keyword">null</span>;
    <span class="hljs-keyword">try</span>{
        <span class="hljs-keyword">array</span>=<span class="hljs-keyword">Array</span>.propotype.slice.call(nodes,<span class="hljs-number">0</span>);<span class="hljs-comment">//IE8前无效</span>
    }<span class="hljs-keyword">catch</span>(ex){
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>,len=nodes.length;i&lt;len;i++){
            <span class="hljs-keyword">array</span>.push(nodes[i]);
        }
    }
}</code></pre>
<h2 id="返回指定的属性">返回指定的属性</h2>
<pre><code class="language-javascript">/**
 * 
 * 返回指定的属性 IE ele.attribute[]
 * Element.getAttribute()
 */
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">outputAttribute</span><span class="hljs-params">(ele)</span></span>{
    var <span class="hljs-built_in">pairs</span>=new Array(),
        attrname,attrvalue,u,<span class="hljs-built_in">len</span>;
    <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>,<span class="hljs-built_in">len</span>=ele.attribute.length;i&lt;<span class="hljs-built_in">len</span>;i++){
        attrname=ele.attributes[i].nodeName;
        attrvalue=ele.attributes[i].nodeValue;
        <span class="hljs-keyword">if</span>(ele.attributes[i].specified){//IE
            <span class="hljs-built_in">pairs</span>.push(attrname+<span class="hljs-string">'=\"'</span>+attrvalue+<span class="hljs-string">'\"'</span>);
        }
    }
}</code></pre>
<h2 id="ele是否存在指定属性">ele是否存在指定属性</h2>
<pre><code class="language-javascript"><span class="hljs-comment">/**
 * 
 * ele是否存在指定属性 attr
 */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hasattribute</span><span class="hljs-params">(ele,attr)</span></span>{
    <span class="hljs-keyword">if</span>(ele.hasAttribute){
        <span class="hljs-keyword">return</span> ele.hasAttribute(attr);
    }<span class="hljs-keyword">else</span> {<span class="hljs-comment">//IE</span>
        <span class="hljs-keyword">return</span> ele.attributes[attr].specified;
    }
}</code></pre>
<h2 id="ele是否符合选择器selector">ele是否符合选择器selector</h2>
<pre><code class="language-javascript"><span class="hljs-comment">/**
 * ele是否符合选择器selector
 */</span>
<span class="hljs-keyword">function</span> matches<span class="hljs-constructor">Selector(<span class="hljs-params">ele</span>,<span class="hljs-params">selector</span>)</span>{
    <span class="hljs-keyword">if</span>(ele.matchesSelector){
        return ele.matches<span class="hljs-constructor">Selector(<span class="hljs-params">selector</span>)</span>;
    }<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(ele.msmatchesSelector){
        return ele.msmatches<span class="hljs-constructor">Selector(<span class="hljs-params">selector</span>)</span>;
    }<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(ele.mozmatchesSelector){
        return ele.mozmatches<span class="hljs-constructor">Selector(<span class="hljs-params">selector</span>)</span>;
    }<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(ele.webkitmatchesSelector){
        return ele.webkitmatches<span class="hljs-constructor">Selector(<span class="hljs-params">selector</span>)</span>;
    }<span class="hljs-keyword">else</span>{
        throw <span class="hljs-keyword">new</span> <span class="hljs-constructor">Error(<span class="hljs-string">"not support"</span>)</span>;
    }
}</code></pre>
<h2 id="获取内文本">获取内文本</h2>
<pre><code class="language-javascript"><span class="hljs-comment">//innerText/textContent</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getInnerText</span><span class="hljs-params">(ele)</span></span>{
    <span class="hljs-keyword">return</span> (<span class="hljs-keyword">typeof</span> ele.innerText==<span class="hljs-string">"string"</span>)?
    ele.innerText:ele.textContent;
}</code></pre>
<h2 id="获取鼠标事件的父元素">获取鼠标事件的父元素</h2>
<pre><code class="language-javascript">    function getRelatedTarget(e){
        <span class="hljs-keyword">if</span>(e.relatedTarget) <span class="hljs-keyword">return</span> e.relatedTarget;
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(e.fromElement) <span class="hljs-keyword">return</span> e.fromElement;<span class="hljs-comment">//mouseover</span>
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(e.toElement) <span class="hljs-keyword">return</span> e.toElement;<span class="hljs-comment">//mouseout</span>
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    }</code></pre>
<h2 id="探测按的是鼠标的哪个键">探测按的是鼠标的哪个键</h2>
<pre><code class="language-javascript"> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getButton</span>(<span class="hljs-params">e</span>)</span>{
        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">document</span>.implementation.hasFeature(<span class="hljs-string">"MouseEvents"</span>,<span class="hljs-string">"2.0"</span>)){
            <span class="hljs-keyword">return</span> e.button;
        }<span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">switch</span>(e.button){
                <span class="hljs-keyword">case</span> <span class="hljs-number">0</span> :
                <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:
                <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:
                <span class="hljs-keyword">case</span> <span class="hljs-number">5</span>:
                <span class="hljs-keyword">case</span> <span class="hljs-number">7</span>: <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
                <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:
                <span class="hljs-keyword">case</span> <span class="hljs-number">6</span>:<span class="hljs-keyword">return</span> <span class="hljs-number">2</span>;
                <span class="hljs-keyword">case</span> <span class="hljs-number">4</span>:<span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
            }
        }
    }</code></pre>
<h2 id="鼠标滚动事件">鼠标滚动事件</h2>
<pre><code class="language-javascript"> <span class="hljs-comment">//鼠标滚动，正数表示向上滚动</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getWheelDelta</span><span class="hljs-params">(e)</span></span>{
        <span class="hljs-keyword">if</span>(e.wheelData){
            <span class="hljs-keyword">return</span> (client.engine.opera&amp;&amp;client.engine.opera&lt;<span class="hljs-number">9.5</span>)?
        -e.wheelData:e.wheelData;
        }<span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> -e.detail*<span class="hljs-number">40</span>;<span class="hljs-comment">//firefox</span>
        }

 }
</code></pre>
<h2 id="提取选中的文本">提取选中的文本</h2>
<pre><code class="language-javascript"><span class="hljs-keyword">function</span> get<span class="hljs-constructor">SelectedText(<span class="hljs-params">textbox</span>)</span>{
    <span class="hljs-keyword">if</span>(typeof selectionStart==<span class="hljs-string">"number"</span>){
        return textbox.value.sub<span class="hljs-constructor">String(<span class="hljs-params">textbox</span>.<span class="hljs-params">selectionStart</span>,<span class="hljs-params">textbox</span>.<span class="hljs-params">selectionEnd</span>)</span>;
    }<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(document.selection){<span class="hljs-comment">//IE8之前没有selectionStart，selectionEnd属性</span>
        return document.selection.create<span class="hljs-constructor">Range()</span>.text;
    }
}</code></pre>
<h2 id="设置文本选中">设置文本选中</h2>
<pre><code class="language-javascript"><span class="hljs-keyword">function</span> select<span class="hljs-constructor">Text(<span class="hljs-params">textbox</span>,<span class="hljs-params">startIndex</span>,<span class="hljs-params">stopIndex</span>)</span>{
    <span class="hljs-keyword">if</span>(textbox.setSelectionRange){
        textbox.set<span class="hljs-constructor">SelectionRange(<span class="hljs-params">startIndex</span>,<span class="hljs-params">stopIndex</span>)</span>;
    }<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(textbox.createTextRange){<span class="hljs-comment">//IE</span>
        var range=textbox.create<span class="hljs-constructor">TextRange()</span>;
        range.collapse(<span class="hljs-literal">true</span>);
        range.move<span class="hljs-constructor">Start(<span class="hljs-string">"character"</span>,0)</span>;
        range.move<span class="hljs-constructor">End(<span class="hljs-string">"character"</span>,<span class="hljs-params">stopIndex</span>-<span class="hljs-params">startIndex</span>)</span>;
        range.select<span class="hljs-literal">()</span>;
    }
}</code></pre>
<h2 id="bind方法对老版本的浏览器不起作用">bind方法对老版本的浏览器不起作用</h2>
<pre><code class="language-javascript">
<span class="hljs-function"><span class="hljs-keyword">Function</span>.<span class="hljs-title">prototype</span></span>.<span class="hljs-keyword">bind</span> = <span class="hljs-function"><span class="hljs-keyword">Function</span>.<span class="hljs-title">prototype</span></span>.<span class="hljs-keyword">bind</span> || <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(context)</span></span>{
      var self = this;

      <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
        <span class="hljs-keyword">return</span> self.apply(context, arguments);
      };
    }
</code></pre>
<h2 id="包装cookie">包装cookie</h2>
<pre><code class="language-javascript">

<span class="javascript"><span class="hljs-comment">//cookie</span>
<span class="hljs-keyword">var</span> cookieUtil={
    <span class="hljs-comment">// 创建cookie</span>
    <span class="hljs-attr">setcookie</span>:<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">name, value, expires, path, domain, secure</span>) </span>{
    <span class="hljs-keyword">var</span> cookieText = <span class="hljs-built_in">encodeURIComponent</span>(name) + <span class="hljs-string">'='</span> + <span class="hljs-built_in">encodeURIComponent</span>(value);
    <span class="hljs-keyword">if</span> (expires <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Date</span>) {
        cookieText += <span class="hljs-string">'; expires='</span> + expires.toGMTString();
    }
    <span class="hljs-keyword">if</span> (path) {
        cookieText += <span class="hljs-string">'; path='</span> + path;
    }
    <span class="hljs-keyword">if</span> (domain) {
        cookieText += <span class="hljs-string">'; domain='</span> + domain;
    }
    <span class="hljs-keyword">if</span> (secure) {
        cookieText += <span class="hljs-string">'; secure'</span>;
    }
    <span class="hljs-built_in">document</span>.cookie = cookieText;
},
    <span class="hljs-comment">// 获取cookie</span>
    <span class="hljs-attr">getcookie</span>:<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">name</span>) </span>{
    <span class="hljs-keyword">var</span> cookieName = <span class="hljs-built_in">encodeURIComponent</span>(name) + <span class="hljs-string">'='</span>;
    <span class="hljs-keyword">var</span> cookieStart = <span class="hljs-built_in">document</span>.cookie.indexOf(cookieName);
    <span class="hljs-keyword">var</span> cookieValue = <span class="hljs-literal">null</span>;
    <span class="hljs-keyword">if</span> (cookieStart &gt; <span class="hljs-number">-1</span>) {
        <span class="hljs-keyword">var</span> cookieEnd = <span class="hljs-built_in">document</span>.cookie.indexOf(<span class="hljs-string">';'</span>, cookieStart);
        <span class="hljs-keyword">if</span> (cookieEnd == <span class="hljs-number">-1</span>) {
            cookieEnd = <span class="hljs-built_in">document</span>.cookie.length;
        }
        cookieValue = <span class="hljs-built_in">decodeURIComponent</span>(<span class="hljs-built_in">document</span>.cookie.substring(cookieStart + cookieName.length, cookieEnd));
    }
    <span class="hljs-keyword">return</span> cookieValue;
},
   <span class="hljs-comment">// 删除cookie</span>
    <span class="hljs-attr">unsetcookie</span>:<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">name,path,domain,secure</span>) </span>{
    <span class="hljs-keyword">this</span>.setcookie(name,<span class="hljs-string">""</span>,<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-number">0</span>),path,domain,secure);
}
}</span></code></pre>
<h2 id="包装子cookie">包装子cookie</h2>
<pre><code class="language-javascript"><span class="hljs-comment">//子cookie</span>
<span class="hljs-keyword">var</span> subcookieUtil={
    <span class="hljs-attr">get</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name,subname</span>)</span>{
        <span class="hljs-keyword">var</span> subcookie=getAll(name);
        <span class="hljs-keyword">if</span>(subcookie){
            <span class="hljs-keyword">return</span> subcookie[subname];
        }<span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }
    },
    <span class="hljs-attr">getAll</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>)</span>{
        <span class="hljs-keyword">var</span> cookieName = <span class="hljs-built_in">encodeURIComponent</span>(name) + <span class="hljs-string">'='</span>;
        <span class="hljs-keyword">var</span> cookieStart = <span class="hljs-built_in">document</span>.cookie.indexOf(cookieName);
        <span class="hljs-keyword">var</span> cookieValue = <span class="hljs-literal">null</span>;
        <span class="hljs-keyword">var</span> subcookie,result={};
        <span class="hljs-keyword">var</span> len,i,parts;
        <span class="hljs-keyword">if</span> (cookieStart &gt; <span class="hljs-number">-1</span>) {
            <span class="hljs-keyword">var</span> cookieEnd = <span class="hljs-built_in">document</span>.cookie.indexOf(<span class="hljs-string">';'</span>, cookieStart);
            <span class="hljs-keyword">if</span> (cookieEnd == <span class="hljs-number">-1</span>) {
            cookieEnd = <span class="hljs-built_in">document</span>.cookie.length;
           }
        cookieValue = <span class="hljs-built_in">document</span>.cookie.substring(cookieStart + cookieName.length, cookieEnd);
        <span class="hljs-keyword">if</span>(cookieValue.length&gt;<span class="hljs-number">0</span>){
            subcookie=cookieValue.split(<span class="hljs-string">'&amp;'</span>);
            len=subcookie.length;
            <span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;llen;i++){
                parts=subcookie[i].split(<span class="hljs-string">'='</span>);
                result[parts[<span class="hljs-number">0</span>]]=parts[<span class="hljs-number">1</span>];
            }
            <span class="hljs-keyword">return</span> result;
        }
       }
    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
    },

    <span class="hljs-attr">set</span>:<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">name, subname,value, expires, path, domain, secure</span>) </span>{
        <span class="hljs-keyword">var</span> subcookies=<span class="hljs-keyword">this</span>.getAll(name)||{};
        subcookies[subname]=value;
        <span class="hljs-keyword">this</span>.setAll(name,subcookies,expires,path,domain,secure);
    },

    <span class="hljs-attr">setAll</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name,subcookies,expires,path,domain,secure</span>)</span>{
        <span class="hljs-keyword">var</span> cookieText = <span class="hljs-built_in">encodeURIComponent</span>(name) + <span class="hljs-string">'='</span>;
        <span class="hljs-keyword">var</span> subcookiesParts=<span class="hljs-keyword">new</span> <span class="hljs-built_in">Array</span>();
        <span class="hljs-keyword">var</span> subname;
        <span class="hljs-keyword">for</span>(subname <span class="hljs-keyword">in</span> subcookies){
            <span class="hljs-keyword">if</span>(subname.length&gt;<span class="hljs-number">0</span>&amp;&amp;subcookies.hasOwnProperty(subname)){
                subcookiesParts.push(<span class="hljs-built_in">encodeURIComponent</span>(subname)+<span class="hljs-string">'='</span>+<span class="hljs-built_in">encodeURIComponent</span>(subcookies[subname]));
            }
        }
        <span class="hljs-keyword">if</span>(subcookiesParts.length&gt;<span class="hljs-number">0</span>){
            cookieText+=subcookiesParts.join(<span class="hljs-string">'&amp;'</span>);
            <span class="hljs-keyword">if</span> (expires <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Date</span>) {
                cookieText += <span class="hljs-string">'; expires='</span> + expires.toGMTString();
            }
            <span class="hljs-keyword">if</span> (path) {
                cookieText += <span class="hljs-string">'; expires='</span> + expires;
             }
            <span class="hljs-keyword">if</span> (domain) {
                cookieText += <span class="hljs-string">'; domain='</span> + domain;
            }
            <span class="hljs-keyword">if</span> (secure) {
                cookieText += <span class="hljs-string">'; secure'</span>;
            }
        }

        <span class="hljs-built_in">document</span>.cookie = cookieText;
    },
    <span class="hljs-attr">unset</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name,subname,path,domain,secure</span>)</span>{
          <span class="hljs-keyword">var</span> subcookies=<span class="hljs-keyword">this</span>.getAll(name);
        <span class="hljs-keyword">if</span>(subcookies){
              <span class="hljs-keyword">delete</span> subcookies[subname];
              <span class="hljs-keyword">this</span>.setAll(name,subcookies,<span class="hljs-literal">null</span>,path,domain,secure);
          }
        },
    <span class="hljs-attr">unsetAll</span>:<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">name,path,domain,secure</span>)</span>{
          <span class="hljs-keyword">this</span>.setAll(name,<span class="hljs-literal">null</span>,<span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(<span class="hljs-number">0</span>),path,domain,secure);
    }
}</code></pre>
<h2 id="indexeddb">indexedDB</h2>
<pre><code class="language-javascript">
<span class="hljs-keyword">var</span> indexedDB=<span class="hljs-built_in">window</span>.indexedDB||<span class="hljs-built_in">window</span>.mozIndexedDB||<span class="hljs-built_in">window</span>.msIndexedDB||<span class="hljs-built_in">window</span>.webkitIndexedDB;
<span class="hljs-keyword">var</span> idbRequest=indexedDB.open(<span class="hljs-string">'vvv'</span>);
idbRequest.onsuccess=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>)</span>{
    database=event.target.result;
}
idbRequest.onerror=<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>)</span>{
    alert(event.target.errorCode);
}</code></pre>
<h3 id="objectcreate">Object.create</h3>
<pre><code class="language-js"><span class="hljs-keyword">var</span> objectCreate = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">arg</span>)</span>{
    <span class="hljs-keyword">if</span>(!arg){ <span class="hljs-keyword">return</span> {}};
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">obj</span>(<span class="hljs-params"></span>)</span>{};
    obj.prototype = arg;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> obj();
}
<span class="hljs-built_in">Object</span>.create = <span class="hljs-built_in">Object</span>.create||objectCreate;</code></pre>
<h2 id="手写typeof">手写typeof</h2>
<pre><code class="language-javascript">function <span class="hljs-class"><span class="hljs-keyword">type</span>(<span class="hljs-params">obj</span>) </span>{
    <span class="hljs-keyword">var</span> toString = <span class="hljs-type">Object</span>.prototype.toString;
    <span class="hljs-keyword">var</span> map = {
        '[<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">Boolean</span>]'  </span>: <span class="hljs-symbol">'boolea</span>n', 
        '[<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">Number</span>]'   </span>: <span class="hljs-symbol">'numbe</span>r', 
        '[<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">String</span>]'   </span>: <span class="hljs-symbol">'strin</span>g', 
        '[<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">Function</span>]' </span>: <span class="hljs-symbol">'functio</span>n', 
        '[<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">Array</span>]'    </span>: <span class="hljs-symbol">'arra</span>y', 
        '[<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">Date</span>]'     </span>: <span class="hljs-symbol">'dat</span>e', 
        '[<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">RegExp</span>]'   </span>: <span class="hljs-symbol">'regEx</span>p', 
        '[<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">Undefined</span>]'</span>: <span class="hljs-symbol">'undefine</span>d',
        '[<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">Null</span>]'     </span>: <span class="hljs-symbol">'nul</span>l', 
        '[<span class="hljs-class"><span class="hljs-keyword">object</span> <span class="hljs-title">Object</span>]'   </span>: <span class="hljs-symbol">'objec</span>t'
    };
    <span class="hljs-keyword">if</span>(obj instanceof <span class="hljs-type">Element</span>) {<span class="hljs-comment">//因为对不同标签，toString会返回对应不同标签的构造函数</span>
        <span class="hljs-keyword">return</span> <span class="hljs-symbol">'elemen</span>t';
    }
    <span class="hljs-keyword">return</span> map[toString.call(obj)];
}</code></pre>
<h2 id="使用useragent判断使用的是什么浏览器">使用userAgent判断使用的是什么浏览器</h2>
<p>360的兼容模式用的是IE、极速模式用的是chrome的内核</p>
<pre><code class="language-javascript"> function validB(){ 
  var u_agent = navigator.userAgent; 
  var <span class="hljs-attribute">B_name</span>=<span class="hljs-string">"Failed to identify the browser"</span>; 
  <span class="hljs-keyword">if</span>(u_agent.indexOf(<span class="hljs-string">"Firefox"</span>)&gt;-1){ 
      <span class="hljs-attribute">B_name</span>=<span class="hljs-string">"Firefox"</span>; 
  }<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(u_agent.indexOf(<span class="hljs-string">"Chrome"</span>)&gt;-1){ 
      <span class="hljs-attribute">B_name</span>=<span class="hljs-string">"Chrome"</span>; 
  }<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(u_agent.indexOf(<span class="hljs-string">"MSIE"</span>)&gt;-1&amp;&amp;u_agent.indexOf(<span class="hljs-string">"Trident"</span>)&gt;-1){ 
      <span class="hljs-attribute">B_name</span>=<span class="hljs-string">"IE(8-10)"</span>;  
  }
    document.write(<span class="hljs-string">"B_name:"</span>+B_name+<span class="hljs-string">"&lt;br&gt;"</span>);
    document.write(<span class="hljs-string">"u_agent:"</span>+u_agent+<span class="hljs-string">"&lt;br&gt;"</span>); 
} 
</code></pre>
<h2 id="深度克隆">深度克隆</h2>
<pre><code class="language-javascript"><span class="hljs-comment">/**
 * 
 * 深度克隆方法一，用的是instanceof
 */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">clone</span><span class="hljs-params">(Obj)</span> </span>{
    <span class="hljs-keyword">var</span> buf;   
    <span class="hljs-keyword">if</span> (Obj <span class="hljs-keyword">instanceof</span> <span class="hljs-keyword">Array</span>) {
        buf = [];  <span class="hljs-comment">// 创建一个空的数组</span>
        <span class="hljs-keyword">var</span> i = Obj.length;
        <span class="hljs-keyword">while</span> (i--) {
            buf[i] = <span class="hljs-keyword">clone</span>(Obj[i]);
        }
        <span class="hljs-keyword">return</span> buf;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (Obj <span class="hljs-keyword">instanceof</span> Object){
        buf = {};  <span class="hljs-comment">// 创建一个空对象</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> k in Obj) {  <span class="hljs-comment">// 为这个对象添加新的属性</span>
            buf[k] = <span class="hljs-keyword">clone</span>(Obj[k]);
        }
        <span class="hljs-keyword">return</span> buf;
    }<span class="hljs-keyword">else</span>{
        <span class="hljs-keyword">return</span> Obj;
    }
}

<span class="hljs-comment">/**
 * 
 * 深度拷贝方法二，用的是 toString
 */</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">deepClone</span><span class="hljs-params">(data)</span> </span>{
    <span class="hljs-keyword">var</span> t = type(data), o, i, ni;

    <span class="hljs-keyword">if</span>(t === <span class="hljs-string">'array'</span>) {
        o = [];
    }<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>( t === <span class="hljs-string">'object'</span>) {
        o = {};
    }<span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> data;
    }

    <span class="hljs-keyword">if</span>(t === <span class="hljs-string">'array'</span>) {
        <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>, ni = data.length; i &lt; ni; i++) {
            o.push(deepClone(data[i]));
        }
        <span class="hljs-keyword">return</span> o;
    }<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>( t === <span class="hljs-string">'object'</span>) {
        <span class="hljs-keyword">for</span>( i in data) {
            o[i] = deepClone(data[i]);
        }
        <span class="hljs-keyword">return</span> o;
    }
}
<span class="hljs-comment">/**
 * 
 * 深度拷贝方法四，只支持基本数值类型
 * 
1.他无法实现对函数 、RegExp等特殊对象的克隆
2.会抛弃对象的constructor,所有的构造函数会指向Object
3.对象有循环引用,会报错
 */</span>
<span class="hljs-keyword">const</span> newObj = JSON.parse(JSON.stringify(oldObj));

<span class="hljs-comment">/**
 * 
 * 深度拷贝方法三，更多类型
 */</span>

<span class="hljs-keyword">const</span> isType = (obj, type) =&gt; {
  <span class="hljs-keyword">if</span> (typeof obj !== <span class="hljs-string">'object'</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;
  <span class="hljs-keyword">const</span> typeString = Object.prototype.toString.call(obj);
  <span class="hljs-keyword">let</span> flag;
  <span class="hljs-keyword">switch</span> (type) {
    <span class="hljs-keyword">case</span> <span class="hljs-string">'Array'</span>:
      flag = typeString === <span class="hljs-string">'[object Array]'</span>;
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-string">'Date'</span>:
      flag = typeString === <span class="hljs-string">'[object Date]'</span>;
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> <span class="hljs-string">'RegExp'</span>:
      flag = typeString === <span class="hljs-string">'[object RegExp]'</span>;
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">default</span>:
      flag = <span class="hljs-keyword">false</span>;
  }
  <span class="hljs-keyword">return</span> flag;
};

<span class="hljs-keyword">const</span> getRegExp = re =&gt; {
  <span class="hljs-keyword">var</span> flags = <span class="hljs-string">''</span>;
  <span class="hljs-keyword">if</span> (re.<span class="hljs-keyword">global</span>) flags += <span class="hljs-string">'g'</span>;
  <span class="hljs-keyword">if</span> (re.ignoreCase) flags += <span class="hljs-string">'i'</span>;
  <span class="hljs-keyword">if</span> (re.multiline) flags += <span class="hljs-string">'m'</span>;
  <span class="hljs-keyword">return</span> flags;
};
<span class="hljs-comment">/**
* deep clone
* <span class="hljs-doctag">@param</span>  {[type]} parent object 需要进行克隆的对象
* <span class="hljs-doctag">@return</span> {[type]}        深克隆后的对象
*/</span>
<span class="hljs-keyword">const</span> <span class="hljs-keyword">clone</span> = <span class="hljs-keyword">parent</span> =&gt; {
  <span class="hljs-comment">// 维护两个储存循环引用的数组</span>
  <span class="hljs-keyword">const</span> parents = [];
  <span class="hljs-keyword">const</span> children = [];

  <span class="hljs-keyword">const</span> _clone = <span class="hljs-keyword">parent</span> =&gt; {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">parent</span> === <span class="hljs-keyword">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;
    <span class="hljs-keyword">if</span> (typeof <span class="hljs-keyword">parent</span> !== <span class="hljs-string">'object'</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">parent</span>;

    <span class="hljs-keyword">let</span> child, proto;

    <span class="hljs-keyword">if</span> (isType(<span class="hljs-keyword">parent</span>, <span class="hljs-string">'Array'</span>)) {
      <span class="hljs-comment">// 对数组做特殊处理</span>
      child = [];
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isType(<span class="hljs-keyword">parent</span>, <span class="hljs-string">'RegExp'</span>)) {
      <span class="hljs-comment">// 对正则对象做特殊处理</span>
      child = <span class="hljs-keyword">new</span> RegExp(<span class="hljs-keyword">parent</span>.source, getRegExp(<span class="hljs-keyword">parent</span>));
      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">parent</span>.lastIndex) child.lastIndex = <span class="hljs-keyword">parent</span>.lastIndex;
    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (isType(<span class="hljs-keyword">parent</span>, <span class="hljs-string">'Date'</span>)) {
      <span class="hljs-comment">// 对Date对象做特殊处理</span>
      child = <span class="hljs-keyword">new</span> Date(<span class="hljs-keyword">parent</span>.getTime());
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-comment">// 处理对象原型</span>
      proto = Object.getPrototypeOf(<span class="hljs-keyword">parent</span>);
      <span class="hljs-comment">// 利用Object.create切断原型链</span>
      child = Object.create(proto);
    }

    <span class="hljs-comment">// 处理循环引用</span>
    <span class="hljs-keyword">const</span> index = parents.indexOf(<span class="hljs-keyword">parent</span>);

    <span class="hljs-keyword">if</span> (index != <span class="hljs-number">-1</span>) {
      <span class="hljs-comment">// 如果父数组存在本对象,说明之前已经被引用过,直接返回此对象</span>
      <span class="hljs-keyword">return</span> children[index];
    }
    parents.push(<span class="hljs-keyword">parent</span>);
    children.push(child);

    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i in <span class="hljs-keyword">parent</span>) {
      <span class="hljs-comment">// 递归</span>
      child[i] = _clone(<span class="hljs-keyword">parent</span>[i]);
    }

    <span class="hljs-keyword">return</span> child;
  };
  <span class="hljs-keyword">return</span> _clone(<span class="hljs-keyword">parent</span>);
};

</code></pre>
<h2 id="组合使用构造函数模式和原型模式创建对象">组合使用构造函数模式和原型模式创建对象</h2>
<pre><code class="language-javascript"><span class="hljs-comment">//组合使用构造函数模式和原型模式创建对象</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Person</span>(<span class="hljs-params">name,age</span>)</span>{
    <span class="hljs-keyword">this</span>.name=name;
    <span class="hljs-keyword">this</span>.age=age;
    <span class="hljs-keyword">this</span>.friends=[<span class="hljs-string">"may"</span>,<span class="hljs-string">"john"</span>];
}
Person.prototype={
    <span class="hljs-keyword">constructor</span>:Person,//字面量形式的原型默认构造函数是object,所以在这里要指定<span class="hljs-keyword">constructor</span>
    sayName=function(<span class="hljs-params"></span>){
        alert(<span class="hljs-params"><span class="hljs-keyword">this</span>.name</span>);
    }
}</code></pre>
<h2 id="组合继承">组合继承</h2>
<pre><code class="language-javascript"><span class="hljs-comment">//组合继承</span>
funcion <span class="hljs-keyword">super</span>(name){
    <span class="hljs-keyword">this</span>.name=name;
    <span class="hljs-keyword">this</span>.color=[<span class="hljs-string">"red"</span>,<span class="hljs-string">"blue"</span>];

}
Super.prototype.sayname=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
    alert(<span class="hljs-keyword">this</span>.name);
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Sub</span><span class="hljs-params">(age)</span></span>{
    Super.call(<span class="hljs-keyword">this</span>);
    <span class="hljs-keyword">this</span>.age=age;
}
Sub.prototype=<span class="hljs-keyword">new</span> Super();<span class="hljs-comment">//</span>
Sub.prototype.constructor=Sub;<span class="hljs-comment">//这个很重要！！</span>
Sub.prototype.sayage=<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
    alert(<span class="hljs-keyword">this</span>.age);
}
</code></pre>
<h2 id="观察者模式">观察者模式</h2>
<pre><code class="language-javascript"><span class="hljs-comment">//观察者模式</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">EventTarget</span>(<span class="hljs-params"></span>)</span>{     
    <span class="hljs-keyword">this</span>.handlers = {}; 
} 
EventTarget.prototype = {     
    <span class="hljs-keyword">constructor</span>: EventTarget,
    addHandler: function(<span class="hljs-params"><span class="hljs-keyword">type</span>, handler</span>){
         <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> <span class="hljs-keyword">this</span>.handlers[<span class="hljs-keyword">type</span>] == <span class="hljs-string">"undefined"</span>){
              <span class="hljs-keyword">this</span>.handlers[<span class="hljs-keyword">type</span>] = [];
         }
         <span class="hljs-keyword">this</span>.handlers[<span class="hljs-keyword">type</span>].push(handler);
     }, 
    fire: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">event</span>)</span>{<span class="hljs-comment">//执行</span>
         <span class="hljs-keyword">if</span> (!event.target){
             event.target = <span class="hljs-keyword">this</span>;
         }
         <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.handlers[event.type] <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Array</span>){
             <span class="hljs-keyword">var</span> handlers = <span class="hljs-keyword">this</span>.handlers[event.type];
             <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>, len=handlers.length; i &lt; len; i++){
                 handlers[i](event); 
            }
         }
     },
     removeHandler: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"><span class="hljs-keyword">type</span>, handler</span>)</span>{ 
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.handlers[<span class="hljs-keyword">type</span>] <span class="hljs-keyword">instanceof</span> <span class="hljs-built_in">Array</span>){ 
            <span class="hljs-keyword">var</span> handlers = <span class="hljs-keyword">this</span>.handlers[<span class="hljs-keyword">type</span>]; 
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>, len=handlers.length; i &lt; len; i++){ 
                <span class="hljs-keyword">if</span> (handlers[i] === handler){ 
                    <span class="hljs-keyword">break</span>;
                 }
             }
             handlers.splice(i, <span class="hljs-number">1</span>); 
          }
      }
};</code></pre>
<h2 id="分享一个题目">分享一个题目</h2>
<pre><code class="language-javascript">
<span class="hljs-comment">//[附加题] 请实现下面的自定义事件 Event 对象的接口，功能见注释(测试1)</span>
<span class="hljs-comment">//该 Event 对象的接口需要能被其他对象拓展复用(测试2)</span>
<span class="hljs-comment">//测试1</span>
Event.on(<span class="hljs-string">'test'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">result</span>) </span>{
    <span class="hljs-built_in">console</span>.log(result);
});
Event.on(<span class="hljs-string">'test'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'test'</span>);
});
Event.emit(<span class="hljs-string">'test'</span>, <span class="hljs-string">'hello world'</span>); <span class="hljs-comment">// 输出 'hello world' 和 'test'</span>
<span class="hljs-comment">// 测试2</span>
<span class="hljs-keyword">var</span> person1 = {};
<span class="hljs-keyword">var</span> person2 = {};
<span class="hljs-built_in">Object</span>.assign(person1, Event);
<span class="hljs-built_in">Object</span>.assign(person2, Event);
person1.on(<span class="hljs-string">'call1'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'person1'</span>);
});
person2.on(<span class="hljs-string">'call2'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'person2'</span>);
});
person1.emit(<span class="hljs-string">'call1'</span>); <span class="hljs-comment">//输出 'person1'</span>
person1.emit(<span class="hljs-string">'call2'</span>); <span class="hljs-comment">// 没有输出</span>
person2.emit(<span class="hljs-string">'call1'</span>); <span class="hljs-comment">// 没有输出</span>
person2.emit(<span class="hljs-string">'call2'</span>); <span class="hljs-comment">// 输出 'person2'</span>
<span class="hljs-keyword">var</span> Event = {
    <span class="hljs-comment">// 通过on接口监听事件eventName</span>
    <span class="hljs-comment">// 如果事件eventName被触发，则执行callback回调函数</span>
    <span class="hljs-attr">on</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">eventName, callback</span>) </span>{
        <span class="hljs-comment">//你的代码</span>
        <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">this</span>.handles){
            <span class="hljs-comment">//Object.assign(target, source);</span>
<span class="hljs-comment">//这个是ES6的新对象方法，用于对象的合并，将源对象（source）的所有可枚举属性，复制到目标对象（target）。</span>
            <span class="hljs-built_in">Object</span>.defineProperty(<span class="hljs-keyword">this</span>, <span class="hljs-string">"handles"</span>, {
                <span class="hljs-attr">value</span>: {},
                <span class="hljs-attr">enumerable</span>: <span class="hljs-literal">false</span>,<span class="hljs-comment">//关键！</span>
                <span class="hljs-attr">configurable</span>: <span class="hljs-literal">true</span>,
                <span class="hljs-attr">writable</span>: <span class="hljs-literal">true</span>
            })
        }

       <span class="hljs-keyword">if</span>(!<span class="hljs-keyword">this</span>.handles[eventName]){
            <span class="hljs-keyword">this</span>.handles[eventName]=[];
       }
       <span class="hljs-keyword">this</span>.handles[eventName].push(callback);
    },
    <span class="hljs-comment">// 触发事件 eventName</span>
    <span class="hljs-attr">emit</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">eventName</span>) </span>{
        <span class="hljs-comment">//你的代码</span>
       <span class="hljs-keyword">if</span>(<span class="hljs-keyword">this</span>.handles[<span class="hljs-built_in">arguments</span>[<span class="hljs-number">0</span>]]){
           <span class="hljs-keyword">for</span>(<span class="hljs-keyword">var</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-keyword">this</span>.handles[<span class="hljs-built_in">arguments</span>[<span class="hljs-number">0</span>]].length;i++){
               <span class="hljs-keyword">this</span>.handles[<span class="hljs-built_in">arguments</span>[<span class="hljs-number">0</span>]][i](<span class="hljs-built_in">arguments</span>[<span class="hljs-number">1</span>]);
           }
       }
    }
};
<span class="hljs-comment">//输出所有页面宽度和高度大于50像素的节点。</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">traverse</span>(<span class="hljs-params">oNode</span>) </span>{
    <span class="hljs-keyword">var</span> aResult = [];
    oNode = oNode || <span class="hljs-built_in">document</span>.body;
    <span class="hljs-keyword">if</span> (oNode.style) {
        <span class="hljs-keyword">var</span> nWidth = <span class="hljs-built_in">window</span>.parseInt(oNode.style.width, <span class="hljs-number">10</span>) || <span class="hljs-number">0</span>;
        <span class="hljs-keyword">var</span> nHeight = <span class="hljs-built_in">window</span>.parseInt(oNode.style.height, <span class="hljs-number">10</span>) || <span class="hljs-number">0</span>;
        <span class="hljs-keyword">if</span> (nWidth &gt; <span class="hljs-number">50</span> &amp;&amp; nHeight &gt; <span class="hljs-number">50</span>) {
            aResult.push(oNode);
        }
    }
    <span class="hljs-keyword">var</span> aChildNodes = oNode.childNodes;
    <span class="hljs-keyword">if</span> (aChildNodes.length &gt; <span class="hljs-number">0</span>) {
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, l = aChildNodes.length; i &lt; l; i++) {
            <span class="hljs-keyword">var</span> oTmp = aChildNodes[i];
            aResult = aResult.concat(traverse(oTmp));
        }
    }
    <span class="hljs-keyword">return</span> aResult;
}
</code></pre>
<h3 id="ie的userdata">IE的userData</h3>
<pre><code class="language-javascript"> <span class="hljs-keyword">function</span> set<span class="hljs-constructor">_ud(<span class="hljs-params">key</span>,<span class="hljs-params">value</span>)</span> {
    var a = document.get<span class="hljs-constructor">ElementById('<span class="hljs-params">x</span>')</span>; <span class="hljs-comment">// x 为任意div 的id 值</span>
    a.add<span class="hljs-constructor">Behavior(<span class="hljs-string">"#default#userdata"</span>)</span>;
    a.set<span class="hljs-constructor">Attribute(<span class="hljs-params">key</span>,<span class="hljs-params">value</span>)</span>;
    a.save(<span class="hljs-string">"db"</span>);
}
<span class="hljs-keyword">function</span> get<span class="hljs-constructor">_ud(<span class="hljs-params">key</span>)</span> {
    var a = document.get<span class="hljs-constructor">ElementById('<span class="hljs-params">x</span>')</span>;
    a.add<span class="hljs-constructor">Behavior(<span class="hljs-string">"#default#userdata"</span>)</span>;
    a.load(<span class="hljs-string">"db"</span>);
    alert(a.get<span class="hljs-constructor">Attribute(<span class="hljs-params">key</span>)</span>);
}
<span class="hljs-keyword">function</span> del<span class="hljs-constructor">_ud(<span class="hljs-params">key</span>)</span> {
    var a = document.get<span class="hljs-constructor">ElementById('<span class="hljs-params">x</span>')</span>;
    a.add<span class="hljs-constructor">Behavior(<span class="hljs-string">"#default#userdata"</span>)</span>;
    a.set<span class="hljs-constructor">Attribute(<span class="hljs-params">key</span>, <span class="hljs-string">""</span>)</span>; <span class="hljs-comment">// 设置为空值即可</span>
    a.save(<span class="hljs-string">"db"</span>);
}
window.onload = <span class="hljs-keyword">function</span><span class="hljs-literal">()</span>{
    set<span class="hljs-constructor">_ud('<span class="hljs-params">a</span>','<span class="hljs-params">xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx</span>')</span>; <span class="hljs-comment">// 设置</span>
    get<span class="hljs-constructor">_ud('<span class="hljs-params">a</span>')</span>; <span class="hljs-comment">// 获取a 的值</span>
    del<span class="hljs-constructor">_ud('<span class="hljs-params">a</span>')</span>; <span class="hljs-comment">// 删除a 的值</span>
    get<span class="hljs-constructor">_ud('<span class="hljs-params">a</span>')</span>; <span class="hljs-comment">// 获取a 的值</span>
};</code></pre>

        </div>
    </div>
    
</body>
<script type="text/javascript">
    //文章里面的外链都打开新窗口    
    var alist = document.querySelectorAll(".article a");
    for(let i=0;i<alist.length;i++) if(alist[i].href.indexOf('#') < 0) alist[i].target="_blank"    
    //加上table样式
    var tableList = document.querySelectorAll("table");
    for(let i = 0;i<tableList.length;i++) tableList[i].className+=" table table-striped"
</script>
<script src="//at.alicdn.com/t/font_1606737_dfnzi0oc8au.js"></script>
</html>